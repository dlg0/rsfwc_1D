(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[         0,          0]
NotebookDataLength[    206970,       5814]
NotebookOptionsPosition[    197233,       5552]
NotebookOutlinePosition[    197859,       5576]
CellTagsIndexPosition[    197816,       5573]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"Needs", "[", "\"\<VectorAnalysis`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetCoordinates", "[", "Cylindrical", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ExpVar", ":=", 
  RowBox[{"Exp", "[", 
   RowBox[{"I", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"nPhi", "*", "Ttheta"}], "+", 
      RowBox[{"kz", "*", "Zz"}]}], ")"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"EField", ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"Er", "[", "Rr", "]"}], "*", "ExpVar"}], ",", 
    RowBox[{
     RowBox[{"Eth", "[", "Rr", "]"}], "*", "ExpVar"}], ",", 
    RowBox[{
     RowBox[{"Ez", "[", "Rr", "]"}], "*", "ExpVar"}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CurlE", "=", 
   RowBox[{"Curl", "[", "EField", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CurlCurlE", "=", 
   RowBox[{"Curl", "[", "CurlE", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Simplify", "[", 
   RowBox[{"CurlE", "/", "ExpVar"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"CCE", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"CurlCurlE", "/", "ExpVar"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Er", "[", "Rr", "]"}], ",", 
      RowBox[{"Eth", "[", "Rr", "]"}], ",", 
      RowBox[{"Ez", "[", "Rr", "]"}], ",", 
      RowBox[{
       SubscriptBox["\[PartialD]", "Rr"], 
       RowBox[{"Er", "[", "Rr", "]"}]}], ",", 
      RowBox[{
       SubscriptBox["\[PartialD]", "Rr"], 
       RowBox[{"Eth", "[", "Rr", "]"}]}], ",", 
      RowBox[{
       SubscriptBox["\[PartialD]", "Rr"], 
       RowBox[{"Ez", "[", "Rr", "]"}]}]}], "}"}], ",", "Simplify"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["\[Epsilon]", "0"], "=", 
   RowBox[{"8.85418", " ", 
    RowBox[{"10", "^", 
     RowBox[{"-", "12"}]}]}]}], ";", 
  RowBox[{"c", "=", "299792458.0"}], ";", 
  RowBox[{"\[Omega]", "=", 
   RowBox[{"30", " ", 
    RowBox[{"10", "^", "6"}], "*", "2", "*", "\[Pi]"}]}], ";", 
  RowBox[{
   SubscriptBox["\[Mu]", "0"], "=", 
   RowBox[{"4", " ", "\[Pi]", " ", 
    RowBox[{"10", "^", 
     RowBox[{"-", "7"}]}]}]}], ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.467030510801816*^9, 3.467030523420287*^9}, 
   3.4671126982647467`*^9, {3.467112994722177*^9, 3.4671131146028423`*^9}, {
   3.467113445088431*^9, 3.4671134621176434`*^9}, {3.4671136474538097`*^9, 
   3.467113698994087*^9}, {3.467113776583261*^9, 3.4671138482713013`*^9}, {
   3.467113922482967*^9, 3.467114078108139*^9}, {3.467114860474598*^9, 
   3.46711486268414*^9}, {3.467396216753858*^9, 3.467396239665422*^9}, 
   3.468082007602343*^9, {3.469293549269854*^9, 3.4692936144358377`*^9}, 
   3.469294034276559*^9, {3.469373955321061*^9, 3.469373960858321*^9}, {
   3.469374026136579*^9, 3.4693740607145653`*^9}, {3.469374098076501*^9, 
   3.469374267244823*^9}, {3.469374818379158*^9, 3.469374822133709*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["kz", "2"], "+", 
       FractionBox[
        SuperscriptBox["nPhi", "2"], 
        SuperscriptBox["Rr", "2"]]}], ")"}], " ", 
     RowBox[{"Er", "[", "Rr", "]"}]}], "+", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", "nPhi", " ", 
      RowBox[{"Eth", "[", "Rr", "]"}]}], 
     SuperscriptBox["Rr", "2"]], "+", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", "nPhi", " ", 
      RowBox[{
       SuperscriptBox["Eth", "\[Prime]",
        MultilineFunction->None], "[", "Rr", "]"}]}], "Rr"], "+", 
    RowBox[{"\[ImaginaryI]", " ", "kz", " ", 
     RowBox[{
      SuperscriptBox["Ez", "\[Prime]",
       MultilineFunction->None], "[", "Rr", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", "nPhi", " ", 
       RowBox[{"Er", "[", "Rr", "]"}]}], 
      SuperscriptBox["Rr", "2"]]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["kz", "2"], "+", 
       FractionBox["1", 
        SuperscriptBox["Rr", "2"]]}], ")"}], " ", 
     RowBox[{"Eth", "[", "Rr", "]"}]}], "-", 
    FractionBox[
     RowBox[{"kz", " ", "nPhi", " ", 
      RowBox[{"Ez", "[", "Rr", "]"}]}], "Rr"], "+", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", "nPhi", " ", 
      RowBox[{
       SuperscriptBox["Er", "\[Prime]",
        MultilineFunction->None], "[", "Rr", "]"}]}], "Rr"], "-", 
    FractionBox[
     RowBox[{
      SuperscriptBox["Eth", "\[Prime]",
       MultilineFunction->None], "[", "Rr", "]"}], "Rr"], "-", 
    RowBox[{
     SuperscriptBox["Eth", "\[Prime]\[Prime]",
      MultilineFunction->None], "[", "Rr", "]"}]}], ",", 
   RowBox[{
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", "kz", " ", 
      RowBox[{"Er", "[", "Rr", "]"}]}], "Rr"], "-", 
    FractionBox[
     RowBox[{"kz", " ", "nPhi", " ", 
      RowBox[{"Eth", "[", "Rr", "]"}]}], "Rr"], "+", 
    FractionBox[
     RowBox[{
      SuperscriptBox["nPhi", "2"], " ", 
      RowBox[{"Ez", "[", "Rr", "]"}]}], 
     SuperscriptBox["Rr", "2"]], "+", 
    RowBox[{"\[ImaginaryI]", " ", "kz", " ", 
     RowBox[{
      SuperscriptBox["Er", "\[Prime]",
       MultilineFunction->None], "[", "Rr", "]"}]}], "-", 
    FractionBox[
     RowBox[{
      SuperscriptBox["Ez", "\[Prime]",
       MultilineFunction->None], "[", "Rr", "]"}], "Rr"], "-", 
    RowBox[{
     SuperscriptBox["Ez", "\[Prime]\[Prime]",
      MultilineFunction->None], "[", "Rr", "]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.469293581852903*^9, 3.46929361525483*^9, 3.4692940348994827`*^9, {
   3.4693628932801867`*^9, 3.469362907399522*^9}, 3.469373956829623*^9, 
   3.46937410927335*^9, 3.469374143753438*^9, 3.469374827514265*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.469374022315688*^9, 3.469374023143365*^9}}],

Cell[CellGroupData[{

Cell["comparison of conservative and expanded curl by curl", "Section",
 CellChangeTimes->{{3.469365017137434*^9, 3.4693650305035133`*^9}, {
  3.469365278671632*^9, 3.4693652927951717`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"I", " ", 
      RowBox[{"nPhi", " ", "/", 
       RowBox[{"Rr", "^", "2"}]}], " ", 
      RowBox[{
       SubscriptBox["\[PartialD]", "Rr"], 
       RowBox[{"(", 
        RowBox[{"Rr", " ", 
         RowBox[{"Eth", "[", "Rr", "]"}]}], ")"}]}]}], "+", 
     RowBox[{
      RowBox[{
       RowBox[{"nPhi", "^", "2"}], "/", 
       RowBox[{"Rr", "^", "2"}]}], " ", 
      RowBox[{"Er", "[", "Rr", "]"}]}], "+", 
     RowBox[{
      RowBox[{"kz", "^", "2"}], " ", 
      RowBox[{"Er", "[", "Rr", "]"}]}], "+", 
     RowBox[{"I", " ", "kz", " ", 
      RowBox[{
       SubscriptBox["\[PartialD]", "Rr"], 
       RowBox[{"Ez", "[", "Rr", "]"}]}]}]}], ")"}], "/", 
   RowBox[{"CCE", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.4692962743322487`*^9, 3.46929639074323*^9}, {
  3.469296437502771*^9, 3.469296458904656*^9}, {3.469297005135895*^9, 
  3.469297010138084*^9}}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{{3.469296353297015*^9, 3.469296391983061*^9}, {
  3.469296440967671*^9, 3.469296459233411*^9}, {3.469297007674613*^9, 
  3.469297010532674*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"I", " ", 
      RowBox[{"kz", "/", "Rr"}], 
      RowBox[{
       SubscriptBox["\[PartialD]", "Rr"], 
       RowBox[{"(", 
        RowBox[{"Rr", " ", 
         RowBox[{"Er", "[", "Rr", "]"}]}], ")"}]}]}], "-", 
     RowBox[{
      RowBox[{"1", "/", "Rr"}], " ", 
      RowBox[{
       SubscriptBox["\[PartialD]", "Rr"], 
       RowBox[{"(", 
        RowBox[{"Rr", " ", 
         RowBox[{
          SubscriptBox["\[PartialD]", "Rr"], 
          RowBox[{"Ez", "[", "Rr", "]"}]}]}], ")"}]}]}], "+", 
     RowBox[{
      RowBox[{
       RowBox[{"nPhi", "^", "2"}], "/", 
       RowBox[{"Rr", "^", "2"}]}], 
      RowBox[{"Ez", "[", "Rr", "]"}]}], "-", 
     RowBox[{"nPhi", " ", 
      RowBox[{"kz", " ", "/", "Rr"}], " ", 
      RowBox[{"Eth", "[", "Rr", "]"}]}]}], ")"}], "/", 
   RowBox[{"CCE", "[", 
    RowBox[{"[", "3", "]"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.469296463856838*^9, 3.4692965447682123`*^9}, {
  3.469296586627124*^9, 3.469296632539468*^9}, {3.469297318234776*^9, 
  3.469297318775017*^9}}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{{3.469296613778096*^9, 3.469296633403212*^9}, 
   3.469297319500577*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "kz"}], " ", 
      RowBox[{"nPhi", "/", "Rr"}], " ", 
      RowBox[{"Ez", "[", "Rr", "]"}]}], "+", 
     RowBox[{
      RowBox[{"kz", "^", "2"}], " ", 
      RowBox[{"Eth", "[", "Rr", "]"}]}], "-", 
     RowBox[{
      SubscriptBox["\[PartialD]", "Rr"], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"1", "/", "Rr"}], 
        RowBox[{
         SubscriptBox["\[PartialD]", "Rr"], 
         RowBox[{"(", 
          RowBox[{"Rr", " ", 
           RowBox[{"Eth", "[", "Rr", "]"}]}], ")"}]}]}], ")"}]}], "+", 
     RowBox[{"I", " ", "nPhi", " ", 
      RowBox[{
       SubscriptBox["\[PartialD]", "Rr"], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Er", "[", "Rr", "]"}], "/", "Rr"}], ")"}]}]}]}], ")"}], "/", 
   RowBox[{"CCE", "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.469297022706347*^9, 3.46929717890617*^9}, {
  3.469297244567129*^9, 3.4692972815795603`*^9}}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{{3.4692971705832033`*^9, 3.469297179782859*^9}, 
   3.4692972507455187`*^9, 3.469297282564124*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["comparison with the Wu et al. paper", "Section",
 CellChangeTimes->{{3.469362617773505*^9, 3.469362629010387*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Wuhr", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"I", " ", "nPhi", " ", 
       RowBox[{"Ez", "[", "Rr", "]"}]}], "-", 
      RowBox[{"I", " ", "kz", " ", "Rr", " ", 
       RowBox[{"Eth", "[", "Rr", "]"}]}]}], ")"}], "/", "I"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Wuhth", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "Rr"}], 
       RowBox[{
        SubscriptBox["\[PartialD]", "Rr"], " ", 
        RowBox[{"Ez", "[", "Rr", "]"}]}]}], "+", 
      RowBox[{"I", " ", "kz", " ", "Rr", " ", 
       RowBox[{"Er", "[", "Rr", "]"}]}]}], ")"}], "/", "I"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Wuhz", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"1", "/", "Rr"}], 
       RowBox[{
        SubscriptBox["\[PartialD]", "Rr"], 
        RowBox[{"(", 
         RowBox[{"Rr", " ", 
          RowBox[{"Eth", "[", "Rr", "]"}]}], ")"}]}]}], "-", 
      RowBox[{"I", " ", 
       RowBox[{"nPhi", "/", 
        RowBox[{"Rr", "^", "2"}]}], " ", "Rr", " ", 
       RowBox[{"Er", "[", "Rr", "]"}]}]}], ")"}], "/", "I"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.469362642919053*^9, 3.4693626456816463`*^9}, {
   3.469362696578245*^9, 3.4693628404281063`*^9}, {3.469362942314499*^9, 
   3.4693629479202747`*^9}, {3.4693632448398123`*^9, 
   3.4693632830352783`*^9}, {3.469363380214198*^9, 3.4693634012613583`*^9}, {
   3.469363450106021*^9, 3.469363453746735*^9}, 3.469364271876074*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"I", " ", "nPhi", " ", "Wuhz"}], "-", 
        RowBox[{"I", " ", "kz", "  ", "Wuhth"}]}], ")"}]}], "/", "I"}], "/", 
    "Rr"}], "/", 
   RowBox[{"CCE", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.469362843787504*^9, 3.469362883628416*^9}, {
  3.469362918590478*^9, 3.4693629341247463`*^9}, {3.469363090857565*^9, 
  3.469363091624991*^9}, {3.469363170081122*^9, 3.46936317141681*^9}, {
  3.469363461098567*^9, 3.469363475873083*^9}, {3.469363545939837*^9, 
  3.4693635676886253`*^9}, {3.469363926441427*^9, 3.469363936959002*^9}, {
  3.469364101800462*^9, 3.469364104796612*^9}, {3.469364177789136*^9, 
  3.4693641809712276`*^9}, {3.4693646324344673`*^9, 3.46936463322497*^9}}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{
  3.469363568256521*^9, 3.469363937362596*^9, {3.4693641025479*^9, 
   3.4693641052842093`*^9}, 3.46936418169689*^9, 3.469364275849162*^9, 
   3.469364633846923*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "Rr"}], 
         RowBox[{
          SubscriptBox["\[PartialD]", "Rr"], "Wuhz"}]}], "+", 
        RowBox[{"I", " ", "kz", " ", "Wuhr"}]}], ")"}]}], "/", "I"}], "/", 
    "Rr"}], "/", 
   RowBox[{"CCE", "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.469363754502345*^9, 3.469363781325054*^9}, {
  3.4693638182883368`*^9, 3.469363818895967*^9}, {3.469363883590431*^9, 
  3.4693638952310677`*^9}, {3.469364109382045*^9, 3.469364115589205*^9}, {
  3.469364281781458*^9, 3.4693642823144836`*^9}, {3.4693644193185053`*^9, 
  3.469364444989337*^9}, {3.469364508925211*^9, 3.46936451026153*^9}, {
  3.4693646247921762`*^9, 3.469364636048809*^9}}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{
  3.46936378260393*^9, 3.4693638193567266`*^9, {3.469363887063538*^9, 
   3.469363896234562*^9}, {3.46936411033149*^9, 3.469364116381917*^9}, 
   3.4693642837032003`*^9, {3.469364422134818*^9, 3.4693644496643667`*^9}, 
   3.469364510995105*^9, {3.46936462617946*^9, 3.469364636570023*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"1", "/", "Rr"}], 
        RowBox[{
         SubscriptBox["\[PartialD]", "Rr"], "Wuhth"}]}], "-", 
       RowBox[{"I", " ", 
        RowBox[{"nPhi", "/", 
         RowBox[{"Rr", "^", "2"}]}], " ", "Wuhr"}]}], ")"}]}], "/", "I"}], 
   "/", 
   RowBox[{"CCE", "[", 
    RowBox[{"[", "3", "]"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.4693639512765903`*^9, 3.469363996350381*^9}, {
  3.46936404504576*^9, 3.46936404888435*^9}, {3.469364118653223*^9, 
  3.469364121315583*^9}, {3.469364518762829*^9, 3.469364519150826*^9}, {
  3.469364628427699*^9, 3.469364647842606*^9}}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{{3.469363986443404*^9, 3.469363996862705*^9}, 
   3.469364050048134*^9, {3.469364119195106*^9, 3.4693641216705513`*^9}, 
   3.46936451974897*^9, {3.46936462913608*^9, 3.469364648531336*^9}}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.469296546581643*^9, 3.4692965831215477`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"divE", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{"Div", "[", "EField", "]"}], "/", "ExpVar"}], "]"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.467464631950495*^9, 3.467464643067532*^9}, {
   3.467464682769896*^9, 3.467464683951932*^9}, {3.4674655361661997`*^9, 
   3.46746554981322*^9}, {3.467465627134987*^9, 3.467465629522121*^9}, {
   3.4674795100887623`*^9, 3.46747951098778*^9}, {3.4674799893426123`*^9, 
   3.4674799911568727`*^9}, 3.468081832766189*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"Er", "[", "Rr", "]"}], "+", 
   RowBox[{"\[ImaginaryI]", " ", "nPhi", " ", 
    RowBox[{"Eth", "[", "Rr", "]"}]}], "+", 
   RowBox[{"\[ImaginaryI]", " ", "kz", " ", "Rr", " ", 
    RowBox[{"Ez", "[", "Rr", "]"}]}], "+", 
   RowBox[{"Rr", " ", 
    RowBox[{
     SuperscriptBox["Er", "\[Prime]",
      MultilineFunction->None], "[", "Rr", "]"}]}]}], "Rr"]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.467464645040159*^9, 3.467464684895516*^9, {3.467465539649313*^9, 
   3.467465550660543*^9}, 3.4674656301574383`*^9, 3.4674737358561583`*^9, 
   3.467479513559597*^9, 3.4674799919659147`*^9, 3.4675582631318607`*^9, 
   3.468081832766329*^9}],

Cell[BoxData[
 RowBox[{"finiteDiffDivE", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"divE", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Er", "[", "Rr", "]"}], "\[Rule]", 
        SubscriptBox["Er", "i"]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Eth", "[", "Rr", "]"}], "\[Rule]", 
        SubscriptBox["Eth", "i"]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Ez", "[", "Rr", "]"}], "\[Rule]", 
        SubscriptBox["Ez", "i"]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", "Rr"], 
         RowBox[{"Er", "[", "Rr", "]"}]}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            SubscriptBox["Er", "\"\<i-1\>\""]}], "+", 
           SubscriptBox["Er", "\"\<i+1\>\""]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"2", 
           SubscriptBox["\[CapitalDelta]", "r"]}], ")"}]}]}]}], "}"}]}], ",", 
    
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["Er", "\"\<i-1\>\""], ",", 
      SubscriptBox["Er", "i"], ",", 
      SubscriptBox["Er", "\"\<i+1\>\""], ",", 
      SubscriptBox["Eth", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Er", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Er", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Eth", "i"]}], "}"}]}], "]"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.467465638689001*^9, 3.467465740846663*^9}, {
   3.467466017121579*^9, 3.46746607352496*^9}, {3.46747510461122*^9, 
   3.467475169316496*^9}, {3.46747524646348*^9, 3.467475250157578*^9}, {
   3.467480051317449*^9, 3.467480056333741*^9}, {3.467480119622591*^9, 
   3.467480121853593*^9}, 3.468081832766412*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   SubscriptBox["Er", "i"], "Rr"], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", "nPhi", " ", 
    SubscriptBox["Eth", "i"]}], "Rr"], "+", 
  RowBox[{"\[ImaginaryI]", " ", "kz", " ", 
   SubscriptBox["Ez", "i"]}], "-", 
  FractionBox[
   SubscriptBox["Er", "\<\"i-1\"\>"], 
   RowBox[{"2", " ", 
    SubscriptBox["\[CapitalDelta]", "r"]}]], "+", 
  FractionBox[
   SubscriptBox["Er", "\<\"i+1\"\>"], 
   RowBox[{"2", " ", 
    SubscriptBox["\[CapitalDelta]", "r"]}]]}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.467465700211741*^9, 3.46746574201748*^9, 3.467466075342485*^9, {
   3.4674751461071663`*^9, 3.467475170095726*^9}, 3.467475250966309*^9, 
   3.467480057937952*^9, 3.4674801225697603`*^9, 3.468081832766499*^9}],

Cell[BoxData[
 RowBox[{"finiteDiffDivE", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"divE", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Er", "[", "Rr", "]"}], "\[Rule]", 
        SubscriptBox["Er", "\"\<i+1/2\>\""]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Eth", "[", "Rr", "]"}], "\[Rule]", 
        SubscriptBox["Eth", "\"\<i+1/2\>\""]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Ez", "[", "Rr", "]"}], "\[Rule]", 
        SubscriptBox["Ez", "\"\<i+1/2\>\""]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", "Rr"], 
         RowBox[{"Er", "[", "Rr", "]"}]}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            SubscriptBox["Er", "i"]}], "+", 
           SubscriptBox["Er", "\"\<i+1\>\""]}], ")"}], "/", 
         SubscriptBox["\[CapitalDelta]", "r"]}]}]}], "}"}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["Er", "\"\<i-1\>\""], ",", 
      SubscriptBox["Er", "i"], ",", 
      SubscriptBox["Er", "\"\<i+1\>\""], ",", 
      SubscriptBox["Eth", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Er", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Er", "\"\<i+1/2\>\""]}], "}"}]}], "]"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.4674736576437807`*^9, 3.4674736745415983`*^9}, {
   3.467473901671974*^9, 3.4674739092072783`*^9}, {3.467473972328877*^9, 
   3.4674740689511623`*^9}, {3.467474299973078*^9, 3.467474313752681*^9}, 
   3.46808183276658*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   SubscriptBox["Er", "\<\"i+1/2\"\>"], "Rr"], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", "nPhi", " ", 
    SubscriptBox["Eth", "\<\"i+1/2\"\>"]}], "Rr"], "+", 
  RowBox[{"\[ImaginaryI]", " ", "kz", " ", 
   SubscriptBox["Ez", "\<\"i+1/2\"\>"]}], "+", 
  FractionBox[
   SubscriptBox["Er", "\<\"i+1\"\>"], 
   SubscriptBox["\[CapitalDelta]", "r"]], "-", 
  FractionBox[
   SubscriptBox["Er", "i"], 
   SubscriptBox["\[CapitalDelta]", "r"]]}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.467474030495983*^9, 3.467474070155527*^9}, 
   3.467474314490143*^9, 3.467474838925352*^9, 3.468081832766663*^9}],

Cell[BoxData[
 RowBox[{"finiteDiffDivE", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"divE", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Er", "[", "Rr", "]"}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["Er", "i"], "+", 
           SubscriptBox["Er", "\"\<i+1\>\""]}], ")"}], "/", "2"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Eth", "[", "Rr", "]"}], "\[Rule]", 
        SubscriptBox["Eth", "\"\<i+1/2\>\""]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Ez", "[", "Rr", "]"}], "\[Rule]", 
        SubscriptBox["Ez", "\"\<i+1/2\>\""]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", "Rr"], 
         RowBox[{"Er", "[", "Rr", "]"}]}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            SubscriptBox["Er", "i"]}], "+", 
           SubscriptBox["Er", "\"\<i+1\>\""]}], ")"}], "/", 
         SubscriptBox["\[CapitalDelta]", "r"]}]}]}], "}"}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["Er", "\"\<i-1\>\""], ",", 
      SubscriptBox["Er", "i"], ",", 
      SubscriptBox["Er", "\"\<i+1\>\""], ",", 
      SubscriptBox["Eth", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Er", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Er", "\"\<i+1/2\>\""]}], "}"}]}], "]"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.467558271762272*^9, 3.4675582914407597`*^9}, 
   3.4680818327667437`*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", "nPhi", " ", 
    SubscriptBox["Eth", "\<\"i+1/2\"\>"]}], "Rr"], "+", 
  RowBox[{"\[ImaginaryI]", " ", "kz", " ", 
   SubscriptBox["Ez", "\<\"i+1/2\"\>"]}], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["Er", "i"], " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "2"], "-", 
      FractionBox["Rr", 
       SubscriptBox["\[CapitalDelta]", "r"]]}], ")"}]}], "Rr"], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["Er", "\<\"i+1\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "2"], "+", 
      FractionBox["Rr", 
       SubscriptBox["\[CapitalDelta]", "r"]]}], ")"}]}], "Rr"]}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.467558266557085*^9, 3.4675582941542683`*^9}, 
   3.4680818327668247`*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"centralDiffCCER", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"CCE", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "/.", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Er", "[", "Rr", "]"}], "\[Rule]", 
        SubscriptBox["Er", "i"]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Eth", "[", "Rr", "]"}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["Eth", "\"\<i+1/2\>\""], "+", 
           SubscriptBox["Eth", "\"\<i-1/2\>\""]}], ")"}], "/", "2"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Ez", "[", "Rr", "]"}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["Ez", "\"\<i+1/2\>\""], "+", 
           SubscriptBox["Ez", "\"\<i-1/2\>\""]}], ")"}], "/", "2"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", "Rr"], 
         RowBox[{"Eth", "[", "Rr", "]"}]}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            SubscriptBox["Eth", "\"\<i-1/2\>\""]}], "+", 
           SubscriptBox["Eth", "\"\<i+1/2\>\""]}], ")"}], "/", 
         SubscriptBox["\[CapitalDelta]", "r"]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", "Rr"], 
         RowBox[{"Ez", "[", "Rr", "]"}]}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            SubscriptBox["Ez", "\"\<i-1/2\>\""]}], "+", 
           SubscriptBox["Ez", "\"\<i+1/2\>\""]}], ")"}], "/", 
         SubscriptBox["\[CapitalDelta]", "r"]}]}]}], "}"}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["Er", "\"\<i-1\>\""], ",", 
      SubscriptBox["Er", "i"], ",", 
      SubscriptBox["Er", "\"\<i+1\>\""], ",", 
      SubscriptBox["Eth", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+3/2\>\""]}], "}"}], ",", "Simplify"}], 
   "]"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 CellChangeTimes->{{3.46711486696596*^9, 3.467114959908531*^9}, {
   3.46711502692426*^9, 3.467115039230502*^9}, {3.467115079855693*^9, 
   3.467115183938445*^9}, {3.467115217136676*^9, 3.467115344723304*^9}, {
   3.467115378264489*^9, 3.467115521585041*^9}, {3.467115552982044*^9, 
   3.467115585083452*^9}, {3.467115733690442*^9, 3.467115810223687*^9}, {
   3.467115949314406*^9, 3.467115966767949*^9}, {3.467116174392415*^9, 
   3.467116193584591*^9}, {3.46711624236598*^9, 3.467116273107946*^9}, {
   3.4671163157900667`*^9, 3.4671164597113743`*^9}, {3.46711649861541*^9, 
   3.467116501929596*^9}, {3.467116595046652*^9, 3.467116596723604*^9}, {
   3.467117001681385*^9, 3.467117053140646*^9}, {3.467117229942638*^9, 
   3.467117237069922*^9}, {3.467117319421308*^9, 3.467117321300304*^9}, 
   3.4671178373188057`*^9, {3.467120903290702*^9, 3.4671209106576967`*^9}, {
   3.4673962864841003`*^9, 3.4673962970708942`*^9}, 3.467721327119359*^9, {
   3.4677213720956917`*^9, 3.467721372705097*^9}, 3.468081861810953*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["kz", "2"], "+", 
     FractionBox[
      SuperscriptBox["nPhi", "2"], 
      SuperscriptBox["Rr", "2"]]}], ")"}], " ", 
   SubscriptBox["Er", "i"]}], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", "nPhi", " ", 
    SubscriptBox["Eth", "\<\"i-1/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      FractionBox[
       RowBox[{"2", " ", "Rr"}], 
       SubscriptBox["\[CapitalDelta]", "r"]]}], ")"}]}], 
   RowBox[{"2", " ", 
    SuperscriptBox["Rr", "2"]}]], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", "kz", " ", 
    SubscriptBox["Ez", "\<\"i-1/2\"\>"]}], 
   SubscriptBox["\[CapitalDelta]", "r"]], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", "kz", " ", 
    SubscriptBox["Ez", "\<\"i+1/2\"\>"]}], 
   SubscriptBox["\[CapitalDelta]", "r"]], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", "nPhi", " ", 
    SubscriptBox["Eth", "\<\"i+1/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "Rr"}], "+", 
      SubscriptBox["\[CapitalDelta]", "r"]}], ")"}]}], 
   RowBox[{"2", " ", 
    SuperscriptBox["Rr", "2"], " ", 
    SubscriptBox["\[CapitalDelta]", "r"]}]]}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 CellChangeTimes->{
  3.4671162737509623`*^9, {3.4671163278171988`*^9, 3.467116377430644*^9}, 
   3.467116461325861*^9, 3.467116503350456*^9, 3.467116598361773*^9, {
   3.467117026602261*^9, 3.467117055072234*^9}, 3.467117243676259*^9, 
   3.4671173241509857`*^9, 3.467117838477056*^9, 3.467638847228546*^9, 
   3.467719893913512*^9, 3.467721343816605*^9, 3.4677213740203657`*^9, 
   3.468081861811076*^9}],

Cell[BoxData[
 RowBox[{"centralDiffCCETh", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"CCE", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "/.", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Er", "[", "Rr", "]"}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["Er", "i"], "+", 
           SubscriptBox["Er", "\"\<i+1\>\""]}], ")"}], "/", "2"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Eth", "[", "Rr", "]"}], "\[Rule]", 
        SubscriptBox["Eth", "\"\<i+1/2\>\""]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Ez", "[", "Rr", "]"}], "\[Rule]", 
        SubscriptBox["Ez", "\"\<i+1/2\>\""]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", "Rr"], 
         RowBox[{"Er", "[", "Rr", "]"}]}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            SubscriptBox["Er", "i"]}], "+", 
           SubscriptBox["Er", "\"\<i+1\>\""]}], ")"}], "/", 
         SubscriptBox["\[CapitalDelta]", "r"]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", "Rr"], 
         RowBox[{"Eth", "[", "Rr", "]"}]}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            SubscriptBox["Eth", "\"\<i-1/2\>\""]}], "+", 
           SubscriptBox["Eth", "\"\<i+3/2\>\""]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"2", " ", 
           SubscriptBox["\[CapitalDelta]", "r"]}], ")"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", 
          RowBox[{"Rr", ",", "Rr"}]], 
         RowBox[{"Eth", "[", "Rr", "]"}]}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["Eth", "\"\<i-1/2\>\""], "-", 
           RowBox[{"2", " ", 
            SubscriptBox["Eth", "\"\<i+1/2\>\""]}], "+", 
           SubscriptBox["Eth", "\"\<i+3/2\>\""]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["\[CapitalDelta]", "r"], "^", "2"}], ")"}]}]}]}], 
      "}"}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["Er", "\"\<i-1\>\""], ",", 
      SubscriptBox["Er", "i"], ",", 
      SubscriptBox["Er", "\"\<i+1\>\""], ",", 
      SubscriptBox["Eth", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+3/2\>\""]}], "}"}], ",", "Simplify"}], 
   "]"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 CellChangeTimes->{{3.467117541690158*^9, 3.467117683942123*^9}, {
   3.46711782075948*^9, 3.4671178269913387`*^9}, {3.4673963018211317`*^9, 
   3.467396314982942*^9}, {3.467397444741393*^9, 3.467397448785953*^9}, {
   3.467721466565564*^9, 3.467721469948475*^9}, 3.468081861811154*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{"kz", " ", "nPhi", " ", 
     SubscriptBox["Ez", "\<\"i+1/2\"\>"]}], "Rr"]}], "+", 
  RowBox[{
   SubscriptBox["Eth", "\<\"i+1/2\"\>"], " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["kz", "2"], "+", 
     FractionBox["1", 
      SuperscriptBox["Rr", "2"]], "+", 
     FractionBox["2", 
      SubsuperscriptBox["\[CapitalDelta]", "r", "2"]]}], ")"}]}], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", "nPhi", " ", 
    SubscriptBox["Er", "\<\"i+1\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "Rr"}], "-", 
      SubscriptBox["\[CapitalDelta]", "r"]}], ")"}]}], 
   RowBox[{"2", " ", 
    SuperscriptBox["Rr", "2"], " ", 
    SubscriptBox["\[CapitalDelta]", "r"]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["Eth", "\<\"i-1/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", "Rr"}], "+", 
      SubscriptBox["\[CapitalDelta]", "r"]}], ")"}]}], 
   RowBox[{"2", " ", "Rr", " ", 
    SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", "nPhi", " ", 
    SubscriptBox["Er", "i"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "Rr"}], "+", 
      SubscriptBox["\[CapitalDelta]", "r"]}], ")"}]}], 
   RowBox[{"2", " ", 
    SuperscriptBox["Rr", "2"], " ", 
    SubscriptBox["\[CapitalDelta]", "r"]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["Eth", "\<\"i+3/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{"2", "+", 
      FractionBox[
       SubscriptBox["\[CapitalDelta]", "r"], "Rr"]}], ")"}]}], 
   RowBox[{"2", " ", 
    SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]]}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 CellChangeTimes->{3.467117628972191*^9, 3.467117684879393*^9, 
  3.467117828685483*^9, 3.467397450540337*^9, 3.4677214708951597`*^9, 
  3.468081861811227*^9}],

Cell[BoxData[
 RowBox[{"centralDiffCCEZ", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"CCE", "[", 
      RowBox[{"[", "3", "]"}], "]"}], "/.", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Er", "[", "Rr", "]"}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["Er", "i"], "+", 
           SubscriptBox["Er", "\"\<i+1\>\""]}], ")"}], "/", "2"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Eth", "[", "Rr", "]"}], "\[Rule]", 
        SubscriptBox["Eth", "\"\<i+1/2\>\""]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Ez", "[", "Rr", "]"}], "\[Rule]", 
        SubscriptBox["Ez", "\"\<i+1/2\>\""]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", "Rr"], 
         RowBox[{"Er", "[", "Rr", "]"}]}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            SubscriptBox["Er", "i"]}], "+", 
           SubscriptBox["Er", "\"\<i+1\>\""]}], ")"}], "/", 
         SubscriptBox["\[CapitalDelta]", "r"]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", "Rr"], 
         RowBox[{"Ez", "[", "Rr", "]"}]}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            SubscriptBox["Ez", "\"\<i-1/2\>\""]}], "+", 
           SubscriptBox["Ez", "\"\<i+3/2\>\""]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"2", " ", 
           SubscriptBox["\[CapitalDelta]", "r"]}], ")"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", 
          RowBox[{"Rr", ",", "Rr"}]], 
         RowBox[{"Ez", "[", "Rr", "]"}]}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["Ez", "\"\<i-1/2\>\""], "-", 
           RowBox[{"2", " ", 
            SubscriptBox["Ez", "\"\<i+1/2\>\""]}], "+", 
           SubscriptBox["Ez", "\"\<i+3/2\>\""]}], ")"}], "/", 
         RowBox[{
          SubscriptBox["\[CapitalDelta]", "r"], "^", "2"}]}]}]}], "}"}]}], 
    ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["Er", "\"\<i-1\>\""], ",", 
      SubscriptBox["Er", "i"], ",", 
      SubscriptBox["Er", "\"\<i+1\>\""], ",", 
      SubscriptBox["Eth", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+3/2\>\""]}], "}"}], ",", "Simplify"}], 
   "]"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 CellChangeTimes->{{3.467118235882575*^9, 3.4671182652263193`*^9}, {
   3.467396318377055*^9, 3.4673963295521603`*^9}, {3.467721491480073*^9, 
   3.467721504810925*^9}, 3.4680818618112993`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{"kz", " ", "nPhi", " ", 
     SubscriptBox["Eth", "\<\"i+1/2\"\>"]}], "Rr"]}], "+", 
  RowBox[{
   SubscriptBox["Ez", "\<\"i+1/2\"\>"], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      SuperscriptBox["nPhi", "2"], 
      SuperscriptBox["Rr", "2"]], "+", 
     FractionBox["2", 
      SubsuperscriptBox["\[CapitalDelta]", "r", "2"]]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", "kz", " ", 
   SubscriptBox["Er", "i"], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox["1", "Rr"], "-", 
     FractionBox["2", 
      SubscriptBox["\[CapitalDelta]", "r"]]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", "kz", " ", 
   SubscriptBox["Er", "\<\"i+1\"\>"], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox["1", "Rr"], "+", 
     FractionBox["2", 
      SubscriptBox["\[CapitalDelta]", "r"]]}], ")"}]}], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["Ez", "\<\"i-1/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", "Rr"}], "+", 
      SubscriptBox["\[CapitalDelta]", "r"]}], ")"}]}], 
   RowBox[{"2", " ", "Rr", " ", 
    SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["Ez", "\<\"i+3/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{"2", "+", 
      FractionBox[
       SubscriptBox["\[CapitalDelta]", "r"], "Rr"]}], ")"}]}], 
   RowBox[{"2", " ", 
    SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]]}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 CellChangeTimes->{3.467732628525804*^9, 3.468081861811366*^9}]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Finite diff versions of curl by curl in r conservative form", "Section",
 CellChangeTimes->{{3.4680820282175198`*^9, 3.46808205411239*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"centralDiffCCEzCons", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"I", " ", 
       RowBox[{"kz", " ", "/", " ", 
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["r", "\"\<i+1/2\>\""], " ", 
          SubscriptBox["\[CapitalDelta]", "r"]}], ")"}]}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SubscriptBox["r", "\"\<i+1\>\""], 
          SubscriptBox["Er", "\"\<i+1\>\""]}], "-", 
         RowBox[{
          SubscriptBox["r", "i"], 
          SubscriptBox["Er", "i"]}]}], ")"}]}], "\[IndentingNewLine]", "-", 
      RowBox[{
       RowBox[{"1", "/", 
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["r", "\"\<i+1/2\>\""], 
          RowBox[{
           SubscriptBox["\[CapitalDelta]", "r"], "^", "2"}]}], ")"}]}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SubscriptBox["r", "\"\<i+1\>\""], 
          SubscriptBox["Ez", "\"\<i+3/2\>\""]}], "-", 
         RowBox[{
          RowBox[{"(", " ", 
           RowBox[{
            SubscriptBox["r", "\"\<i+1\>\""], "+", 
            SubscriptBox["r", "i"]}], ")"}], 
          SubscriptBox["Ez", "\"\<i+1/2\>\""]}], "+", 
         RowBox[{
          SubscriptBox["r", "i"], 
          SubscriptBox["Ez", "\"\<i-1/2\>\""]}]}], ")"}]}], 
      "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["n", "\[Phi]"], "^", "2"}], "/", 
        RowBox[{
         SubscriptBox["r", "\"\<i+1/2\>\""], "^", "2"}]}], 
       SubscriptBox["Ez", "\"\<i+1/2\>\""]}], "\[IndentingNewLine]", "-", 
      RowBox[{
       SubscriptBox["n", "\[Phi]"], "kz", " ", 
       RowBox[{
        SubscriptBox["Eth", "\"\<i+1/2\>\""], "/", 
        SubscriptBox["r", "\"\<i+1/2\>\""]}]}]}], "}"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["Er", "\"\<i-1\>\""], ",", 
      SubscriptBox["Er", "i"], ",", 
      SubscriptBox["Er", "\"\<i+1\>\""], ",", 
      SubscriptBox["Eth", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+3/2\>\""]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.467730282987255*^9, 3.467730673272217*^9}, {
  3.4677325607270308`*^9, 3.467732587280139*^9}, {3.469287641538437*^9, 
  3.469287664376898*^9}, {3.46928803104016*^9, 3.4692880461976624`*^9}, {
  3.469288138541112*^9, 3.4692881390288897`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     RowBox[{"kz", " ", 
      SubscriptBox["Eth", "\<\"i+1/2\"\>"], " ", 
      SubscriptBox["n", "\[Phi]"]}], 
     SubscriptBox["r", "\<\"i+1/2\"\>"]]}], "+", 
   RowBox[{
    SubscriptBox["Ez", "\<\"i+1/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       SubsuperscriptBox["n", "\[Phi]", "2"], 
       SubsuperscriptBox["r", "\<\"i+1/2\"\>", "2"]], "+", 
      FractionBox[
       RowBox[{
        SubscriptBox["r", "\<\"i+1\"\>"], "+", 
        SubscriptBox["r", "i"]}], 
       RowBox[{
        SubscriptBox["r", "\<\"i+1/2\"\>"], " ", 
        SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]]}], ")"}]}], "-", 
   FractionBox[
    RowBox[{
     SubscriptBox["Ez", "\<\"i+3/2\"\>"], " ", 
     SubscriptBox["r", "\<\"i+1\"\>"]}], 
    RowBox[{
     SubscriptBox["r", "\<\"i+1/2\"\>"], " ", 
     SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]], "-", 
   FractionBox[
    RowBox[{
     SubscriptBox["Ez", "\<\"i-1/2\"\>"], " ", 
     SubscriptBox["r", "i"]}], 
    RowBox[{
     SubscriptBox["r", "\<\"i+1/2\"\>"], " ", 
     SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]], "+", 
   FractionBox[
    RowBox[{"\[ImaginaryI]", " ", "kz", " ", 
     SubscriptBox["Er", "\<\"i+1\"\>"], " ", 
     SubscriptBox["r", "\<\"i+1\"\>"]}], 
    RowBox[{
     SubscriptBox["r", "\<\"i+1/2\"\>"], " ", 
     SubscriptBox["\[CapitalDelta]", "r"]}]], "-", 
   FractionBox[
    RowBox[{"\[ImaginaryI]", " ", "kz", " ", 
     SubscriptBox["Er", "i"], " ", 
     SubscriptBox["r", "i"]}], 
    RowBox[{
     SubscriptBox["r", "\<\"i+1/2\"\>"], " ", 
     SubscriptBox["\[CapitalDelta]", "r"]}]]}], "}"}]], "Output",
 CellChangeTimes->{
  3.467730585894215*^9, {3.467730622898634*^9, 3.467730674419004*^9}, 
   3.467732589485693*^9, 3.467732631028617*^9, 3.468081265535933*^9, 
   3.468081318893442*^9, 3.4692007630642033`*^9, 3.469287666074332*^9, 
   3.469287723208374*^9, 3.4692880487480183`*^9, 3.46928814037768*^9, 
   3.469289317231502*^9, 3.4693680887355433`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"centralDiffCCEthCons", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "kz"}], " ", 
       RowBox[{
        SubscriptBox["n", "\[Phi]"], "/", 
        SubscriptBox["r", "\"\<i+1/2\>\""]}], 
       SubscriptBox["Ez", "\"\<i+1/2\>\""]}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"kz", "^", "2"}], " ", 
       SubscriptBox["Eth", "\"\<i+1/2\>\""]}], "\[IndentingNewLine]", "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SubscriptBox["r", "\"\<i+3/2\>\""], 
          RowBox[{
           SubscriptBox["Eth", "\"\<i+3/2\>\""], "/", 
           SubscriptBox["r", "\"\<i+1\>\""]}]}], "-", 
         RowBox[{
          SubscriptBox["r", "\"\<i+1/2\>\""], 
          RowBox[{
           SubscriptBox["Eth", "\"\<i+1/2\>\""], "/", 
           SubscriptBox["r", "\"\<i+1\>\""]}]}], "-", 
         RowBox[{
          SubscriptBox["r", "\"\<i+1/2\>\""], 
          RowBox[{
           SubscriptBox["Eth", "\"\<i+1/2\>\""], "/", 
           SubscriptBox["r", "i"]}]}], "+", 
         RowBox[{
          SubscriptBox["r", "\"\<i-1/2\>\""], 
          RowBox[{
           SubscriptBox["Eth", "\"\<i-1/2\>\""], "/", 
           SubscriptBox["r", "i"]}]}]}], ")"}], "/", 
       RowBox[{
        SubscriptBox["\[CapitalDelta]", "r"], "^", "2"}]}], 
      "\[IndentingNewLine]", "+", 
      RowBox[{"I", " ", 
       RowBox[{
        SubscriptBox["n", "\[Phi]"], "/", 
        SubscriptBox["\[CapitalDelta]", "r"]}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SubscriptBox["Er", "\"\<i+1\>\""], "/", 
          SubscriptBox["r", "\"\<i+1\>\""]}], "-", 
         RowBox[{
          SubscriptBox["Er", "i"], "/", 
          SubscriptBox["r", "i"]}]}], ")"}]}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["Er", "\"\<i-1\>\""], ",", 
      SubscriptBox["Er", "i"], ",", 
      SubscriptBox["Er", "\"\<i+1\>\""], ",", 
      SubscriptBox["Eth", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+3/2\>\""]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.467733850611885*^9, 3.467734141804339*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     RowBox[{"kz", " ", 
      SubscriptBox["Ez", "\<\"i+1/2\"\>"], " ", 
      SubscriptBox["n", "\[Phi]"]}], 
     SubscriptBox["r", "\<\"i+1/2\"\>"]]}], "+", 
   RowBox[{
    SubscriptBox["Eth", "\<\"i+1/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["kz", "2"], "+", 
      FractionBox[
       SubscriptBox["r", "\<\"i+1/2\"\>"], 
       RowBox[{
        SubscriptBox["r", "\<\"i+1\"\>"], " ", 
        SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]], "+", 
      FractionBox[
       SubscriptBox["r", "\<\"i+1/2\"\>"], 
       RowBox[{
        SubscriptBox["r", "i"], " ", 
        SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]]}], ")"}]}], "-", 
   FractionBox[
    RowBox[{
     SubscriptBox["Eth", "\<\"i+3/2\"\>"], " ", 
     SubscriptBox["r", "\<\"i+3/2\"\>"]}], 
    RowBox[{
     SubscriptBox["r", "\<\"i+1\"\>"], " ", 
     SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]], "-", 
   FractionBox[
    RowBox[{
     SubscriptBox["Eth", "\<\"i-1/2\"\>"], " ", 
     SubscriptBox["r", "\<\"i-1/2\"\>"]}], 
    RowBox[{
     SubscriptBox["r", "i"], " ", 
     SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]], "+", 
   FractionBox[
    RowBox[{"\[ImaginaryI]", " ", 
     SubscriptBox["Er", "\<\"i+1\"\>"], " ", 
     SubscriptBox["n", "\[Phi]"]}], 
    RowBox[{
     SubscriptBox["r", "\<\"i+1\"\>"], " ", 
     SubscriptBox["\[CapitalDelta]", "r"]}]], "-", 
   FractionBox[
    RowBox[{"\[ImaginaryI]", " ", 
     SubscriptBox["Er", "i"], " ", 
     SubscriptBox["n", "\[Phi]"]}], 
    RowBox[{
     SubscriptBox["r", "i"], " ", 
     SubscriptBox["\[CapitalDelta]", "r"]}]]}], "}"}]], "Output",
 CellChangeTimes->{{3.467734119495326*^9, 3.467734143097394*^9}, 
   3.4680002815506563`*^9, 3.468081028955237*^9, 3.4692007652189083`*^9, 
   3.469289320153891*^9, 3.4693680914745607`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"centralDiffCCErCons", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"I", " ", 
       RowBox[{
        SubscriptBox["n", "\[Phi]"], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SubscriptBox["r", "i"], "^", "2"}], " ", 
          SubscriptBox["\[CapitalDelta]", "r"]}], ")"}]}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SubscriptBox["r", "\"\<i+1/2\>\""], 
          SubscriptBox["Eth", "\"\<i+1/2\>\""]}], "-", 
         RowBox[{
          SubscriptBox["r", "\"\<i-1/2\>\""], 
          SubscriptBox["Eth", "\"\<i-1/2\>\""]}]}], ")"}]}], 
      "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["n", "\[Phi]"], "^", "2"}], "/", 
        RowBox[{
         SubscriptBox["r", "i"], "^", "2"}]}], 
       SubscriptBox["Er", "i"]}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"kz", "^", "2"}], " ", 
       SubscriptBox["Er", "i"]}], "\[IndentingNewLine]", "+", 
      RowBox[{"I", " ", "kz", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["Ez", "\"\<i+1/2\>\""], "-", 
          SubscriptBox["Ez", "\"\<i-1/2\>\""]}], ")"}], "/", 
        SubscriptBox["\[CapitalDelta]", "r"]}]}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["Er", "\"\<i-1\>\""], ",", 
      SubscriptBox["Er", "i"], ",", 
      SubscriptBox["Er", "\"\<i+1\>\""], ",", 
      SubscriptBox["Eth", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+3/2\>\""]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.467734537124938*^9, 3.467734604126576*^9}, {
  3.4677346609779663`*^9, 3.467734736981732*^9}, {3.467734777762794*^9, 
  3.467734848046871*^9}, {3.46928753267173*^9, 3.4692875331166677`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SubscriptBox["Er", "i"], " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["kz", "2"], "+", 
      FractionBox[
       SubsuperscriptBox["n", "\[Phi]", "2"], 
       SubsuperscriptBox["r", "i", "2"]]}], ")"}]}], "-", 
   FractionBox[
    RowBox[{"\[ImaginaryI]", " ", "kz", " ", 
     SubscriptBox["Ez", "\<\"i-1/2\"\>"]}], 
    SubscriptBox["\[CapitalDelta]", "r"]], "+", 
   FractionBox[
    RowBox[{"\[ImaginaryI]", " ", "kz", " ", 
     SubscriptBox["Ez", "\<\"i+1/2\"\>"]}], 
    SubscriptBox["\[CapitalDelta]", "r"]], "-", 
   FractionBox[
    RowBox[{"\[ImaginaryI]", " ", 
     SubscriptBox["Eth", "\<\"i-1/2\"\>"], " ", 
     SubscriptBox["n", "\[Phi]"], " ", 
     SubscriptBox["r", "\<\"i-1/2\"\>"]}], 
    RowBox[{
     SubsuperscriptBox["r", "i", "2"], " ", 
     SubscriptBox["\[CapitalDelta]", "r"]}]], "+", 
   FractionBox[
    RowBox[{"\[ImaginaryI]", " ", 
     SubscriptBox["Eth", "\<\"i+1/2\"\>"], " ", 
     SubscriptBox["n", "\[Phi]"], " ", 
     SubscriptBox["r", "\<\"i+1/2\"\>"]}], 
    RowBox[{
     SubsuperscriptBox["r", "i", "2"], " ", 
     SubscriptBox["\[CapitalDelta]", "r"]}]]}], "}"}]], "Output",
 CellChangeTimes->{3.467734811414145*^9, 3.467734849020029*^9, 
  3.467999956805768*^9, 3.4680806739944983`*^9, 3.469200767641574*^9, 
  3.4692875499728737`*^9, 3.469289322509226*^9, 3.469368094031177*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["lhs of wave eqn ", "Section",
 CellChangeTimes->{{3.468082066097185*^9, 3.468082073216584*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"lhsCentralDiffR", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"centralDiffCCErCons", "-", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Omega]", "^", "2"}], "/", 
       RowBox[{"c", "^", "2"}]}], " ", 
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         SubsuperscriptBox["\[Epsilon]", "i", "rr"], 
         SubscriptBox["Er", "i"]}], "\[IndentingNewLine]", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["r", "\"\<i-1/2\>\""], 
            SubsuperscriptBox["\[Epsilon]", "\"\<i-1/2\>\"", "r\[Theta]"], 
            SubscriptBox["Eth", "\"\<i-1/2\>\""]}], "+", 
           RowBox[{
            SubscriptBox["r", "\"\<i+1/2\>\""], 
            SubsuperscriptBox["\[Epsilon]", "\"\<i+1/2\>\"", "r\[Theta]"], 
            SubscriptBox["Eth", "\"\<i+1/2\>\""]}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["r", "i"], "2"}], ")"}]}], "\[IndentingNewLine]", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["r", "\"\<i-1/2\>\""], 
            SubsuperscriptBox["\[Epsilon]", "\"\<i-1/2\>\"", "rz"], 
            SubscriptBox["Ez", "\"\<i-1/2\>\""]}], "+", 
           RowBox[{
            SubscriptBox["r", "\"\<i+1/2\>\""], 
            SubsuperscriptBox["\[Epsilon]", "\"\<i+1/2\>\"", "rz"], 
            SubscriptBox["Ez", "\"\<i+1/2\>\""]}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["r", "i"], "2"}], ")"}]}]}], "\[IndentingNewLine]", 
       ")"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["Er", "\"\<i-1\>\""], ",", 
      SubscriptBox["Er", "i"], ",", 
      SubscriptBox["Er", "\"\<i+1\>\""], ",", 
      SubscriptBox["Eth", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+3/2\>\""]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.467118539167849*^9, 3.4671187614832687`*^9}, {
  3.467118832411359*^9, 3.467118843337426*^9}, {3.467118951486752*^9, 
  3.4671190871795053`*^9}, {3.467721728243784*^9, 3.467721740976564*^9}, {
  3.467732733805286*^9, 3.4677327370117693`*^9}, {3.467734894748211*^9, 
  3.467734895751389*^9}, {3.468080683395114*^9, 3.468080739833275*^9}, {
  3.468080905228406*^9, 3.468080906765057*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SubscriptBox["Ez", "\<\"i-1/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "kz"}], 
        SubscriptBox["\[CapitalDelta]", "r"]]}], "-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["\[Omega]", "2"], " ", 
        SubscriptBox["r", "\<\"i-1/2\"\>"], " ", 
        SubsuperscriptBox["\[Epsilon]", "\<\"i-1/2\"\>", "rz"]}], 
       RowBox[{"2", " ", 
        SuperscriptBox["c", "2"], " ", 
        SubscriptBox["r", "i"]}]]}], ")"}]}], "+", 
   RowBox[{
    SubscriptBox["Eth", "\<\"i-1/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", 
         SubscriptBox["n", "\[Phi]"], " ", 
         SubscriptBox["r", "\<\"i-1/2\"\>"]}], 
        RowBox[{
         SubsuperscriptBox["r", "i", "2"], " ", 
         SubscriptBox["\[CapitalDelta]", "r"]}]]}], "-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["\[Omega]", "2"], " ", 
        SubscriptBox["r", "\<\"i-1/2\"\>"], " ", 
        SubsuperscriptBox["\[Epsilon]", "\<\"i-1/2\"\>", "r\[Theta]"]}], 
       RowBox[{"2", " ", 
        SuperscriptBox["c", "2"], " ", 
        SubscriptBox["r", "i"]}]]}], ")"}]}], "+", 
   RowBox[{
    SubscriptBox["Ez", "\<\"i+1/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", "kz"}], 
       SubscriptBox["\[CapitalDelta]", "r"]], "-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["\[Omega]", "2"], " ", 
        SubscriptBox["r", "\<\"i+1/2\"\>"], " ", 
        SubsuperscriptBox["\[Epsilon]", "\<\"i+1/2\"\>", "rz"]}], 
       RowBox[{"2", " ", 
        SuperscriptBox["c", "2"], " ", 
        SubscriptBox["r", "i"]}]]}], ")"}]}], "+", 
   RowBox[{
    SubscriptBox["Eth", "\<\"i+1/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", 
        SubscriptBox["n", "\[Phi]"], " ", 
        SubscriptBox["r", "\<\"i+1/2\"\>"]}], 
       RowBox[{
        SubsuperscriptBox["r", "i", "2"], " ", 
        SubscriptBox["\[CapitalDelta]", "r"]}]], "-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["\[Omega]", "2"], " ", 
        SubscriptBox["r", "\<\"i+1/2\"\>"], " ", 
        SubsuperscriptBox["\[Epsilon]", "\<\"i+1/2\"\>", "r\[Theta]"]}], 
       RowBox[{"2", " ", 
        SuperscriptBox["c", "2"], " ", 
        SubscriptBox["r", "i"]}]]}], ")"}]}], "+", 
   RowBox[{
    SubscriptBox["Er", "i"], " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["kz", "2"], "+", 
      FractionBox[
       SubsuperscriptBox["n", "\[Phi]", "2"], 
       SubscriptBox["r", "i"]], "-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["\[Omega]", "2"], " ", 
        SubsuperscriptBox["\[Epsilon]", "i", "rr"]}], 
       SuperscriptBox["c", "2"]]}], ")"}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.467118763614427*^9, 3.467118844898011*^9, 3.4671190884653053`*^9, 
   3.467638852179057*^9, 3.467721744681933*^9, 3.467734896581316*^9, 
   3.467999960381627*^9, {3.468080712667226*^9, 3.468080740585677*^9}, 
   3.4680809078727093`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"lhsCentralDiffTh", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"centralDiffCCEthCons", "-", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Omega]", "^", "2"}], "/", 
       RowBox[{"c", "^", "2"}]}], " ", 
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["r", "i"], 
            SubsuperscriptBox["\[Epsilon]", "i", "\[Theta]r"], 
            SubscriptBox["Er", "i"]}], "+", 
           RowBox[{
            SubscriptBox["r", "\"\<i+1\>\""], 
            SubsuperscriptBox["\[Epsilon]", "\"\<i+1\>\"", "\[Theta]r"], 
            SubscriptBox["Er", "\"\<i+1\>\""]}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["r", "\"\<i+1/2\>\""], "2"}], ")"}]}], 
        "\[IndentingNewLine]", "+", 
        RowBox[{
         SubsuperscriptBox["\[Epsilon]", "\"\<i+1/2\>\"", "\[Theta]\[Theta]"], 
         SubscriptBox["Eth", "\"\<i+1/2\>\""]}], "\[IndentingNewLine]", "+", 
        RowBox[{
         SubsuperscriptBox["\[Epsilon]", "\"\<i+1/2\>\"", "\[Theta]z"], 
         SubscriptBox["Ez", "\"\<i+1/2\>\""]}]}], "\[IndentingNewLine]", 
       ")"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["Er", "\"\<i-1\>\""], ",", 
      SubscriptBox["Er", "i"], ",", 
      SubscriptBox["Er", "\"\<i+1\>\""], ",", 
      SubscriptBox["Eth", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+3/2\>\""]}], "}"}], ",", "Simplify"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.467119216181141*^9, 3.467119316858678*^9}, {
  3.4671194143861113`*^9, 3.467119429819611*^9}, {3.4677219365281887`*^9, 
  3.467721946857273*^9}, {3.467734192003886*^9, 3.467734200154168*^9}, {
  3.468081039439087*^9, 3.4680810582615023`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      SubscriptBox["Eth", "\<\"i+3/2\"\>"], " ", 
      SubscriptBox["r", "\<\"i+3/2\"\>"]}], 
     RowBox[{
      SubscriptBox["r", "\<\"i+1\"\>"], " ", 
      SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]]}], "-", 
   FractionBox[
    RowBox[{
     SubscriptBox["Eth", "\<\"i-1/2\"\>"], " ", 
     SubscriptBox["r", "\<\"i-1/2\"\>"]}], 
    RowBox[{
     SubscriptBox["r", "i"], " ", 
     SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]], "+", 
   RowBox[{
    SubscriptBox["Er", "\<\"i+1\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", 
        SubscriptBox["n", "\[Phi]"]}], 
       RowBox[{
        SubscriptBox["r", "\<\"i+1\"\>"], " ", 
        SubscriptBox["\[CapitalDelta]", "r"]}]], "-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["\[Omega]", "2"], " ", 
        SubscriptBox["r", "\<\"i+1\"\>"], " ", 
        SubsuperscriptBox["\[Epsilon]", "\<\"i+1\"\>", "\[Theta]r"]}], 
       RowBox[{"2", " ", 
        SuperscriptBox["c", "2"], " ", 
        SubscriptBox["r", "\<\"i+1/2\"\>"]}]]}], ")"}]}], "+", 
   RowBox[{
    SubscriptBox["Ez", "\<\"i+1/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{"kz", " ", 
         SubscriptBox["n", "\[Phi]"]}], 
        SubscriptBox["r", "\<\"i+1/2\"\>"]]}], "-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["\[Omega]", "2"], " ", 
        SubsuperscriptBox["\[Epsilon]", "\<\"i+1/2\"\>", "\[Theta]z"]}], 
       SuperscriptBox["c", "2"]]}], ")"}]}], "+", 
   RowBox[{
    SubscriptBox["Eth", "\<\"i+1/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["kz", "2"], "+", 
      FractionBox[
       SubscriptBox["r", "\<\"i+1/2\"\>"], 
       RowBox[{
        SubscriptBox["r", "\<\"i+1\"\>"], " ", 
        SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]], "+", 
      FractionBox[
       SubscriptBox["r", "\<\"i+1/2\"\>"], 
       RowBox[{
        SubscriptBox["r", "i"], " ", 
        SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]], "-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["\[Omega]", "2"], " ", 
        SubsuperscriptBox["\[Epsilon]", "\<\"i+1/2\"\>", 
         "\[Theta]\[Theta]"]}], 
       SuperscriptBox["c", "2"]]}], ")"}]}], "+", 
   RowBox[{
    SubscriptBox["Er", "i"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", 
         SubscriptBox["n", "\[Phi]"]}], 
        RowBox[{
         SubscriptBox["r", "i"], " ", 
         SubscriptBox["\[CapitalDelta]", "r"]}]]}], "-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["\[Omega]", "2"], " ", 
        SubscriptBox["r", "i"], " ", 
        SubsuperscriptBox["\[Epsilon]", "i", "\[Theta]r"]}], 
       RowBox[{"2", " ", 
        SuperscriptBox["c", "2"], " ", 
        SubscriptBox["r", "\<\"i+1/2\"\>"]}]]}], ")"}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.467119317649967*^9, 3.467119431412118*^9, 3.46772196403935*^9, {
   3.467734193913422*^9, 3.467734200636364*^9}, 3.4680002894398193`*^9, {
   3.468081034833667*^9, 3.4680810589726057`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"lhsCentralDiffZ", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"centralDiffCCEzCons", "-", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Omega]", "^", "2"}], "/", 
       RowBox[{"c", "^", "2"}]}], " ", 
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["r", "i"], 
            SubsuperscriptBox["\[Epsilon]", "i", "zr"], 
            SubscriptBox["Er", "i"]}], "+", 
           RowBox[{
            SubscriptBox["r", "\"\<i+1\>\""], 
            SubsuperscriptBox["\[Epsilon]", "\"\<i+1\>\"", "zr"], 
            SubscriptBox["Er", "\"\<i+1\>\""]}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["r", "\"\<i+1/2\>\""], "2"}], ")"}]}], 
        "\[IndentingNewLine]", "+", 
        RowBox[{
         SubsuperscriptBox["\[Epsilon]", "\"\<i+1/2\>\"", "z\[Theta]"], 
         SubscriptBox["Eth", "\"\<i+1/2\>\""]}], "\[IndentingNewLine]", "+", 
        RowBox[{
         SubsuperscriptBox["\[Epsilon]", "\"\<i+1/2\>\"", "zz"], 
         SubscriptBox["Ez", "\"\<i+1/2\>\""]}]}], "\[IndentingNewLine]", 
       ")"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["Er", "\"\<i-1\>\""], ",", 
      SubscriptBox["Er", "i"], ",", 
      SubscriptBox["Er", "\"\<i+1\>\""], ",", 
      SubscriptBox["Eth", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+3/2\>\""]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.4671198836143427`*^9, 3.467119912702475*^9}, {
  3.4677219681256657`*^9, 3.467721978052608*^9}, {3.467732740447309*^9, 
  3.46773275797504*^9}, {3.468081392864485*^9, 3.468081409175824*^9}, {
  3.468081484986311*^9, 3.468081489636245*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      SubscriptBox["Ez", "\<\"i+3/2\"\>"], " ", 
      SubscriptBox["r", "\<\"i+1\"\>"]}], 
     RowBox[{
      SubscriptBox["r", "\<\"i+1/2\"\>"], " ", 
      SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]]}], "-", 
   FractionBox[
    RowBox[{
     SubscriptBox["Ez", "\<\"i-1/2\"\>"], " ", 
     SubscriptBox["r", "i"]}], 
    RowBox[{
     SubscriptBox["r", "\<\"i+1/2\"\>"], " ", 
     SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]], "+", 
   RowBox[{
    SubscriptBox["Er", "\<\"i+1\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", "kz", " ", 
        SubscriptBox["r", "\<\"i+1\"\>"]}], 
       SubscriptBox["r", "\<\"i+1/2\"\>"]], "-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["\[Omega]", "2"], " ", 
        SubscriptBox["r", "\<\"i+1\"\>"], " ", 
        SubsuperscriptBox["\[Epsilon]", "\<\"i+1\"\>", "zr"]}], 
       RowBox[{"2", " ", 
        SuperscriptBox["c", "2"], " ", 
        SubscriptBox["r", "\<\"i+1/2\"\>"]}]]}], ")"}]}], "+", 
   RowBox[{
    SubscriptBox["Ez", "\<\"i+1/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       SubsuperscriptBox["n", "\[Phi]", "2"], 
       SubscriptBox["r", "\<\"i+1/2\"\>"]], "+", 
      FractionBox[
       RowBox[{
        SubscriptBox["r", "\<\"i+1\"\>"], "+", 
        SubscriptBox["r", "i"]}], 
       RowBox[{
        SubscriptBox["r", "\<\"i+1/2\"\>"], " ", 
        SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]], "-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["\[Omega]", "2"], " ", 
        SubsuperscriptBox["\[Epsilon]", "\<\"i+1/2\"\>", "zz"]}], 
       SuperscriptBox["c", "2"]]}], ")"}]}], "+", 
   RowBox[{
    SubscriptBox["Eth", "\<\"i+1/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "kz"}], " ", 
       SubscriptBox["n", "\[Phi]"]}], "-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["\[Omega]", "2"], " ", 
        SubsuperscriptBox["\[Epsilon]", "\<\"i+1/2\"\>", "z\[Theta]"]}], 
       SuperscriptBox["c", "2"]]}], ")"}]}], "+", 
   RowBox[{
    SubscriptBox["Er", "i"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "kz", " ", 
         SubscriptBox["r", "i"]}], 
        SubscriptBox["r", "\<\"i+1/2\"\>"]]}], "-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["\[Omega]", "2"], " ", 
        SubscriptBox["r", "i"], " ", 
        SubsuperscriptBox["\[Epsilon]", "i", "zr"]}], 
       RowBox[{"2", " ", 
        SuperscriptBox["c", "2"], " ", 
        SubscriptBox["r", "\<\"i+1/2\"\>"]}]]}], ")"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.4671198916896963`*^9, 3.4671199134456387`*^9}, 
   3.4677219817386017`*^9, {3.4677327415225677`*^9, 3.467732758461028*^9}, {
   3.468081385945571*^9, 3.4680814100897417`*^9}, 3.4680814911109877`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["other ideas ...", "Section",
 CellChangeTimes->{{3.468082096392971*^9, 3.468082099456366*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"forwardDiffCCER", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"CCE", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "/.", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Er", "[", "Rr", "]"}], "\[Rule]", 
        SubscriptBox["Er", "i"]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Eth", "[", "Rr", "]"}], "\[Rule]", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Ez", "[", "Rr", "]"}], "\[Rule]", "0"}], ",", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", "Rr"], 
         RowBox[{"Eth", "[", "Rr", "]"}]}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "3"}], 
            SubscriptBox["Eth", "i"], "*", "0"}], "+", 
           RowBox[{"4", 
            SubscriptBox["Eth", "\"\<i+1/2\>\""]}], "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["Eth", "\"\<i+1/2\>\""], "+", 
              SubscriptBox["Eth", "\"\<i+3/2\>\""]}], ")"}], "/", "2"}]}], 
          ")"}], "/", 
         SubscriptBox["\[CapitalDelta]", "r"]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", "Rr"], 
         RowBox[{"Ez", "[", "Rr", "]"}]}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "3"}], 
            SubscriptBox["Ez", "i"], "*", "0"}], "+", 
           RowBox[{"4", 
            SubscriptBox["Ez", "\"\<i+1/2\>\""]}], "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["Ez", "\"\<i+1/2\>\""], "+", 
              SubscriptBox["Ez", "\"\<i+3/2\>\""]}], ")"}], "/", "2"}]}], 
          ")"}], "/", 
         SubscriptBox["\[CapitalDelta]", "r"]}]}]}], "}"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["Er", "\"\<i-1\>\""], ",", 
      SubscriptBox["Er", "i"], ",", 
      SubscriptBox["Er", "\"\<i+1\>\""], ",", 
      SubscriptBox["Eth", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+3/2\>\""]}], "}"}], ",", "Simplify"}], 
   "]"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.46712092554318*^9, 3.467120959806765*^9}, 
   3.467120989942895*^9, {3.467121026828197*^9, 3.467121123490306*^9}, {
   3.4671212334888144`*^9, 3.4671212681753483`*^9}, {3.467130395092301*^9, 
   3.4671304062851*^9}, {3.4671305322267857`*^9, 3.4671305325197563`*^9}, 
   3.4680819593550587`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["kz", "2"], "+", 
     FractionBox[
      SuperscriptBox["nPhi", "2"], 
      SuperscriptBox["Rr", "2"]]}], ")"}], " ", 
   SubscriptBox["Er", "i"]}], "+", 
  FractionBox[
   RowBox[{"7", " ", "\[ImaginaryI]", " ", "nPhi", " ", 
    SubscriptBox["Eth", "\<\"i+1/2\"\>"]}], 
   RowBox[{"2", " ", "Rr", " ", 
    SubscriptBox["\[CapitalDelta]", "r"]}]], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", "nPhi", " ", 
    SubscriptBox["Eth", "\<\"i+3/2\"\>"]}], 
   RowBox[{"2", " ", "Rr", " ", 
    SubscriptBox["\[CapitalDelta]", "r"]}]], "+", 
  FractionBox[
   RowBox[{"7", " ", "\[ImaginaryI]", " ", "kz", " ", 
    SubscriptBox["Ez", "\<\"i+1/2\"\>"]}], 
   RowBox[{"2", " ", 
    SubscriptBox["\[CapitalDelta]", "r"]}]], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", "kz", " ", 
    SubscriptBox["Ez", "\<\"i+3/2\"\>"]}], 
   RowBox[{"2", " ", 
    SubscriptBox["\[CapitalDelta]", "r"]}]]}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.4671209321828213`*^9, 3.467120960598419*^9}, 
   3.467120991253046*^9, 3.467121125283483*^9, 3.467121268781879*^9, 
   3.467130533299623*^9, 3.468081959355192*^9}],

Cell[BoxData[
 RowBox[{"forwardDiffCCEThB", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"CCE", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "/.", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Er", "[", "Rr", "]"}], "\[Rule]", 
        SubscriptBox["Er", "i"]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Eth", "[", "Rr", "]"}], "\[Rule]", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Ez", "[", "Rr", "]"}], "\[Rule]", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", "Rr"], 
         RowBox[{"Er", "[", "Rr", "]"}]}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "3"}], 
            SubscriptBox["Er", "i"]}], "+", 
           RowBox[{"4", 
            SubscriptBox["Er", "\"\<i+1\>\""]}], "-", 
           SubscriptBox["Er", "\"\<i+2\>\""]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"2", 
           SubscriptBox["\[CapitalDelta]", "r"]}], ")"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", "Rr"], 
         RowBox[{"Eth", "[", "Rr", "]"}]}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "3"}], 
            SubscriptBox["Eth", "i"], "*", "0"}], "+", 
           RowBox[{"4", 
            SubscriptBox["Eth", "\"\<i+1/2\>\""]}], "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["Eth", "\"\<i+1/2\>\""], "+", 
              SubscriptBox["Eth", "\"\<i+3/2\>\""]}], ")"}], "/", "2"}]}], 
          ")"}], "/", " ", 
         SubscriptBox["\[CapitalDelta]", "r"]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", 
          RowBox[{"Rr", ",", "Rr"}]], 
         RowBox[{"Eth", "[", "Rr", "]"}]}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", 
            SubscriptBox["Eth", "i"], "*", "0"}], "-", 
           RowBox[{"5", " ", 
            SubscriptBox["Eth", "\"\<i+1/2\>\""]}], "+", 
           RowBox[{"4", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SubscriptBox["Eth", "\"\<i+1/2\>\""], "+", 
               SubscriptBox["Eth", "\"\<i+3/2\>\""]}], ")"}], "/", "2"}]}], 
           "-", 
           SubscriptBox["Eth", "\"\<i+3/2\>\""]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["\[CapitalDelta]", "r"], "/", "2"}], ")"}], "^", 
           "2"}], ")"}]}]}]}], "}"}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["Er", "\"\<i-1\>\""], ",", 
      SubscriptBox["Er", "i"], ",", 
      SubscriptBox["Er", "\"\<i+1\>\""], ",", 
      SubscriptBox["Eth", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+3/2\>\""]}], "}"}], ",", "Simplify"}], 
   "]"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.467121626923188*^9, 3.4671216712588797`*^9}, {
   3.467121722606091*^9, 3.467121790220256*^9}, {3.4671218400057917`*^9, 
   3.467121937909718*^9}, {3.4671219946811047`*^9, 3.467122013863697*^9}, {
   3.467122046069212*^9, 3.46712211661957*^9}, {3.4671231110363607`*^9, 
   3.4671231112164497`*^9}, 3.467127992482522*^9, {3.467130572966669*^9, 
   3.467130590187583*^9}, 3.4680819593553047`*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"2", " ", "\[ImaginaryI]", " ", "nPhi", " ", 
    SubscriptBox["Er", "\<\"i+1\"\>"]}], 
   RowBox[{"Rr", " ", 
    SubscriptBox["\[CapitalDelta]", "r"]}]], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", "nPhi", " ", 
    SubscriptBox["Er", "\<\"i+2\"\>"]}], 
   RowBox[{"2", " ", "Rr", " ", 
    SubscriptBox["\[CapitalDelta]", "r"]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["Eth", "\<\"i+3/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "8"}], " ", "Rr"}], "+", 
      SubscriptBox["\[CapitalDelta]", "r"]}], ")"}]}], 
   RowBox[{"2", " ", "Rr", " ", 
    SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", "nPhi", " ", 
    SubscriptBox["Er", "i"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"3", " ", "Rr"}], "+", 
      RowBox[{"2", " ", 
       SubscriptBox["\[CapitalDelta]", "r"]}]}], ")"}]}], 
   RowBox[{"2", " ", 
    SuperscriptBox["Rr", "2"], " ", 
    SubscriptBox["\[CapitalDelta]", "r"]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["Eth", "\<\"i+1/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{"24", "-", 
      FractionBox[
       RowBox[{"7", " ", 
        SubscriptBox["\[CapitalDelta]", "r"]}], "Rr"]}], ")"}]}], 
   RowBox[{"2", " ", 
    SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]]}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.467121631274913*^9, 3.467121671801921*^9}, 
   3.467121723787715*^9, {3.4671218723848467`*^9, 3.4671219075323133`*^9}, 
   3.467121941461226*^9, 3.467122015650145*^9, 3.467122049512948*^9, {
   3.46712211205774*^9, 3.467122117554337*^9}, 3.467123111899165*^9, 
   3.467127995842539*^9, 3.4671305930902863`*^9, 3.467138694817461*^9, 
   3.467140116405477*^9, 3.468081959355421*^9}],

Cell[BoxData[
 RowBox[{"forwardDiffCCEZB", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"CCE", "[", 
      RowBox[{"[", "3", "]"}], "]"}], "/.", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Er", "[", "Rr", "]"}], "\[Rule]", 
        SubscriptBox["Er", "i"]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Eth", "[", "Rr", "]"}], "\[Rule]", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Ez", "[", "Rr", "]"}], "\[Rule]", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", "Rr"], 
         RowBox[{"Er", "[", "Rr", "]"}]}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "3"}], 
            SubscriptBox["Er", "i"]}], "+", 
           RowBox[{"4", 
            SubscriptBox["Er", "\"\<i+1\>\""]}], "-", 
           SubscriptBox["Er", "\"\<i+2\>\""]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"2", 
           SubscriptBox["\[CapitalDelta]", "r"]}], ")"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", "Rr"], 
         RowBox[{"Ez", "[", "Rr", "]"}]}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "3"}], 
            SubscriptBox["Ez", "i"], "*", "0"}], "+", 
           RowBox[{"4", 
            SubscriptBox["Ez", "\"\<i+1/2\>\""]}], "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["Ez", "\"\<i+1/2\>\""], "+", 
              SubscriptBox["Ez", "\"\<i+3/2\>\""]}], ")"}], "/", "2"}]}], 
          ")"}], "/", 
         SubscriptBox["\[CapitalDelta]", "r"]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", 
          RowBox[{"Rr", ",", "Rr"}]], 
         RowBox[{"Ez", "[", "Rr", "]"}]}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", 
            SubscriptBox["Ez", "i"], "*", "0"}], "-", 
           RowBox[{"5", 
            SubscriptBox["Ez", "\"\<i+1/2\>\""]}], "+", 
           RowBox[{"4", 
            RowBox[{
             RowBox[{"(", " ", 
              RowBox[{
               SubscriptBox["Ez", "\"\<i+1/2\>\""], "+", 
               SubscriptBox["Ez", "\"\<i+3/2\>\""]}], ")"}], "/", "2"}]}], 
           "-", 
           SubscriptBox["Ez", "\"\<i+3/2\>\""]}], ")"}], "/", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["\[CapitalDelta]", "r"], "/", "2"}], ")"}], "^", 
          "2"}]}]}]}], "}"}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["Er", "\"\<i-1\>\""], ",", 
      SubscriptBox["Er", "i"], ",", 
      SubscriptBox["Er", "\"\<i+1\>\""], ",", 
      SubscriptBox["Er", "\"\<i+2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+3/2\>\""]}], "}"}], ",", "Simplify"}], 
   "]"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.4671222507006073`*^9, 3.467122283248406*^9}, {
   3.46712235078962*^9, 3.467122374201294*^9}, {3.467122410970413*^9, 
   3.467122609735561*^9}, {3.467122701230378*^9, 3.467122708497486*^9}, 
   3.4671285596532183`*^9, {3.467130596718939*^9, 3.467130607869158*^9}, {
   3.467130822108036*^9, 3.467130822520479*^9}, 3.468081959355536*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", "kz", " ", 
   SubscriptBox["Er", "i"], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox["2", "Rr"], "-", 
     FractionBox["3", 
      SubscriptBox["\[CapitalDelta]", "r"]]}], ")"}]}], "+", 
  FractionBox[
   RowBox[{"2", " ", "\[ImaginaryI]", " ", "kz", " ", 
    SubscriptBox["Er", "\<\"i+1\"\>"]}], 
   SubscriptBox["\[CapitalDelta]", "r"]], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", "kz", " ", 
    SubscriptBox["Er", "\<\"i+2\"\>"]}], 
   RowBox[{"2", " ", 
    SubscriptBox["\[CapitalDelta]", "r"]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["Ez", "\<\"i+3/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "8"}], " ", "Rr"}], "+", 
      SubscriptBox["\[CapitalDelta]", "r"]}], ")"}]}], 
   RowBox[{"2", " ", "Rr", " ", 
    SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["Ez", "\<\"i+1/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{"24", "-", 
      FractionBox[
       RowBox[{"7", " ", 
        SubscriptBox["\[CapitalDelta]", "r"]}], "Rr"]}], ")"}]}], 
   RowBox[{"2", " ", 
    SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]]}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.467122256395174*^9, 3.467122283857655*^9}, 
   3.467122405456542*^9, 3.4671224559407673`*^9, 3.467122527423361*^9, 
   3.467122611920767*^9, 3.4671227093631573`*^9, 3.467128562234849*^9, 
   3.467130611767555*^9, 3.467130830173387*^9, 3.467138983055255*^9, 
   3.46714012211762*^9, 3.468081959355652*^9}],

Cell[BoxData[
 RowBox[{"lhsForwardDiffR", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"forwardDiffCCER", "-", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Omega]", "^", "2"}], "/", 
       RowBox[{"c", "^", "2"}]}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubsuperscriptBox["\[Epsilon]", "i", "rr"], 
         SubscriptBox["Er", "i"]}], "+", 
        RowBox[{
         SubscriptBox["Eth", "i"], "*", "0"}], "+", 
        RowBox[{
         SubscriptBox["Ez", "i"], "*", "0"}]}], ")"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["Er", "\"\<i-1\>\""], ",", 
      SubscriptBox["Er", "i"], ",", 
      SubscriptBox["Er", "\"\<i+1\>\""], ",", 
      SubscriptBox["Eth", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+3/2\>\""]}], "}"}], ",", "Simplify"}], 
   "]"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.467122823498157*^9, 3.467122826920107*^9}, {
   3.4671228834295673`*^9, 3.4671229094072437`*^9}, {3.467122955079473*^9, 
   3.46712295795221*^9}, 3.468081959355768*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"7", " ", "\[ImaginaryI]", " ", "nPhi", " ", 
    SubscriptBox["Eth", "\<\"i+1/2\"\>"]}], 
   RowBox[{"2", " ", "Rr", " ", 
    SubscriptBox["\[CapitalDelta]", "r"]}]], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", "nPhi", " ", 
    SubscriptBox["Eth", "\<\"i+3/2\"\>"]}], 
   RowBox[{"2", " ", "Rr", " ", 
    SubscriptBox["\[CapitalDelta]", "r"]}]], "+", 
  FractionBox[
   RowBox[{"7", " ", "\[ImaginaryI]", " ", "kz", " ", 
    SubscriptBox["Ez", "\<\"i+1/2\"\>"]}], 
   RowBox[{"2", " ", 
    SubscriptBox["\[CapitalDelta]", "r"]}]], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", "kz", " ", 
    SubscriptBox["Ez", "\<\"i+3/2\"\>"]}], 
   RowBox[{"2", " ", 
    SubscriptBox["\[CapitalDelta]", "r"]}]], "+", 
  RowBox[{
   SubscriptBox["Er", "i"], " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["kz", "2"], "+", 
     FractionBox[
      SuperscriptBox["nPhi", "2"], 
      SuperscriptBox["Rr", "2"]], "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["\[Omega]", "2"], " ", 
       SubsuperscriptBox["\[Epsilon]", "i", "rr"]}], 
      SuperscriptBox["c", "2"]]}], ")"}]}]}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{3.467122829376876*^9, 3.467122910246443*^9, 
  3.4671229593186417`*^9, 3.46713042690282*^9, 3.46713053994899*^9, 
  3.468081959355887*^9}],

Cell[BoxData[
 RowBox[{"lhsForwardDiffThB", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"forwardDiffCCEThB", "-", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Omega]", "^", "2"}], "/", 
       RowBox[{"c", "^", "2"}]}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubsuperscriptBox["\[Epsilon]", "i", "\[Theta]r"], 
         SubscriptBox["Er", "i"]}], "+", 
        RowBox[{
         SubscriptBox["Eth", "i"], "*", "0"}], "+", 
        RowBox[{
         SubscriptBox["Ez", "i"], "*", "0"}]}], ")"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["Er", "\"\<i-1\>\""], ",", 
      SubscriptBox["Er", "i"], ",", 
      SubscriptBox["Er", "\"\<i+1\>\""], ",", 
      SubscriptBox["Eth", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+3/2\>\""]}], "}"}], ",", "Simplify"}], 
   "]"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.467123047334916*^9, 3.467123057494323*^9}, {
   3.467123201102316*^9, 3.467123243558998*^9}, {3.4671280020608883`*^9, 
   3.467128003418392*^9}, 3.468081959356007*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"2", " ", "\[ImaginaryI]", " ", "nPhi", " ", 
    SubscriptBox["Er", "\<\"i+1\"\>"]}], 
   RowBox[{"Rr", " ", 
    SubscriptBox["\[CapitalDelta]", "r"]}]], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", "nPhi", " ", 
    SubscriptBox["Er", "\<\"i+2\"\>"]}], 
   RowBox[{"2", " ", "Rr", " ", 
    SubscriptBox["\[CapitalDelta]", "r"]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["Eth", "\<\"i+3/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "8"}], " ", "Rr"}], "+", 
      SubscriptBox["\[CapitalDelta]", "r"]}], ")"}]}], 
   RowBox[{"2", " ", "Rr", " ", 
    SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["Eth", "\<\"i+1/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{"24", "-", 
      FractionBox[
       RowBox[{"7", " ", 
        SubscriptBox["\[CapitalDelta]", "r"]}], "Rr"]}], ")"}]}], 
   RowBox[{"2", " ", 
    SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]], "+", 
  RowBox[{
   SubscriptBox["Er", "i"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", "nPhi", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"3", " ", "Rr"}], "+", 
          RowBox[{"2", " ", 
           SubscriptBox["\[CapitalDelta]", "r"]}]}], ")"}]}], 
       RowBox[{"2", " ", 
        SuperscriptBox["Rr", "2"], " ", 
        SubscriptBox["\[CapitalDelta]", "r"]}]]}], "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["\[Omega]", "2"], " ", 
       SubsuperscriptBox["\[Epsilon]", "i", "\[Theta]r"]}], 
      SuperscriptBox["c", "2"]]}], ")"}]}]}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{3.467123059254613*^9, 3.46712311575961*^9, 
  3.467123244691629*^9, 3.467128004322277*^9, 3.467130615557563*^9, 
  3.467138708851452*^9, 3.467140129453472*^9, 3.468081959356124*^9}],

Cell[BoxData[
 RowBox[{"lhsForwardDiffZB", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"forwardDiffCCEZB", "-", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Omega]", "^", "2"}], "/", 
       RowBox[{"c", "^", "2"}]}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubsuperscriptBox["\[Epsilon]", "i", "zr"], 
         SubscriptBox["Er", "i"]}], "+", 
        RowBox[{
         SubsuperscriptBox["\[Epsilon]", "\"\<i+1/2\>\"", "z\[Theta]"], 
         SubscriptBox["Eth", "\"\<i+1/2\>\""], "*", "0"}], "+", 
        RowBox[{
         SubsuperscriptBox["\[Epsilon]", "\"\<i+1/2\>\"", "zz"], 
         SubscriptBox["Ez", "\"\<i+1/2\>\""], "*", "0"}]}], ")"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["Er", "\"\<i-1\>\""], ",", 
      SubscriptBox["Er", "i"], ",", 
      SubscriptBox["Er", "\"\<i+1\>\""], ",", 
      SubscriptBox["Eth", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Er", "\"\<i+2\>\""]}], "}"}], ",", "Simplify"}], 
   "]"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.467123357654759*^9, 3.467123379724112*^9}, {
   3.467128566444023*^9, 3.467128567583799*^9}, {3.467130760085243*^9, 
   3.467130764898137*^9}, {3.4671390101012573`*^9, 3.467139014760504*^9}, 
   3.468081959356243*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"2", " ", "\[ImaginaryI]", " ", "kz", " ", 
    SubscriptBox["Er", "\<\"i+1\"\>"]}], 
   SubscriptBox["\[CapitalDelta]", "r"]], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", "kz", " ", 
    SubscriptBox["Er", "\<\"i+2\"\>"]}], 
   RowBox[{"2", " ", 
    SubscriptBox["\[CapitalDelta]", "r"]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["Ez", "\<\"i+3/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "8"}], " ", "Rr"}], "+", 
      SubscriptBox["\[CapitalDelta]", "r"]}], ")"}]}], 
   RowBox[{"2", " ", "Rr", " ", 
    SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["Ez", "\<\"i+1/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{"24", "-", 
      FractionBox[
       RowBox[{"7", " ", 
        SubscriptBox["\[CapitalDelta]", "r"]}], "Rr"]}], ")"}]}], 
   RowBox[{"2", " ", 
    SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]], "+", 
  RowBox[{
   SubscriptBox["Er", "i"], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", "kz"}], "Rr"], "-", 
     FractionBox[
      RowBox[{"3", " ", "\[ImaginaryI]", " ", "kz"}], 
      RowBox[{"2", " ", 
       SubscriptBox["\[CapitalDelta]", "r"]}]], "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["\[Omega]", "2"], " ", 
       SubsuperscriptBox["\[Epsilon]", "i", "zr"]}], 
      SuperscriptBox["c", "2"]]}], ")"}]}]}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.4671233680454617`*^9, 3.467123380441832*^9}, 
   3.467128568482047*^9, 3.467130618096303*^9, 3.4671307655407553`*^9, 
   3.467130834401061*^9, {3.467138989204126*^9, 3.467139016483869*^9}, 
   3.4671401350323973`*^9, 3.468081959356359*^9}],

Cell[BoxData[
 RowBox[{"forwardDiffCCETh", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"CCE", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "/.", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Er", "[", "Rr", "]"}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["Er", "i"], "+", 
           SubscriptBox["Er", "\"\<i+1\>\""]}], ")"}], "/", "2"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Eth", "[", "Rr", "]"}], "\[Rule]", 
        SubscriptBox["Eth", "\"\<i+1/2\>\""]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Ez", "[", "Rr", "]"}], "\[Rule]", 
        SubscriptBox["Ez", "\"\<i+1/2\>\""]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", "Rr"], 
         RowBox[{"Er", "[", "Rr", "]"}]}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            SubscriptBox["Er", "i"]}], "+", 
           SubscriptBox["Er", "\"\<i+1\>\""]}], ")"}], "/", 
         SubscriptBox["\[CapitalDelta]", "r"]}]}], ",", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", "Rr"], 
         RowBox[{"Eth", "[", "Rr", "]"}]}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "3"}], 
            SubscriptBox["Eth", "\"\<i+1/2\>\""]}], "+", 
           RowBox[{"4", 
            SubscriptBox["Eth", "\"\<i+3/2\>\""]}], "-", 
           SubscriptBox["Eth", "\"\<i+5/2\>\""]}], ")"}], "/", " ", 
         RowBox[{"(", 
          RowBox[{"2", 
           SubscriptBox["\[CapitalDelta]", "r"]}], ")"}]}]}], ",", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", 
          RowBox[{"Rr", ",", "Rr"}]], 
         RowBox[{"Eth", "[", "Rr", "]"}]}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", 
            SubscriptBox["Eth", "\"\<i+1/2\>\""]}], "-", 
           RowBox[{"5", " ", 
            SubscriptBox["Eth", "\"\<i+3/2\>\""]}], "+", 
           RowBox[{"4", 
            SubscriptBox["Eth", "\"\<i+5/2\>\""]}], "-", 
           SubscriptBox["Eth", "\"\<i+7/2\>\""]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["\[CapitalDelta]", "r"], "^", "2"}], ")"}]}]}]}], 
      "}"}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["Er", "\"\<i-1\>\""], ",", 
      SubscriptBox["Er", "i"], ",", 
      SubscriptBox["Er", "\"\<i+1\>\""], ",", 
      SubscriptBox["Eth", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+5/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+7/2\>\""]}], "}"}], ",", "Simplify"}], 
   "]"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.467128072362768*^9, 3.467128110954628*^9}, {
   3.467128166374642*^9, 3.467128178694627*^9}, {3.467128308851215*^9, 
   3.467128385937302*^9}, {3.4671284369824*^9, 3.467128484388092*^9}, {
   3.467128704768985*^9, 3.467128718552446*^9}, {3.4671288516165447`*^9, 
   3.467128880844287*^9}, {3.467130097738212*^9, 3.4671300986646338`*^9}, {
   3.467130129945713*^9, 3.467130130296011*^9}, 3.468081959356472*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{"kz", " ", "nPhi", " ", 
     SubscriptBox["Ez", "\<\"i+1/2\"\>"]}], "Rr"]}], "+", 
  RowBox[{
   SubscriptBox["Eth", "\<\"i+1/2\"\>"], " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["kz", "2"], "+", 
     FractionBox["1", 
      SuperscriptBox["Rr", "2"]], "-", 
     FractionBox["2", 
      SubsuperscriptBox["\[CapitalDelta]", "r", "2"]], "+", 
     FractionBox["3", 
      RowBox[{"2", " ", "Rr", " ", 
       SubscriptBox["\[CapitalDelta]", "r"]}]]}], ")"}]}], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["Eth", "\<\"i+3/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"5", " ", "Rr"}], "-", 
      RowBox[{"2", " ", 
       SubscriptBox["\[CapitalDelta]", "r"]}]}], ")"}]}], 
   RowBox[{"Rr", " ", 
    SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", "nPhi", " ", 
    SubscriptBox["Er", "\<\"i+1\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "Rr"}], "-", 
      SubscriptBox["\[CapitalDelta]", "r"]}], ")"}]}], 
   RowBox[{"2", " ", 
    SuperscriptBox["Rr", "2"], " ", 
    SubscriptBox["\[CapitalDelta]", "r"]}]], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", "nPhi", " ", 
    SubscriptBox["Er", "i"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "Rr"}], "+", 
      SubscriptBox["\[CapitalDelta]", "r"]}], ")"}]}], 
   RowBox[{"2", " ", 
    SuperscriptBox["Rr", "2"], " ", 
    SubscriptBox["\[CapitalDelta]", "r"]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"2", " ", "Rr", " ", 
     SubscriptBox["Eth", "\<\"i+7/2\"\>"]}], "+", 
    RowBox[{
     SubscriptBox["Eth", "\<\"i+5/2\"\>"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "8"}], " ", "Rr"}], "+", 
       SubscriptBox["\[CapitalDelta]", "r"]}], ")"}]}]}], 
   RowBox[{"2", " ", "Rr", " ", 
    SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]]}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.46712800789612*^9, {3.467128089736055*^9, 3.4671281123007727`*^9}, {
   3.4671281677670927`*^9, 3.467128184089032*^9}, 3.46712832242666*^9, 
   3.4671283866265163`*^9, 3.467128485505718*^9, {3.467128705452487*^9, 
   3.467128719200521*^9}, {3.467128856936949*^9, 3.467128881747652*^9}, 
   3.467129806595656*^9, 3.467130099358769*^9, 3.46713013083107*^9, 
   3.468081959356592*^9}],

Cell[BoxData[
 RowBox[{"forwardDiffCCEZ", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"CCE", "[", 
      RowBox[{"[", "3", "]"}], "]"}], "/.", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Er", "[", "Rr", "]"}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["Er", "i"], "+", 
           SubscriptBox["Er", "\"\<i+1\>\""]}], ")"}], "/", "2"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Eth", "[", "Rr", "]"}], "\[Rule]", 
        SubscriptBox["Eth", "\"\<i+1/2\>\""]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Ez", "[", "Rr", "]"}], "\[Rule]", 
        SubscriptBox["Ez", "\"\<i+1/2\>\""]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", "Rr"], 
         RowBox[{"Er", "[", "Rr", "]"}]}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            SubscriptBox["Er", "i"]}], "+", 
           SubscriptBox["Er", "\"\<i+1\>\""]}], ")"}], "/", 
         SubscriptBox["\[CapitalDelta]", "r"]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", "Rr"], 
         RowBox[{"Ez", "[", "Rr", "]"}]}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "3"}], 
            SubscriptBox["Ez", "\"\<i+1/2\>\""]}], "+", 
           RowBox[{"4", 
            SubscriptBox["Ez", "\"\<i+3/2\>\""]}], "-", 
           SubscriptBox["Ez", "\"\<i+5/2\>\""]}], ")"}], "/", " ", 
         RowBox[{"(", 
          RowBox[{"2", 
           SubscriptBox["\[CapitalDelta]", "r"]}], ")"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", 
          RowBox[{"Rr", ",", "Rr"}]], 
         RowBox[{"Ez", "[", "Rr", "]"}]}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", 
            SubscriptBox["Ez", "\"\<i+1/2\>\""]}], "-", 
           RowBox[{"5", " ", 
            SubscriptBox["Ez", "\"\<i+3/2\>\""]}], "+", 
           RowBox[{"4", 
            SubscriptBox["Ez", "\"\<i+5/2\>\""]}], "-", 
           SubscriptBox["Ez", "\"\<i+7/2\>\""]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["\[CapitalDelta]", "r"], "^", "2"}], ")"}]}]}]}], 
      "}"}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["Er", "\"\<i-1\>\""], ",", 
      SubscriptBox["Er", "i"], ",", 
      SubscriptBox["Er", "\"\<i+1\>\""], ",", 
      SubscriptBox["Er", "\"\<i+2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Ez", 
       RowBox[{"\"\<i+5/2\>\"", ",", 
        SubscriptBox["Ez", "\"\<i+7/2\>\""]}]]}], "}"}], ",", "Simplify"}], 
   "]"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.4671285789755583`*^9, 3.467128726122414*^9}, {
   3.467129753730772*^9, 3.4671297655013533`*^9}, {3.467130092621418*^9, 
   3.467130092928871*^9}, {3.467130123856051*^9, 3.4671301242354393`*^9}, 
   3.4680819593567038`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{"kz", " ", "nPhi", " ", 
     SubscriptBox["Eth", "\<\"i+1/2\"\>"]}], "Rr"]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", "kz", " ", 
   SubscriptBox["Er", "i"], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox["1", "Rr"], "-", 
     FractionBox["2", 
      SubscriptBox["\[CapitalDelta]", "r"]]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", "kz", " ", 
   SubscriptBox["Er", "\<\"i+1\"\>"], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox["1", "Rr"], "+", 
     FractionBox["2", 
      SubscriptBox["\[CapitalDelta]", "r"]]}], ")"}]}], "+", 
  RowBox[{
   SubscriptBox["Ez", "\<\"i+1/2\"\>"], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      SuperscriptBox["nPhi", "2"], 
      SuperscriptBox["Rr", "2"]], "-", 
     FractionBox["2", 
      SubsuperscriptBox["\[CapitalDelta]", "r", "2"]], "+", 
     FractionBox["3", 
      RowBox[{"2", " ", "Rr", " ", 
       SubscriptBox["\[CapitalDelta]", "r"]}]]}], ")"}]}], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["Ez", "\<\"i+3/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"5", " ", "Rr"}], "-", 
      RowBox[{"2", " ", 
       SubscriptBox["\[CapitalDelta]", "r"]}]}], ")"}]}], 
   RowBox[{"Rr", " ", 
    SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"2", " ", "Rr", " ", 
     SubscriptBox["Ez", "\<\"i+7/2\"\>"]}], "+", 
    RowBox[{
     SubscriptBox["Ez", "\<\"i+5/2\"\>"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "8"}], " ", "Rr"}], "+", 
       SubscriptBox["\[CapitalDelta]", "r"]}], ")"}]}]}], 
   RowBox[{"2", " ", "Rr", " ", 
    SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]]}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.467128579508546*^9, {3.467128659441821*^9, 3.4671287267341146`*^9}, {
   3.467129758648752*^9, 3.467129766683848*^9}, {3.467130093878833*^9, 
   3.467130126820765*^9}, 3.468081959356835*^9}],

Cell[BoxData[
 RowBox[{"lhsForwardDiffTh", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"forwardDiffCCETh", "-", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Omega]", "^", "2"}], "/", 
       RowBox[{"c", "^", "2"}]}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubsuperscriptBox["\[Epsilon]", "i", "\[Theta]r"], 
            SubscriptBox["Er", "i"]}], "+", 
           RowBox[{
            SubsuperscriptBox["\[Epsilon]", "\"\<i+1\>\"", "\[Theta]r"], 
            SubscriptBox["Er", "\"\<i+1\>\""]}]}], ")"}], "/", "2"}], "+", 
        RowBox[{
         SubsuperscriptBox["\[Epsilon]", "\"\<i+1/2\>\"", "\[Theta]\[Theta]"], 
         SubscriptBox["Eth", "\"\<i+1/2\>\""]}], "+", 
        RowBox[{
         SubsuperscriptBox["\[Epsilon]", "\"\<i+1/2\>\"", "\[Theta]z"], 
         SubscriptBox["Ez", "\"\<i+1/2\>\""]}]}], ")"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["Er", "\"\<i-1\>\""], ",", 
      SubscriptBox["Er", "i"], ",", 
      SubscriptBox["Er", "\"\<i+1\>\""], ",", 
      SubscriptBox["Eth", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+5/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+7/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+5/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+7/2\>\""]}], "}"}], ",", "Simplify"}], 
   "]"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.4671298673533163`*^9, 3.467129894335156*^9}, {
   3.467129952530354*^9, 3.467129973497611*^9}, {3.467130279977552*^9, 
   3.467130314094928*^9}, 3.468081959356979*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   SubscriptBox["Eth", "\<\"i+7/2\"\>"], 
   SubsuperscriptBox["\[CapitalDelta]", "r", "2"]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["Eth", "\<\"i+3/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"5", " ", "Rr"}], "-", 
      RowBox[{"2", " ", 
       SubscriptBox["\[CapitalDelta]", "r"]}]}], ")"}]}], 
   RowBox[{"Rr", " ", 
    SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["Eth", "\<\"i+5/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "8"}], " ", "Rr"}], "+", 
      SubscriptBox["\[CapitalDelta]", "r"]}], ")"}]}], 
   RowBox[{"2", " ", "Rr", " ", 
    SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]], "+", 
  RowBox[{
   SubscriptBox["Er", "\<\"i+1\"\>"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", "nPhi"}], 
       RowBox[{"2", " ", 
        SuperscriptBox["Rr", "2"]}]]}], "+", 
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", "nPhi"}], 
      RowBox[{"Rr", " ", 
       SubscriptBox["\[CapitalDelta]", "r"]}]], "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["\[Omega]", "2"], " ", 
       SubsuperscriptBox["\[Epsilon]", "\<\"i+1\"\>", "\[Theta]r"]}], 
      RowBox[{"2", " ", 
       SuperscriptBox["c", "2"]}]]}], ")"}]}], "+", 
  RowBox[{
   SubscriptBox["Ez", "\<\"i+1/2\"\>"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"kz", " ", "nPhi"}], "Rr"]}], "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["\[Omega]", "2"], " ", 
       SubsuperscriptBox["\[Epsilon]", "\<\"i+1/2\"\>", "\[Theta]z"]}], 
      SuperscriptBox["c", "2"]]}], ")"}]}], "+", 
  RowBox[{
   SubscriptBox["Eth", "\<\"i+1/2\"\>"], " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["kz", "2"], "+", 
     FractionBox["1", 
      SuperscriptBox["Rr", "2"]], "-", 
     FractionBox["2", 
      SubsuperscriptBox["\[CapitalDelta]", "r", "2"]], "+", 
     FractionBox["3", 
      RowBox[{"2", " ", "Rr", " ", 
       SubscriptBox["\[CapitalDelta]", "r"]}]], "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["\[Omega]", "2"], " ", 
       SubsuperscriptBox["\[Epsilon]", "\<\"i+1/2\"\>", "\[Theta]\[Theta]"]}], 
      SuperscriptBox["c", "2"]]}], ")"}]}], "+", 
  RowBox[{
   SubscriptBox["Er", "i"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", "nPhi", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "Rr"}], "+", 
          SubscriptBox["\[CapitalDelta]", "r"]}], ")"}]}], 
       RowBox[{"2", " ", 
        SuperscriptBox["Rr", "2"], " ", 
        SubscriptBox["\[CapitalDelta]", "r"]}]]}], "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["\[Omega]", "2"], " ", 
       SubsuperscriptBox["\[Epsilon]", "i", "\[Theta]r"]}], 
      RowBox[{"2", " ", 
       SuperscriptBox["c", "2"]}]]}], ")"}]}]}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{{3.467129877125142*^9, 3.467129895800413*^9}, 
   3.467129974235074*^9, 3.467130103468919*^9, 3.467130133544167*^9, {
   3.467130282067296*^9, 3.467130315010271*^9}, {3.4671433308588343`*^9, 
   3.467143335272706*^9}, 3.468081959357085*^9}],

Cell[BoxData[
 RowBox[{"lhsForwardDiffZ", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"forwardDiffCCEZ", "-", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Omega]", "^", "2"}], "/", 
       RowBox[{"c", "^", "2"}]}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubsuperscriptBox["\[Epsilon]", "i", "zr"], 
            SubscriptBox["Er", "i"]}], "+", 
           RowBox[{
            SubsuperscriptBox["\[Epsilon]", "\"\<i+1\>\"", "zr"], 
            SubscriptBox["Er", "\"\<i+1\>\""]}]}], ")"}], "/", "2"}], "+", 
        RowBox[{
         SubsuperscriptBox["\[Epsilon]", "\"\<i+1/2\>\"", "z\[Theta]"], 
         SubscriptBox["Eth", "\"\<i+1/2\>\""]}], "+", 
        RowBox[{
         SubsuperscriptBox["\[Epsilon]", "\"\<i+1/2\>\"", "zz"], 
         SubscriptBox["Ez", "\"\<i+1/2\>\""]}]}], ")"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["Er", "\"\<i-1\>\""], ",", 
      SubscriptBox["Er", "i"], ",", 
      SubscriptBox["Er", "\"\<i+1\>\""], ",", 
      SubscriptBox["Eth", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+5/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+7/2\>\""]}], "}"}], ",", "Simplify"}], 
   "]"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.467129931227438*^9, 3.467129940488978*^9}, 
   3.467129985539524*^9, 3.4680819593571863`*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   SubscriptBox["Ez", "\<\"i+7/2\"\>"], 
   SubsuperscriptBox["\[CapitalDelta]", "r", "2"]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["Ez", "\<\"i+3/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"5", " ", "Rr"}], "-", 
      RowBox[{"2", " ", 
       SubscriptBox["\[CapitalDelta]", "r"]}]}], ")"}]}], 
   RowBox[{"Rr", " ", 
    SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["Ez", "\<\"i+5/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "8"}], " ", "Rr"}], "+", 
      SubscriptBox["\[CapitalDelta]", "r"]}], ")"}]}], 
   RowBox[{"2", " ", "Rr", " ", 
    SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]], "+", 
  RowBox[{
   SubscriptBox["Er", "\<\"i+1\"\>"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", "kz", " ", 
      RowBox[{"(", 
       RowBox[{
        FractionBox["1", "Rr"], "+", 
        FractionBox["2", 
         SubscriptBox["\[CapitalDelta]", "r"]]}], ")"}]}], "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["\[Omega]", "2"], " ", 
       SubsuperscriptBox["\[Epsilon]", "\<\"i+1\"\>", "zr"]}], 
      RowBox[{"2", " ", 
       SuperscriptBox["c", "2"]}]]}], ")"}]}], "+", 
  RowBox[{
   SubscriptBox["Ez", "\<\"i+1/2\"\>"], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      SuperscriptBox["nPhi", "2"], 
      SuperscriptBox["Rr", "2"]], "-", 
     FractionBox["2", 
      SubsuperscriptBox["\[CapitalDelta]", "r", "2"]], "+", 
     FractionBox["3", 
      RowBox[{"2", " ", "Rr", " ", 
       SubscriptBox["\[CapitalDelta]", "r"]}]], "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["\[Omega]", "2"], " ", 
       SubsuperscriptBox["\[Epsilon]", "\<\"i+1/2\"\>", "zz"]}], 
      SuperscriptBox["c", "2"]]}], ")"}]}], "+", 
  RowBox[{
   SubscriptBox["Eth", "\<\"i+1/2\"\>"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"kz", " ", "nPhi"}], "Rr"]}], "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["\[Omega]", "2"], " ", 
       SubsuperscriptBox["\[Epsilon]", "\<\"i+1/2\"\>", "z\[Theta]"]}], 
      SuperscriptBox["c", "2"]]}], ")"}]}], "+", 
  RowBox[{
   SubscriptBox["Er", "i"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", "kz", " ", 
      RowBox[{"(", 
       RowBox[{
        FractionBox["1", "Rr"], "-", 
        FractionBox["2", 
         SubscriptBox["\[CapitalDelta]", "r"]]}], ")"}]}], "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["\[Omega]", "2"], " ", 
       SubsuperscriptBox["\[Epsilon]", "i", "zr"]}], 
      RowBox[{"2", " ", 
       SuperscriptBox["c", "2"]}]]}], ")"}]}]}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.467129944048914*^9, 3.4671299861277723`*^9, {3.467130105789238*^9, 
   3.467130135558035*^9}, 3.468081959357288*^9}],

Cell[BoxData[
 RowBox[{"backwardDiffCCER", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"CCE", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "/.", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Er", "[", "Rr", "]"}], "\[Rule]", 
        SubscriptBox["Er", "i"]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Eth", "[", "Rr", "]"}], "\[Rule]", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Ez", "[", "Rr", "]"}], "\[Rule]", "0"}], ",", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", "Rr"], 
         RowBox[{"Eth", "[", "Rr", "]"}]}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"3", 
            SubscriptBox["Eth", "i"], "*", "0"}], "-", 
           RowBox[{"4", 
            SubscriptBox["Eth", "\"\<i-1/2\>\""]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["Eth", "\"\<i-1/2\>\""], "+", 
              SubscriptBox["Eth", "\"\<i-3/2\>\""]}], ")"}], "/", "2"}]}], 
          ")"}], "/", 
         SubscriptBox["\[CapitalDelta]", "r"]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", "Rr"], 
         RowBox[{"Ez", "[", "Rr", "]"}]}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"3", 
            SubscriptBox["Ez", "i"], "*", "0"}], "-", 
           RowBox[{"4", 
            SubscriptBox["Ez", "\"\<i-1/2\>\""]}], "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["Ez", "\"\<i-1/2\>\""], "+", 
              SubscriptBox["Ez", "\"\<i-3/2\>\""]}], ")"}], "/", "2"}]}], 
          ")"}], "/", 
         SubscriptBox["\[CapitalDelta]", "r"]}]}]}], "}"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["Er", "\"\<i-1\>\""], ",", 
      SubscriptBox["Er", "i"], ",", 
      SubscriptBox["Er", "\"\<i+1\>\""], ",", 
      SubscriptBox["Eth", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+3/2\>\""]}], "}"}], ",", "Simplify"}], 
   "]"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.4671330409863997`*^9, 3.467133044233219*^9}, {
   3.467133309045768*^9, 3.467133310951014*^9}, {3.467133358656662*^9, 
   3.4671334104560328`*^9}, 3.468081959357387*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["kz", "2"], "+", 
     FractionBox[
      SuperscriptBox["nPhi", "2"], 
      SuperscriptBox["Rr", "2"]]}], ")"}], " ", 
   SubscriptBox["Er", "i"]}], "-", 
  FractionBox[
   RowBox[{"7", " ", "\[ImaginaryI]", " ", "nPhi", " ", 
    SubscriptBox["Eth", "\<\"i-1/2\"\>"]}], 
   RowBox[{"2", " ", "Rr", " ", 
    SubscriptBox["\[CapitalDelta]", "r"]}]], "-", 
  FractionBox[
   RowBox[{"9", " ", "\[ImaginaryI]", " ", "kz", " ", 
    SubscriptBox["Ez", "\<\"i-1/2\"\>"]}], 
   RowBox[{"2", " ", 
    SubscriptBox["\[CapitalDelta]", "r"]}]], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"nPhi", " ", 
       SubscriptBox["Eth", "\<\"i-3/2\"\>"]}], "-", 
      RowBox[{"kz", " ", "Rr", " ", 
       SubscriptBox["Ez", "\<\"i-3/2\"\>"]}]}], ")"}]}], 
   RowBox[{"2", " ", "Rr", " ", 
    SubscriptBox["\[CapitalDelta]", "r"]}]]}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.4671330499818993`*^9, {3.467133391542015*^9, 3.467133412439702*^9}, 
   3.4680819593574867`*^9}],

Cell[BoxData[
 RowBox[{"lhsBackwardDiffR", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"backwardDiffCCER", "-", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Omega]", "^", "2"}], "/", 
       RowBox[{"c", "^", "2"}]}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubsuperscriptBox["\[Epsilon]", "i", "rr"], 
         SubscriptBox["Er", "i"]}], "+", 
        RowBox[{
         SubscriptBox["Eth", "i"], "*", "0"}], "+", 
        RowBox[{
         SubscriptBox["Ez", "i"], "*", "0"}]}], ")"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["Er", "\"\<i-1\>\""], ",", 
      SubscriptBox["Er", "i"], ",", 
      SubscriptBox["Er", "\"\<i+1\>\""], ",", 
      SubscriptBox["Eth", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i-3/2\>\""]}], "}"}], ",", "Simplify"}], 
   "]"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.4671334528971443`*^9, 3.467133496471504*^9}, 
   3.468081959357594*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{"7", " ", "\[ImaginaryI]", " ", "nPhi", " ", 
     SubscriptBox["Eth", "\<\"i-1/2\"\>"]}], 
    RowBox[{"2", " ", "Rr", " ", 
     SubscriptBox["\[CapitalDelta]", "r"]}]]}], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", "nPhi", " ", 
    SubscriptBox["Eth", "\<\"i-3/2\"\>"]}], 
   RowBox[{"2", " ", "Rr", " ", 
    SubscriptBox["\[CapitalDelta]", "r"]}]], "-", 
  FractionBox[
   RowBox[{"9", " ", "\[ImaginaryI]", " ", "kz", " ", 
    SubscriptBox["Ez", "\<\"i-1/2\"\>"]}], 
   RowBox[{"2", " ", 
    SubscriptBox["\[CapitalDelta]", "r"]}]], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", "kz", " ", 
    SubscriptBox["Ez", "\<\"i-3/2\"\>"]}], 
   RowBox[{"2", " ", 
    SubscriptBox["\[CapitalDelta]", "r"]}]], "+", 
  RowBox[{
   SubscriptBox["Er", "i"], " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["kz", "2"], "+", 
     FractionBox[
      SuperscriptBox["nPhi", "2"], 
      SuperscriptBox["Rr", "2"]], "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["\[Omega]", "2"], " ", 
       SubsuperscriptBox["\[Epsilon]", "i", "rr"]}], 
      SuperscriptBox["c", "2"]]}], ")"}]}]}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{3.467133464845953*^9, 3.467133497772313*^9, 
  3.4680819593576937`*^9}],

Cell[BoxData[
 RowBox[{"backwardDiffCCETh", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"CCE", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "/.", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Er", "[", "Rr", "]"}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["Er", "i"], "+", 
           SubscriptBox["Er", "\"\<i+1\>\""]}], ")"}], "/", "2"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Eth", "[", "Rr", "]"}], "\[Rule]", 
        SubscriptBox["Eth", "\"\<i+1/2\>\""]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Ez", "[", "Rr", "]"}], "\[Rule]", 
        SubscriptBox["Ez", "\"\<i+1/2\>\""]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", "Rr"], 
         RowBox[{"Er", "[", "Rr", "]"}]}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            SubscriptBox["Er", "i"]}], "+", 
           SubscriptBox["Er", "\"\<i+1\>\""]}], ")"}], "/", 
         SubscriptBox["\[CapitalDelta]", "r"]}]}], ",", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", "Rr"], 
         RowBox[{"Eth", "[", "Rr", "]"}]}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"3", 
            SubscriptBox["Eth", "\"\<i+1/2\>\""]}], "-", 
           RowBox[{"4", 
            SubscriptBox["Eth", "\"\<i-1/2\>\""]}], "+", 
           SubscriptBox["Eth", "\"\<i-3/2\>\""]}], ")"}], "/", " ", 
         RowBox[{"(", 
          RowBox[{"2", 
           SubscriptBox["\[CapitalDelta]", "r"]}], ")"}]}]}], ",", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", 
          RowBox[{"Rr", ",", "Rr"}]], 
         RowBox[{"Eth", "[", "Rr", "]"}]}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", 
            SubscriptBox["Eth", "\"\<i+1/2\>\""]}], "-", 
           RowBox[{"5", " ", 
            SubscriptBox["Eth", "\"\<i-1/2\>\""]}], "+", 
           RowBox[{"4", 
            SubscriptBox["Eth", "\"\<i-3/2\>\""]}], "-", 
           SubscriptBox["Eth", "\"\<i-5/2\>\""]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["\[CapitalDelta]", "r"], "^", "2"}], ")"}]}]}]}], 
      "}"}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["Er", "\"\<i-1\>\""], ",", 
      SubscriptBox["Er", "i"], ",", 
      SubscriptBox["Er", "\"\<i+1\>\""], ",", 
      SubscriptBox["Eth", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+5/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+7/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i-3/2\>\""]}], "}"}], ",", "Simplify"}], 
   "]"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.4671343705273438`*^9, 3.467134373496046*^9}, {
   3.467134418882927*^9, 3.467134434928857*^9}, {3.467134537743643*^9, 
   3.46713458879793*^9}, 3.468081959357794*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{"kz", " ", "nPhi", " ", 
     SubscriptBox["Ez", "\<\"i+1/2\"\>"]}], "Rr"]}], "+", 
  RowBox[{
   SubscriptBox["Eth", "\<\"i+1/2\"\>"], " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["kz", "2"], "+", 
     FractionBox["1", 
      SuperscriptBox["Rr", "2"]], "-", 
     FractionBox["2", 
      SubsuperscriptBox["\[CapitalDelta]", "r", "2"]], "-", 
     FractionBox["3", 
      RowBox[{"2", " ", "Rr", " ", 
       SubscriptBox["\[CapitalDelta]", "r"]}]]}], ")"}]}], "+", 
  FractionBox[
   SubscriptBox["Eth", "\<\"i-5/2\"\>"], 
   SubsuperscriptBox["\[CapitalDelta]", "r", "2"]], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", "nPhi", " ", 
    SubscriptBox["Er", "\<\"i+1\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "Rr"}], "-", 
      SubscriptBox["\[CapitalDelta]", "r"]}], ")"}]}], 
   RowBox[{"2", " ", 
    SuperscriptBox["Rr", "2"], " ", 
    SubscriptBox["\[CapitalDelta]", "r"]}]], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", "nPhi", " ", 
    SubscriptBox["Er", "i"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "Rr"}], "+", 
      SubscriptBox["\[CapitalDelta]", "r"]}], ")"}]}], 
   RowBox[{"2", " ", 
    SuperscriptBox["Rr", "2"], " ", 
    SubscriptBox["\[CapitalDelta]", "r"]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["Eth", "\<\"i-1/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"5", " ", "Rr"}], "+", 
      RowBox[{"2", " ", 
       SubscriptBox["\[CapitalDelta]", "r"]}]}], ")"}]}], 
   RowBox[{"Rr", " ", 
    SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["Eth", "\<\"i-3/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{"8", "+", 
      FractionBox[
       SubscriptBox["\[CapitalDelta]", "r"], "Rr"]}], ")"}]}], 
   RowBox[{"2", " ", 
    SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]]}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.467134375479273*^9, {3.467134562262381*^9, 3.4671345893935823`*^9}, 
   3.467141658876927*^9, 3.468081959357895*^9}],

Cell[BoxData[
 RowBox[{"lhsbackwardDiffTh", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"backwardDiffCCETh", "-", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Omega]", "^", "2"}], "/", 
       RowBox[{"c", "^", "2"}]}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubsuperscriptBox["\[Epsilon]", "i", "\[Theta]r"], 
            SubscriptBox["Er", "i"]}], "+", 
           RowBox[{
            SubsuperscriptBox["\[Epsilon]", "\"\<i+1\>\"", "\[Theta]r"], 
            SubscriptBox["Er", "\"\<i+1\>\""]}]}], ")"}], "/", "2"}], "+", 
        RowBox[{
         SubsuperscriptBox["\[Epsilon]", "\"\<i+1/2\>\"", "\[Theta]\[Theta]"], 
         SubscriptBox["Eth", "\"\<i+1/2\>\""]}], "+", 
        RowBox[{
         SubsuperscriptBox["\[Epsilon]", "\"\<i+1/2\>\"", "\[Theta]z"], 
         SubscriptBox["Ez", "\"\<i+1/2\>\""]}]}], ")"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["Er", "\"\<i-1\>\""], ",", 
      SubscriptBox["Er", "i"], ",", 
      SubscriptBox["Er", "\"\<i+1\>\""], ",", 
      SubscriptBox["Eth", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+5/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+7/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+5/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+7/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i-3/2\>\""]}], "}"}], ",", "Simplify"}], 
   "]"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.4671346277518463`*^9, 3.4671346501279173`*^9}, 
   3.468081959357992*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   SubscriptBox["Eth", "\<\"i-5/2\"\>"], 
   SubsuperscriptBox["\[CapitalDelta]", "r", "2"]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["Eth", "\<\"i-1/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"5", " ", "Rr"}], "+", 
      RowBox[{"2", " ", 
       SubscriptBox["\[CapitalDelta]", "r"]}]}], ")"}]}], 
   RowBox[{"Rr", " ", 
    SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["Eth", "\<\"i-3/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{"8", "+", 
      FractionBox[
       SubscriptBox["\[CapitalDelta]", "r"], "Rr"]}], ")"}]}], 
   RowBox[{"2", " ", 
    SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]], "+", 
  RowBox[{
   SubscriptBox["Er", "\<\"i+1\"\>"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", "nPhi"}], 
       RowBox[{"2", " ", 
        SuperscriptBox["Rr", "2"]}]]}], "+", 
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", "nPhi"}], 
      RowBox[{"Rr", " ", 
       SubscriptBox["\[CapitalDelta]", "r"]}]], "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["\[Omega]", "2"], " ", 
       SubsuperscriptBox["\[Epsilon]", "\<\"i+1\"\>", "\[Theta]r"]}], 
      RowBox[{"2", " ", 
       SuperscriptBox["c", "2"]}]]}], ")"}]}], "+", 
  RowBox[{
   SubscriptBox["Ez", "\<\"i+1/2\"\>"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"kz", " ", "nPhi"}], "Rr"]}], "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["\[Omega]", "2"], " ", 
       SubsuperscriptBox["\[Epsilon]", "\<\"i+1/2\"\>", "\[Theta]z"]}], 
      SuperscriptBox["c", "2"]]}], ")"}]}], "+", 
  RowBox[{
   SubscriptBox["Eth", "\<\"i+1/2\"\>"], " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["kz", "2"], "+", 
     FractionBox["1", 
      SuperscriptBox["Rr", "2"]], "-", 
     FractionBox["2", 
      SubsuperscriptBox["\[CapitalDelta]", "r", "2"]], "-", 
     FractionBox["3", 
      RowBox[{"2", " ", "Rr", " ", 
       SubscriptBox["\[CapitalDelta]", "r"]}]], "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["\[Omega]", "2"], " ", 
       SubsuperscriptBox["\[Epsilon]", "\<\"i+1/2\"\>", "\[Theta]\[Theta]"]}], 
      SuperscriptBox["c", "2"]]}], ")"}]}], "+", 
  RowBox[{
   SubscriptBox["Er", "i"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", "nPhi", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "Rr"}], "+", 
          SubscriptBox["\[CapitalDelta]", "r"]}], ")"}]}], 
       RowBox[{"2", " ", 
        SuperscriptBox["Rr", "2"], " ", 
        SubscriptBox["\[CapitalDelta]", "r"]}]]}], "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["\[Omega]", "2"], " ", 
       SubsuperscriptBox["\[Epsilon]", "i", "\[Theta]r"]}], 
      RowBox[{"2", " ", 
       SuperscriptBox["c", "2"]}]]}], ")"}]}]}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.467134637206115*^9, 3.4671346506019382`*^9}, 
   3.4671417563691607`*^9, 3.4680819593580914`*^9}],

Cell[BoxData[
 RowBox[{"backwardDiffCCEZ", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"CCE", "[", 
      RowBox[{"[", "3", "]"}], "]"}], "/.", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Er", "[", "Rr", "]"}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["Er", "i"], "+", 
           SubscriptBox["Er", "\"\<i+1\>\""]}], ")"}], "/", "2"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Eth", "[", "Rr", "]"}], "\[Rule]", 
        SubscriptBox["Eth", "\"\<i+1/2\>\""]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Ez", "[", "Rr", "]"}], "\[Rule]", 
        SubscriptBox["Ez", "\"\<i+1/2\>\""]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", "Rr"], 
         RowBox[{"Er", "[", "Rr", "]"}]}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            SubscriptBox["Er", "i"]}], "+", 
           SubscriptBox["Er", "\"\<i+1\>\""]}], ")"}], "/", 
         SubscriptBox["\[CapitalDelta]", "r"]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", "Rr"], 
         RowBox[{"Ez", "[", "Rr", "]"}]}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"3", 
            SubscriptBox["Ez", "\"\<i+1/2\>\""]}], "-", 
           RowBox[{"4", 
            SubscriptBox["Ez", "\"\<i-1/2\>\""]}], "+", 
           SubscriptBox["Ez", "\"\<i-3/2\>\""]}], ")"}], "/", " ", 
         RowBox[{"(", 
          RowBox[{"2", 
           SubscriptBox["\[CapitalDelta]", "r"]}], ")"}]}]}], ",", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", 
          RowBox[{"Rr", ",", "Rr"}]], 
         RowBox[{"Ez", "[", "Rr", "]"}]}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", 
            SubscriptBox["Ez", "\"\<i+1/2\>\""]}], "-", 
           RowBox[{"5", " ", 
            SubscriptBox["Ez", "\"\<i-1/2\>\""]}], "+", 
           RowBox[{"4", 
            SubscriptBox["Ez", "\"\<i-3/2\>\""]}], "-", 
           SubscriptBox["Ez", "\"\<i-5/2\>\""]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["\[CapitalDelta]", "r"], "^", "2"}], ")"}]}]}]}], 
      "}"}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["Er", "\"\<i-1\>\""], ",", 
      SubscriptBox["Er", "i"], ",", 
      SubscriptBox["Er", "\"\<i+1\>\""], ",", 
      SubscriptBox["Er", "\"\<i+2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Ez", 
       RowBox[{"\"\<i+5/2\>\"", ",", 
        SubscriptBox["Ez", "\"\<i+7/2\>\""]}]], ",", 
      SubscriptBox["Eth", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i-3/2\>\""]}], "}"}], ",", "Simplify"}], 
   "]"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.467135393183098*^9, 3.4671353962715387`*^9}, {
   3.4671354528287077`*^9, 3.4671354887434883`*^9}, 3.4680819593581877`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{"kz", " ", "nPhi", " ", 
     SubscriptBox["Eth", "\<\"i+1/2\"\>"]}], "Rr"]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", "kz", " ", 
   SubscriptBox["Er", "i"], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox["1", "Rr"], "-", 
     FractionBox["2", 
      SubscriptBox["\[CapitalDelta]", "r"]]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", "kz", " ", 
   SubscriptBox["Er", "\<\"i+1\"\>"], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox["1", "Rr"], "+", 
     FractionBox["2", 
      SubscriptBox["\[CapitalDelta]", "r"]]}], ")"}]}], "+", 
  RowBox[{
   SubscriptBox["Ez", "\<\"i+1/2\"\>"], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      SuperscriptBox["nPhi", "2"], 
      SuperscriptBox["Rr", "2"]], "-", 
     FractionBox["2", 
      SubsuperscriptBox["\[CapitalDelta]", "r", "2"]], "-", 
     FractionBox["3", 
      RowBox[{"2", " ", "Rr", " ", 
       SubscriptBox["\[CapitalDelta]", "r"]}]]}], ")"}]}], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["Ez", "\<\"i-1/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"5", " ", "Rr"}], "+", 
      RowBox[{"2", " ", 
       SubscriptBox["\[CapitalDelta]", "r"]}]}], ")"}]}], 
   RowBox[{"Rr", " ", 
    SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"2", " ", "Rr", " ", 
     SubscriptBox["Ez", "\<\"i-5/2\"\>"]}], "-", 
    RowBox[{
     SubscriptBox["Ez", "\<\"i-3/2\"\>"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"8", " ", "Rr"}], "+", 
       SubscriptBox["\[CapitalDelta]", "r"]}], ")"}]}]}], 
   RowBox[{"2", " ", "Rr", " ", 
    SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]]}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{3.467135397873271*^9, 3.467135490636345*^9, 
  3.468081959358296*^9}],

Cell[BoxData[
 RowBox[{"lhsBackwardDiffZ", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"backwardDiffCCEZ", "-", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Omega]", "^", "2"}], "/", 
       RowBox[{"c", "^", "2"}]}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubsuperscriptBox["\[Epsilon]", "i", "zr"], 
            SubscriptBox["Er", "i"]}], "+", 
           RowBox[{
            SubsuperscriptBox["\[Epsilon]", "\"\<i+1\>\"", "zr"], 
            SubscriptBox["Er", "\"\<i+1\>\""]}]}], ")"}], "/", "2"}], "+", 
        RowBox[{
         SubsuperscriptBox["\[Epsilon]", "\"\<i+1/2\>\"", "z\[Theta]"], 
         SubscriptBox["Eth", "\"\<i+1/2\>\""]}], "+", 
        RowBox[{
         SubsuperscriptBox["\[Epsilon]", "\"\<i+1/2\>\"", "zz"], 
         SubscriptBox["Ez", "\"\<i+1/2\>\""]}]}], ")"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["Er", "\"\<i-1\>\""], ",", 
      SubscriptBox["Er", "i"], ",", 
      SubscriptBox["Er", "\"\<i+1\>\""], ",", 
      SubscriptBox["Eth", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+5/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+7/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i-3/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i-5/2\>\""]}], "}"}], ",", "Simplify"}], 
   "]"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.467135625311262*^9, 3.467135679793124*^9}, 
   3.468081959358396*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   SubscriptBox["Ez", "\<\"i-5/2\"\>"], 
   SubsuperscriptBox["\[CapitalDelta]", "r", "2"]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["Ez", "\<\"i-3/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"8", " ", "Rr"}], "+", 
      SubscriptBox["\[CapitalDelta]", "r"]}], ")"}]}], 
   RowBox[{"2", " ", "Rr", " ", 
    SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["Ez", "\<\"i-1/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"5", " ", "Rr"}], "+", 
      RowBox[{"2", " ", 
       SubscriptBox["\[CapitalDelta]", "r"]}]}], ")"}]}], 
   RowBox[{"Rr", " ", 
    SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]], "+", 
  RowBox[{
   SubscriptBox["Er", "\<\"i+1\"\>"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", "kz", " ", 
      RowBox[{"(", 
       RowBox[{
        FractionBox["1", "Rr"], "+", 
        FractionBox["2", 
         SubscriptBox["\[CapitalDelta]", "r"]]}], ")"}]}], "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["\[Omega]", "2"], " ", 
       SubsuperscriptBox["\[Epsilon]", "\<\"i+1\"\>", "zr"]}], 
      RowBox[{"2", " ", 
       SuperscriptBox["c", "2"]}]]}], ")"}]}], "+", 
  RowBox[{
   SubscriptBox["Ez", "\<\"i+1/2\"\>"], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      SuperscriptBox["nPhi", "2"], 
      SuperscriptBox["Rr", "2"]], "-", 
     FractionBox["2", 
      SubsuperscriptBox["\[CapitalDelta]", "r", "2"]], "-", 
     FractionBox["3", 
      RowBox[{"2", " ", "Rr", " ", 
       SubscriptBox["\[CapitalDelta]", "r"]}]], "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["\[Omega]", "2"], " ", 
       SubsuperscriptBox["\[Epsilon]", "\<\"i+1/2\"\>", "zz"]}], 
      SuperscriptBox["c", "2"]]}], ")"}]}], "+", 
  RowBox[{
   SubscriptBox["Eth", "\<\"i+1/2\"\>"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"kz", " ", "nPhi"}], "Rr"]}], "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["\[Omega]", "2"], " ", 
       SubsuperscriptBox["\[Epsilon]", "\<\"i+1/2\"\>", "z\[Theta]"]}], 
      SuperscriptBox["c", "2"]]}], ")"}]}], "+", 
  RowBox[{
   SubscriptBox["Er", "i"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", "kz", " ", 
      RowBox[{"(", 
       RowBox[{
        FractionBox["1", "Rr"], "-", 
        FractionBox["2", 
         SubscriptBox["\[CapitalDelta]", "r"]]}], ")"}]}], "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["\[Omega]", "2"], " ", 
       SubsuperscriptBox["\[Epsilon]", "i", "zr"]}], 
      RowBox[{"2", " ", 
       SuperscriptBox["c", "2"]}]]}], ")"}]}]}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.4671356383651333`*^9, 3.4671356810296307`*^9}, 
   3.4680819593584948`*^9}],

Cell[BoxData[
 RowBox[{"backwardDiffCCEThB", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"CCE", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "/.", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Er", "[", "Rr", "]"}], "\[Rule]", 
        SubscriptBox["Er", "i"]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Eth", "[", "Rr", "]"}], "\[Rule]", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Ez", "[", "Rr", "]"}], "\[Rule]", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", "Rr"], 
         RowBox[{"Er", "[", "Rr", "]"}]}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"3", 
            SubscriptBox["Er", "i"]}], "-", 
           RowBox[{"4", 
            SubscriptBox["Er", "\"\<i-1\>\""]}], "+", 
           SubscriptBox["Er", "\"\<i-2\>\""]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"2", 
           SubscriptBox["\[CapitalDelta]", "r"]}], ")"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", "Rr"], 
         RowBox[{"Eth", "[", "Rr", "]"}]}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"3", 
            SubscriptBox["Eth", "i"], "*", "0"}], "-", 
           RowBox[{"4", 
            SubscriptBox["Eth", "\"\<i-1/2\>\""]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["Eth", "\"\<i-1/2\>\""], "+", 
              SubscriptBox["Eth", "\"\<i-3/2\>\""]}], ")"}], "/", "2"}]}], 
          ")"}], "/", " ", 
         SubscriptBox["\[CapitalDelta]", "r"]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", 
          RowBox[{"Rr", ",", "Rr"}]], 
         RowBox[{"Eth", "[", "Rr", "]"}]}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", 
            SubscriptBox["Eth", "i"], "*", "0"}], "-", 
           RowBox[{"5", " ", 
            SubscriptBox["Eth", "\"\<i-1/2\>\""]}], "+", 
           RowBox[{"4", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SubscriptBox["Eth", "\"\<i-1/2\>\""], "+", 
               SubscriptBox["Eth", "\"\<i-3/2\>\""]}], ")"}], "/", "2"}]}], 
           "-", 
           SubscriptBox["Eth", "\"\<i-3/2\>\""]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["\[CapitalDelta]", "r"], "/", "2"}], ")"}], "^", 
           "2"}], ")"}]}]}]}], "}"}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["Er", "\"\<i-1\>\""], ",", 
      SubscriptBox["Er", "i"], ",", 
      SubscriptBox["Er", "\"\<i+1\>\""], ",", 
      SubscriptBox["Eth", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Er", "\"\<i-2\>\""]}], "}"}], ",", "Simplify"}], 
   "]"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.467150873721483*^9, 3.467150876529737*^9}, {
   3.467150922177738*^9, 3.4671509697695932`*^9}, {3.4671510741858473`*^9, 
   3.467151089085392*^9}, 3.468081959358595*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{"2", " ", "\[ImaginaryI]", " ", "nPhi", " ", 
     SubscriptBox["Er", "\<\"i-1\"\>"]}], 
    RowBox[{"Rr", " ", 
     SubscriptBox["\[CapitalDelta]", "r"]}]]}], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", "nPhi", " ", 
    SubscriptBox["Er", "\<\"i-2\"\>"]}], 
   RowBox[{"2", " ", "Rr", " ", 
    SubscriptBox["\[CapitalDelta]", "r"]}]], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", "nPhi", " ", 
    SubscriptBox["Er", "i"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"3", " ", "Rr"}], "-", 
      RowBox[{"2", " ", 
       SubscriptBox["\[CapitalDelta]", "r"]}]}], ")"}]}], 
   RowBox[{"2", " ", 
    SuperscriptBox["Rr", "2"], " ", 
    SubscriptBox["\[CapitalDelta]", "r"]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["Eth", "\<\"i-3/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"8", " ", "Rr"}], "+", 
      SubscriptBox["\[CapitalDelta]", "r"]}], ")"}]}], 
   RowBox[{"2", " ", "Rr", " ", 
    SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["Eth", "\<\"i-1/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{"24", "+", 
      FractionBox[
       RowBox[{"7", " ", 
        SubscriptBox["\[CapitalDelta]", "r"]}], "Rr"]}], ")"}]}], 
   RowBox[{"2", " ", 
    SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]]}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{3.4671510591281843`*^9, 3.4671510902367764`*^9, 
  3.468081959358695*^9}],

Cell[BoxData[
 RowBox[{"lhsBackwardDiffThB", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"backwardDiffCCEThB", "-", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Omega]", "^", "2"}], "/", 
       RowBox[{"c", "^", "2"}]}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubsuperscriptBox["\[Epsilon]", "i", "\[Theta]r"], 
         SubscriptBox["Er", "i"]}], "+", 
        RowBox[{
         SubscriptBox["Eth", "i"], "*", "0"}], "+", 
        RowBox[{
         SubscriptBox["Ez", "i"], "*", "0"}]}], ")"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["Er", "\"\<i-1\>\""], ",", 
      SubscriptBox["Er", "i"], ",", 
      SubscriptBox["Er", "\"\<i+1\>\""], ",", 
      SubscriptBox["Eth", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Er", "\"\<i-2\>\""]}], "}"}], ",", "Simplify"}], 
   "]"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.4671512043335123`*^9, 3.467151234981352*^9}, 
   3.468081959358794*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{"2", " ", "\[ImaginaryI]", " ", "nPhi", " ", 
     SubscriptBox["Er", "\<\"i-1\"\>"]}], 
    RowBox[{"Rr", " ", 
     SubscriptBox["\[CapitalDelta]", "r"]}]]}], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", "nPhi", " ", 
    SubscriptBox["Er", "\<\"i-2\"\>"]}], 
   RowBox[{"2", " ", "Rr", " ", 
    SubscriptBox["\[CapitalDelta]", "r"]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["Eth", "\<\"i-3/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"8", " ", "Rr"}], "+", 
      SubscriptBox["\[CapitalDelta]", "r"]}], ")"}]}], 
   RowBox[{"2", " ", "Rr", " ", 
    SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["Eth", "\<\"i-1/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{"24", "+", 
      FractionBox[
       RowBox[{"7", " ", 
        SubscriptBox["\[CapitalDelta]", "r"]}], "Rr"]}], ")"}]}], 
   RowBox[{"2", " ", 
    SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]], "+", 
  RowBox[{
   SubscriptBox["Er", "i"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", "nPhi"}], 
       SuperscriptBox["Rr", "2"]]}], "+", 
     FractionBox[
      RowBox[{"3", " ", "\[ImaginaryI]", " ", "nPhi"}], 
      RowBox[{"2", " ", "Rr", " ", 
       SubscriptBox["\[CapitalDelta]", "r"]}]], "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["\[Omega]", "2"], " ", 
       SubsuperscriptBox["\[Epsilon]", "i", "\[Theta]r"]}], 
      SuperscriptBox["c", "2"]]}], ")"}]}]}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.467151197548012*^9, 3.467151235988831*^9}, 
   3.468081959358904*^9}],

Cell[BoxData[
 RowBox[{"backwardDiffCCEZB", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"CCE", "[", 
      RowBox[{"[", "3", "]"}], "]"}], "/.", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Er", "[", "Rr", "]"}], "\[Rule]", 
        SubscriptBox["Er", "i"]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Eth", "[", "Rr", "]"}], "\[Rule]", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Ez", "[", "Rr", "]"}], "\[Rule]", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", "Rr"], 
         RowBox[{"Er", "[", "Rr", "]"}]}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"3", 
            SubscriptBox["Er", "i"]}], "-", 
           RowBox[{"4", 
            SubscriptBox["Er", "\"\<i-1\>\""]}], "+", 
           SubscriptBox["Er", "\"\<i-2\>\""]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"2", 
           SubscriptBox["\[CapitalDelta]", "r"]}], ")"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", "Rr"], 
         RowBox[{"Ez", "[", "Rr", "]"}]}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"3", 
            SubscriptBox["Ez", "i"], "*", "0"}], "-", 
           RowBox[{"4", 
            SubscriptBox["Ez", "\"\<i-1/2\>\""]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["Ez", "\"\<i-1/2\>\""], "+", 
              SubscriptBox["Ez", "\"\<i-3/2\>\""]}], ")"}], "/", "2"}]}], 
          ")"}], "/", 
         SubscriptBox["\[CapitalDelta]", "r"]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", 
          RowBox[{"Rr", ",", "Rr"}]], 
         RowBox[{"Ez", "[", "Rr", "]"}]}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", 
            SubscriptBox["Ez", "i"], "*", "0"}], "-", 
           RowBox[{"5", 
            SubscriptBox["Ez", "\"\<i-1/2\>\""]}], "+", 
           RowBox[{"4", 
            RowBox[{
             RowBox[{"(", " ", 
              RowBox[{
               SubscriptBox["Ez", "\"\<i-1/2\>\""], "+", 
               SubscriptBox["Ez", "\"\<i-3/2\>\""]}], ")"}], "/", "2"}]}], 
           "-", 
           SubscriptBox["Ez", "\"\<i-3/2\>\""]}], ")"}], "/", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["\[CapitalDelta]", "r"], "/", "2"}], ")"}], "^", 
          "2"}]}]}]}], "}"}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["Er", "\"\<i-1\>\""], ",", 
      SubscriptBox["Er", "i"], ",", 
      SubscriptBox["Er", "\"\<i+1\>\""], ",", 
      SubscriptBox["Er", "\"\<i+2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Er", "\"\<i-2\>\""]}], "}"}], ",", "Simplify"}], 
   "]"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.467151315268499*^9, 3.467151391515766*^9}, 
   3.468081959359004*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", "kz", " ", 
   SubscriptBox["Er", "i"], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox["2", "Rr"], "+", 
     FractionBox["3", 
      SubscriptBox["\[CapitalDelta]", "r"]]}], ")"}]}], "-", 
  FractionBox[
   RowBox[{"2", " ", "\[ImaginaryI]", " ", "kz", " ", 
    SubscriptBox["Er", "\<\"i-1\"\>"]}], 
   SubscriptBox["\[CapitalDelta]", "r"]], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", "kz", " ", 
    SubscriptBox["Er", "\<\"i-2\"\>"]}], 
   RowBox[{"2", " ", 
    SubscriptBox["\[CapitalDelta]", "r"]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["Ez", "\<\"i-3/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"8", " ", "Rr"}], "+", 
      SubscriptBox["\[CapitalDelta]", "r"]}], ")"}]}], 
   RowBox[{"2", " ", "Rr", " ", 
    SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["Ez", "\<\"i-1/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{"24", "+", 
      FractionBox[
       RowBox[{"7", " ", 
        SubscriptBox["\[CapitalDelta]", "r"]}], "Rr"]}], ")"}]}], 
   RowBox[{"2", " ", 
    SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]]}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.46715132205549*^9, {3.4671513690154676`*^9, 3.4671513925205584`*^9}, 
   3.4680819593591022`*^9}],

Cell[BoxData[
 RowBox[{"lhsBackwardDiffZB", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"backwardDiffCCEZB", "-", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Omega]", "^", "2"}], "/", 
       RowBox[{"c", "^", "2"}]}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubsuperscriptBox["\[Epsilon]", "i", "zr"], 
         SubscriptBox["Er", "i"]}], "+", 
        RowBox[{
         SubsuperscriptBox["\[Epsilon]", "\"\<i+1/2\>\"", "z\[Theta]"], 
         SubscriptBox["Eth", "\"\<i+1/2\>\""], "*", "0"}], "+", 
        RowBox[{
         SubsuperscriptBox["\[Epsilon]", "\"\<i+1/2\>\"", "zz"], 
         SubscriptBox["Ez", "\"\<i+1/2\>\""], "*", "0"}]}], ")"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["Er", "\"\<i-1\>\""], ",", 
      SubscriptBox["Er", "i"], ",", 
      SubscriptBox["Er", "\"\<i+1\>\""], ",", 
      SubscriptBox["Eth", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Er", "\"\<i+2\>\""], ",", 
      SubscriptBox["Er", "\"\<i-2\>\""]}], "}"}], ",", "Simplify"}], 
   "]"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.46715151261775*^9, 3.467151541823331*^9}, 
   3.468081959359207*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{"2", " ", "\[ImaginaryI]", " ", "kz", " ", 
     SubscriptBox["Er", "\<\"i-1\"\>"]}], 
    SubscriptBox["\[CapitalDelta]", "r"]]}], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", "kz", " ", 
    SubscriptBox["Er", "\<\"i-2\"\>"]}], 
   RowBox[{"2", " ", 
    SubscriptBox["\[CapitalDelta]", "r"]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["Ez", "\<\"i-3/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"8", " ", "Rr"}], "+", 
      SubscriptBox["\[CapitalDelta]", "r"]}], ")"}]}], 
   RowBox[{"2", " ", "Rr", " ", 
    SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["Ez", "\<\"i-1/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{"24", "+", 
      FractionBox[
       RowBox[{"7", " ", 
        SubscriptBox["\[CapitalDelta]", "r"]}], "Rr"]}], ")"}]}], 
   RowBox[{"2", " ", 
    SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]], "+", 
  RowBox[{
   SubscriptBox["Er", "i"], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", "kz"}], "Rr"], "+", 
     FractionBox[
      RowBox[{"3", " ", "\[ImaginaryI]", " ", "kz"}], 
      RowBox[{"2", " ", 
       SubscriptBox["\[CapitalDelta]", "r"]}]], "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["\[Omega]", "2"], " ", 
       SubsuperscriptBox["\[Epsilon]", "i", "zr"]}], 
      SuperscriptBox["c", "2"]]}], ")"}]}]}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.467151508707793*^9, 3.467151542835836*^9}, 
   3.468081959359318*^9}],

Cell[BoxData[
 RowBox[{"forwardDiffCCERHalfGridBry", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"CCE", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "/.", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Er", "[", "Rr", "]"}], "\[Rule]", 
        SubscriptBox["Er", "i"]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Eth", "[", "Rr", "]"}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["Eth", "\"\<i-1/2\>\""], "*", "0"}], "+", 
           SubscriptBox["Eth", "\"\<i+1/2\>\""]}], ")"}], "/", "2"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Ez", "[", "Rr", "]"}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["Ez", "\"\<i-1/2\>\""], "*", "0"}], "+", 
           SubscriptBox["Ez", "\"\<i+1/2\>\""]}], ")"}], "/", "2"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", "Rr"], 
         RowBox[{"Eth", "[", "Rr", "]"}]}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             SubscriptBox["Eth", "\"\<i-1/2\>\""]}], "*", "0"}], "+", 
           SubscriptBox["Eth", "\"\<i+1/2\>\""]}], ")"}], "/", 
         SubscriptBox["\[CapitalDelta]", "r"]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", "Rr"], 
         RowBox[{"Ez", "[", "Rr", "]"}]}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             SubscriptBox["Ez", "\"\<i-1/2\>\""]}], "*", "0"}], "+", 
           SubscriptBox["Ez", "\"\<i+1/2\>\""]}], ")"}], "/", 
         SubscriptBox["\[CapitalDelta]", "r"]}]}]}], "}"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["Er", "\"\<i-1\>\""], ",", 
      SubscriptBox["Er", "i"], ",", 
      SubscriptBox["Er", "\"\<i+1\>\""], ",", 
      SubscriptBox["Eth", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+3/2\>\""]}], "}"}], ",", "Simplify"}], 
   "]"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.467222475751841*^9, 3.4672226360995493`*^9}, {
   3.467222852041398*^9, 3.46722285235238*^9}, {3.467224433009432*^9, 
   3.467224517170988*^9}, 3.468081959359425*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["kz", "2"], "+", 
     FractionBox[
      SuperscriptBox["nPhi", "2"], 
      SuperscriptBox["Rr", "2"]]}], ")"}], " ", 
   SubscriptBox["Er", "i"]}], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", "kz", " ", 
    SubscriptBox["Ez", "\<\"i+1/2\"\>"]}], 
   SubscriptBox["\[CapitalDelta]", "r"]], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", "nPhi", " ", 
    SubscriptBox["Eth", "\<\"i+1/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "Rr"}], "+", 
      SubscriptBox["\[CapitalDelta]", "r"]}], ")"}]}], 
   RowBox[{"2", " ", 
    SuperscriptBox["Rr", "2"], " ", 
    SubscriptBox["\[CapitalDelta]", "r"]}]]}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.467222480884716*^9, {3.467222624355132*^9, 3.467222637381343*^9}, 
   3.467222853603093*^9, 3.467224519706626*^9, 3.46722517146627*^9, 
   3.4680819593595324`*^9}],

Cell[BoxData[
 RowBox[{"lhsForwardDiffRHalfGridBry", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"forwardDiffCCERHalfGridBry", "-", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Omega]", "^", "2"}], "/", 
       RowBox[{"c", "^", "2"}]}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubsuperscriptBox["\[Epsilon]", "i", "rr"], 
         SubscriptBox["Er", "i"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["Eth", "\"\<i-1/2\>\""], "*", "0"}], "+", 
           RowBox[{
            SubsuperscriptBox["\[Epsilon]", "\"\<i+1/2\>\"", "r\[Theta]"], 
            SubscriptBox["Eth", "\"\<i+1/2\>\""]}]}], ")"}], "/", "2"}], "+", 
        
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["Ez", "\"\<i-1/2\>\""], "*", "0"}], "+", 
           RowBox[{
            SubsuperscriptBox["\[Epsilon]", "\"\<i+1/2\>\"", "rz"], 
            SubscriptBox["Ez", "\"\<i+1/2\>\""]}]}], ")"}], "/", "2"}]}], 
       ")"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["Er", "\"\<i-1\>\""], ",", 
      SubscriptBox["Er", "i"], ",", 
      SubscriptBox["Er", "\"\<i+1\>\""], ",", 
      SubscriptBox["Eth", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+3/2\>\""]}], "}"}], ",", "Simplify"}], 
   "]"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.467222737013534*^9, 3.467222845734236*^9}, 
   3.46808195935963*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["Ez", "\<\"i+1/2\"\>"], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", "kz"}], 
      SubscriptBox["\[CapitalDelta]", "r"]], "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["\[Omega]", "2"], " ", 
       SubsuperscriptBox["\[Epsilon]", "\<\"i+1/2\"\>", "rz"]}], 
      RowBox[{"2", " ", 
       SuperscriptBox["c", "2"]}]]}], ")"}]}], "+", 
  RowBox[{
   SubscriptBox["Eth", "\<\"i+1/2\"\>"], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", "nPhi", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "Rr"}], "+", 
         SubscriptBox["\[CapitalDelta]", "r"]}], ")"}]}], 
      RowBox[{"2", " ", 
       SuperscriptBox["Rr", "2"], " ", 
       SubscriptBox["\[CapitalDelta]", "r"]}]], "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["\[Omega]", "2"], " ", 
       SubsuperscriptBox["\[Epsilon]", "\<\"i+1/2\"\>", "r\[Theta]"]}], 
      RowBox[{"2", " ", 
       SuperscriptBox["c", "2"]}]]}], ")"}]}], "+", 
  RowBox[{
   SubscriptBox["Er", "i"], " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["kz", "2"], "+", 
     FractionBox[
      SuperscriptBox["nPhi", "2"], 
      SuperscriptBox["Rr", "2"]], "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["\[Omega]", "2"], " ", 
       SubsuperscriptBox["\[Epsilon]", "i", "rr"]}], 
      SuperscriptBox["c", "2"]]}], ")"}]}]}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{3.467222745885323*^9, 3.467222855159316*^9, 
  3.467224522189869*^9, 3.46722517427938*^9, 3.468081959359729*^9}],

Cell[BoxData[
 RowBox[{"backwardDiffCCERHalfGridBry", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"CCE", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "/.", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Er", "[", "Rr", "]"}], "\[Rule]", 
        SubscriptBox["Er", "i"]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Eth", "[", "Rr", "]"}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["Eth", "\"\<i-1/2\>\""], "+", 
           RowBox[{
            SubscriptBox["Eth", "\"\<i+1/2\>\""], "*", "0"}]}], ")"}], "/", 
         "2"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Ez", "[", "Rr", "]"}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["Ez", "\"\<i-1/2\>\""], "+", 
           RowBox[{
            SubscriptBox["Ez", "\"\<i+1/2\>\""], "*", "0"}]}], ")"}], "/", 
         "2"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", "Rr"], 
         RowBox[{"Eth", "[", "Rr", "]"}]}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            SubscriptBox["Eth", "\"\<i-1/2\>\""]}], "+", 
           RowBox[{
            SubscriptBox["Eth", "\"\<i+1/2\>\""], "*", "0"}]}], ")"}], "/", 
         SubscriptBox["\[CapitalDelta]", "r"]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", "Rr"], 
         RowBox[{"Ez", "[", "Rr", "]"}]}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            SubscriptBox["Ez", "\"\<i-1/2\>\""]}], "+", 
           RowBox[{
            SubscriptBox["Ez", "\"\<i+1/2\>\""], "*", "0"}]}], ")"}], "/", 
         SubscriptBox["\[CapitalDelta]", "r"]}]}]}], "}"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["Er", "\"\<i-1\>\""], ",", 
      SubscriptBox["Er", "i"], ",", 
      SubscriptBox["Er", "\"\<i+1\>\""], ",", 
      SubscriptBox["Eth", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+3/2\>\""]}], "}"}], ",", "Simplify"}], 
   "]"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.46722454303365*^9, 3.4672245731621304`*^9}, 
   3.46808195935983*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["kz", "2"], "+", 
     FractionBox[
      SuperscriptBox["nPhi", "2"], 
      SuperscriptBox["Rr", "2"]]}], ")"}], " ", 
   SubscriptBox["Er", "i"]}], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", "nPhi", " ", 
    SubscriptBox["Eth", "\<\"i-1/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      FractionBox[
       RowBox[{"2", " ", "Rr"}], 
       SubscriptBox["\[CapitalDelta]", "r"]]}], ")"}]}], 
   RowBox[{"2", " ", 
    SuperscriptBox["Rr", "2"]}]], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", "kz", " ", 
    SubscriptBox["Ez", "\<\"i-1/2\"\>"]}], 
   SubscriptBox["\[CapitalDelta]", "r"]]}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.467224547730094*^9, 3.467224582737341*^9}, 
   3.468081959359934*^9}],

Cell[BoxData[
 RowBox[{"lhsBackwardDiffRHalfGridBry", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"backwardDiffCCERHalfGridBry", "-", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Omega]", "^", "2"}], "/", 
       RowBox[{"c", "^", "2"}]}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubsuperscriptBox["\[Epsilon]", "i", "rr"], 
         SubscriptBox["Er", "i"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubsuperscriptBox["\[Epsilon]", "\"\<i-1/2\>\"", "r\[Theta]"], 
            SubscriptBox["Eth", "\"\<i-1/2\>\""]}], "+", 
           RowBox[{
            SubscriptBox["Eth", "\"\<i+1/2\>\""], "*", "0"}]}], ")"}], "/", 
         "2"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubsuperscriptBox["\[Epsilon]", "\"\<i-1/2\>\"", "rz"], 
            SubscriptBox["Ez", "\"\<i-1/2\>\""]}], "+", 
           RowBox[{
            SubsuperscriptBox["\[Epsilon]", "\"\<i+1/2\>\"", "rz"], 
            SubscriptBox["Ez", "\"\<i+1/2\>\""], "*", "0"}]}], ")"}], "/", 
         "2"}]}], ")"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["Er", "\"\<i-1\>\""], ",", 
      SubscriptBox["Er", "i"], ",", 
      SubscriptBox["Er", "\"\<i+1\>\""], ",", 
      SubscriptBox["Eth", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+3/2\>\""]}], "}"}], ",", "Simplify"}], 
   "]"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.4672246055970592`*^9, 3.467224651562243*^9}, {
   3.4672249640202093`*^9, 3.467225026574905*^9}, 3.468081959360032*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["Ez", "\<\"i-1/2\"\>"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", "kz"}], 
       SubscriptBox["\[CapitalDelta]", "r"]]}], "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["\[Omega]", "2"], " ", 
       SubsuperscriptBox["\[Epsilon]", "\<\"i-1/2\"\>", "rz"]}], 
      RowBox[{"2", " ", 
       SuperscriptBox["c", "2"]}]]}], ")"}]}], "+", 
  RowBox[{
   SubscriptBox["Eth", "\<\"i-1/2\"\>"], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", "nPhi", " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         FractionBox[
          RowBox[{"2", " ", "Rr"}], 
          SubscriptBox["\[CapitalDelta]", "r"]]}], ")"}]}], 
      RowBox[{"2", " ", 
       SuperscriptBox["Rr", "2"]}]], "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["\[Omega]", "2"], " ", 
       SubsuperscriptBox["\[Epsilon]", "\<\"i-1/2\"\>", "r\[Theta]"]}], 
      RowBox[{"2", " ", 
       SuperscriptBox["c", "2"]}]]}], ")"}]}], "+", 
  RowBox[{
   SubscriptBox["Er", "i"], " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["kz", "2"], "+", 
     FractionBox[
      SuperscriptBox["nPhi", "2"], 
      SuperscriptBox["Rr", "2"]], "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["\[Omega]", "2"], " ", 
       SubsuperscriptBox["\[Epsilon]", "i", "rr"]}], 
      SuperscriptBox["c", "2"]]}], ")"}]}]}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.467224616590818*^9, 3.4672246524169207`*^9, {3.46722497620467*^9, 
   3.467225027116776*^9}, 3.4680819593601313`*^9}]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Perp/Par dispersion relation", "Section",
 CellChangeTimes->{{3.46815413722548*^9, 3.468154157717492*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"S", "-", 
        RowBox[{
         RowBox[{"n", "^", "2"}], 
         RowBox[{
          RowBox[{"Cos", "[", "\[Theta]", "]"}], "^", "2"}]}]}], ",", 
       RowBox[{
        RowBox[{"-", "I"}], " ", "D"}], ",", " ", 
       RowBox[{
        RowBox[{"n", "^", "2"}], " ", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"I", " ", "D"}], ",", " ", 
       RowBox[{"S", "-", 
        RowBox[{"n", "^", "2"}]}], ",", " ", "0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"n", "^", "2"}], " ", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", " ", "0", ",", " ", 
       RowBox[{"P", "-", 
        RowBox[{
         RowBox[{"n", "^", "2"}], " ", 
         RowBox[{
          RowBox[{"Sin", "[", "\[Theta]", "]"}], "^", "2"}]}]}]}], "}"}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Theta]", "=", 
   RowBox[{"ArcTan", "[", 
    RowBox[{"nPar", ",", "nPer"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n", "=", 
   RowBox[{"Sqrt", "[", 
    RowBox[{
     RowBox[{"nPar", "^", "2"}], "+", 
     RowBox[{"nPer", "^", "2"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"matSimple", "=", 
   RowBox[{"FullSimplify", "[", "mat", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"nPar", "=", 
  RowBox[{
   RowBox[{"1", "/", "bt"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"bp", " ", "nPer"}], "+", "nPhi"}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"eqn", "=", 
  RowBox[{
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{"Expand", "[", 
      RowBox[{"FullSimplify", "[", 
       RowBox[{"Det", "[", "matSimple", "]"}], "]"}], "]"}], ",", "nPer"}], 
    "]"}], "\[Equal]", "0"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"ans", "=", 
    RowBox[{"Simplify", "[", 
     RowBox[{"Solve", "[", 
      RowBox[{"eqn", ",", "nPer"}], "]"}], "]"}]}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.468154159426696*^9, 3.468154160110811*^9}, {
   3.468154292394231*^9, 3.468154359646488*^9}, {3.4681545968994923`*^9, 
   3.468154664731475*^9}, {3.468154718779657*^9, 3.468154758165751*^9}, {
   3.468154798800561*^9, 3.468154817468388*^9}, {3.468155028739051*^9, 
   3.468155030583913*^9}, {3.468155084780448*^9, 3.468155085377836*^9}, {
   3.468155403366437*^9, 3.4681554039304*^9}, {3.468155764311181*^9, 
   3.4681557758915043`*^9}, {3.4681558139554043`*^9, 3.468155816976645*^9}, {
   3.4681558694951963`*^9, 3.468155871123795*^9}, {3.470413044156506*^9, 
   3.4704131086919622`*^9}, {3.470413271584084*^9, 3.470413327695161*^9}, {
   3.470413365887959*^9, 3.470413378497431*^9}, {3.470413436221105*^9, 
   3.4704134478310137`*^9}, {3.470413517897031*^9, 3.470413521491116*^9}, {
   3.470413780352784*^9, 3.4704138045484533`*^9}, 3.4704139323119183`*^9, {
   3.47041403509223*^9, 3.4704140716206093`*^9}, {3.470419575909388*^9, 
   3.4704195877284813`*^9}, {3.470420505862979*^9, 3.470420510336574*^9}, {
   3.4704206872178183`*^9, 3.470420698343618*^9}, {3.4704218044419813`*^9, 
   3.470421808334094*^9}, {3.470421957093381*^9, 3.4704219595824842`*^9}, {
   3.470422036686412*^9, 3.470422060445797*^9}, {3.4704221465532827`*^9, 
   3.4704221680257263`*^9}, {3.470422280801474*^9, 3.470422336057168*^9}, {
   3.470422394043865*^9, 3.470422408624227*^9}, {3.4704224549331703`*^9, 
   3.470422457603167*^9}, {3.470422493687058*^9, 3.4704225126309566`*^9}, {
   3.470422670684901*^9, 3.470422675600237*^9}, {3.470422750372616*^9, 
   3.470422755863636*^9}, {3.470422801988089*^9, 3.4704228036927853`*^9}, {
   3.470423132854335*^9, 3.470423135561997*^9}, {3.4704233243235607`*^9, 
   3.4704233509668417`*^9}, {3.470423400977151*^9, 3.470423420701149*^9}, {
   3.470423529861391*^9, 3.4704235882823887`*^9}, {3.470423673087829*^9, 
   3.4704236748470907`*^9}, {3.470436431115806*^9, 3.47043651993641*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"bp", " ", "nPer"}], "+", "nPhi"}], "bt"]], "Output",
 CellChangeTimes->{
  3.470421830381575*^9, 3.4704219610334806`*^9, 3.4704222901014137`*^9, {
   3.470422321970675*^9, 3.470422355095873*^9}, {3.4704223973584146`*^9, 
   3.470422418289672*^9}, 3.470422513521717*^9, 3.470422676728393*^9, 
   3.470422756470767*^9, 3.470422804929394*^9, 3.470423136562356*^9, {
   3.47042332712906*^9, 3.470423351632374*^9}, {3.4704234093694353`*^9, 
   3.470423421964308*^9}, {3.470423534360271*^9, 3.4704235499656363`*^9}, 
   3.470423630309826*^9, {3.470436486958334*^9, 3.470436520725431*^9}, 
   3.470436673643866*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     SuperscriptBox["D", "2"]}], " ", "P"}], "+", 
   FractionBox[
    RowBox[{
     SuperscriptBox["nPhi", "4"], " ", "P"}], 
    SuperscriptBox["bt", "4"]], "-", 
   FractionBox[
    RowBox[{"2", " ", 
     SuperscriptBox["nPhi", "2"], " ", "P", " ", "S"}], 
    SuperscriptBox["bt", "2"]], "+", 
   RowBox[{"P", " ", 
    SuperscriptBox["S", "2"]}], "+", 
   RowBox[{
    SuperscriptBox["nPer", "4"], " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{
        SuperscriptBox["bp", "4"], " ", "P"}], 
       SuperscriptBox["bt", "4"]], "+", 
      FractionBox[
       RowBox[{
        SuperscriptBox["bp", "2"], " ", "P"}], 
       SuperscriptBox["bt", "2"]], "+", "S", "+", 
      FractionBox[
       RowBox[{
        SuperscriptBox["bp", "2"], " ", "S"}], 
       SuperscriptBox["bt", "2"]]}], ")"}]}], "+", 
   RowBox[{
    SuperscriptBox["nPer", "3"], " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{"4", " ", 
        SuperscriptBox["bp", "3"], " ", "nPhi", " ", "P"}], 
       SuperscriptBox["bt", "4"]], "+", 
      FractionBox[
       RowBox[{"2", " ", "bp", " ", "nPhi", " ", "P"}], 
       SuperscriptBox["bt", "2"]], "+", 
      FractionBox[
       RowBox[{"2", " ", "bp", " ", "nPhi", " ", "S"}], 
       SuperscriptBox["bt", "2"]]}], ")"}]}], "+", 
   RowBox[{"nPer", " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{"4", " ", "bp", " ", 
        SuperscriptBox["nPhi", "3"], " ", "P"}], 
       SuperscriptBox["bt", "4"]], "-", 
      FractionBox[
       RowBox[{"4", " ", "bp", " ", "nPhi", " ", "P", " ", "S"}], 
       SuperscriptBox["bt", "2"]]}], ")"}]}], "+", 
   RowBox[{
    SuperscriptBox["nPer", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["D", "2"], "+", 
      FractionBox[
       RowBox[{"6", " ", 
        SuperscriptBox["bp", "2"], " ", 
        SuperscriptBox["nPhi", "2"], " ", "P"}], 
       SuperscriptBox["bt", "4"]], "+", 
      FractionBox[
       RowBox[{
        SuperscriptBox["nPhi", "2"], " ", "P"}], 
       SuperscriptBox["bt", "2"]], "+", 
      FractionBox[
       RowBox[{
        SuperscriptBox["nPhi", "2"], " ", "S"}], 
       SuperscriptBox["bt", "2"]], "-", 
      RowBox[{"P", " ", "S"}], "-", 
      FractionBox[
       RowBox[{"2", " ", 
        SuperscriptBox["bp", "2"], " ", "P", " ", "S"}], 
       SuperscriptBox["bt", "2"]], "-", 
      SuperscriptBox["S", "2"]}], ")"}]}]}], "\[Equal]", "0"}]], "Output",
 CellChangeTimes->{
  3.470421830381575*^9, 3.4704219610334806`*^9, 3.4704222901014137`*^9, {
   3.470422321970675*^9, 3.470422355095873*^9}, {3.4704223973584146`*^9, 
   3.470422418289672*^9}, 3.470422513521717*^9, 3.470422676728393*^9, 
   3.470422756470767*^9, 3.470422804929394*^9, 3.470423136562356*^9, {
   3.47042332712906*^9, 3.470423351632374*^9}, {3.4704234093694353`*^9, 
   3.470423421964308*^9}, {3.470423534360271*^9, 3.4704235499656363`*^9}, 
   3.470423630309826*^9, {3.470436486958334*^9, 3.470436520725431*^9}, 
   3.470436674465392*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["lhs for free space", "Section",
 CellChangeTimes->{{3.4692007269733458`*^9, 3.469200739272464*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"lhsCentralDiffR", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"centralDiffCCErCons", "-", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Omega]", "^", "2"}], "/", 
       RowBox[{"c", "^", "2"}]}], " ", 
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{
        SubsuperscriptBox["\[Epsilon]", "i", "rr"], 
        SubscriptBox["Er", "i"]}], "\[IndentingNewLine]", ")"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["Er", "\"\<i-1\>\""], ",", 
      SubscriptBox["Er", "i"], ",", 
      SubscriptBox["Er", "\"\<i+1\>\""], ",", 
      SubscriptBox["Eth", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+3/2\>\""]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.469200748956957*^9, 3.469200749798739*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", "kz", " ", 
      SubscriptBox["Ez", "\<\"i-1/2\"\>"]}], 
     SubscriptBox["\[CapitalDelta]", "r"]]}], "+", 
   FractionBox[
    RowBox[{"\[ImaginaryI]", " ", "kz", " ", 
     SubscriptBox["Ez", "\<\"i+1/2\"\>"]}], 
    SubscriptBox["\[CapitalDelta]", "r"]], "-", 
   FractionBox[
    RowBox[{"\[ImaginaryI]", " ", 
     SubscriptBox["Eth", "\<\"i-1/2\"\>"], " ", 
     SubscriptBox["n", "\[Phi]"], " ", 
     SubscriptBox["r", "\<\"i-1/2\"\>"]}], 
    RowBox[{
     SubsuperscriptBox["r", "i", "2"], " ", 
     SubscriptBox["\[CapitalDelta]", "r"]}]], "+", 
   FractionBox[
    RowBox[{"\[ImaginaryI]", " ", 
     SubscriptBox["Eth", "\<\"i+1/2\"\>"], " ", 
     SubscriptBox["n", "\[Phi]"], " ", 
     SubscriptBox["r", "\<\"i+1/2\"\>"]}], 
    RowBox[{
     SubsuperscriptBox["r", "i", "2"], " ", 
     SubscriptBox["\[CapitalDelta]", "r"]}]], "+", 
   RowBox[{
    SubscriptBox["Er", "i"], " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["kz", "2"], "+", 
      FractionBox[
       SubsuperscriptBox["n", "\[Phi]", "2"], 
       SubsuperscriptBox["r", "i", "2"]], "-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["\[Omega]", "2"], " ", 
        SubsuperscriptBox["\[Epsilon]", "i", "rr"]}], 
       SuperscriptBox["c", "2"]]}], ")"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.469200756739081*^9, 3.46920077159715*^9}, 
   3.4692875578726053`*^9, 3.469289326268262*^9, 3.469298003541827*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"lhsCentralDiffTh", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"centralDiffCCEthCons", "-", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Omega]", "^", "2"}], "/", 
       RowBox[{"c", "^", "2"}]}], " ", 
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"+", 
         SubsuperscriptBox["\[Epsilon]", "\"\<i+1/2\>\"", 
          "\[Theta]\[Theta]"]}], 
        SubscriptBox["Eth", "\"\<i+1/2\>\""]}], "\[IndentingNewLine]", 
       ")"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["Er", "\"\<i-1\>\""], ",", 
      SubscriptBox["Er", "i"], ",", 
      SubscriptBox["Er", "\"\<i+1\>\""], ",", 
      SubscriptBox["Eth", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+3/2\>\""]}], "}"}], ",", "Simplify"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.469200971241857*^9, 3.469200975605842*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     RowBox[{"kz", " ", 
      SubscriptBox["Ez", "\<\"i+1/2\"\>"], " ", 
      SubscriptBox["n", "\[Phi]"]}], 
     SubscriptBox["r", "\<\"i+1/2\"\>"]]}], "-", 
   FractionBox[
    RowBox[{
     SubscriptBox["Eth", "\<\"i+3/2\"\>"], " ", 
     SubscriptBox["r", "\<\"i+3/2\"\>"]}], 
    RowBox[{
     SubscriptBox["r", "\<\"i+1\"\>"], " ", 
     SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]], "-", 
   FractionBox[
    RowBox[{
     SubscriptBox["Eth", "\<\"i-1/2\"\>"], " ", 
     SubscriptBox["r", "\<\"i-1/2\"\>"]}], 
    RowBox[{
     SubscriptBox["r", "i"], " ", 
     SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]], "+", 
   FractionBox[
    RowBox[{"\[ImaginaryI]", " ", 
     SubscriptBox["Er", "\<\"i+1\"\>"], " ", 
     SubscriptBox["n", "\[Phi]"]}], 
    RowBox[{
     SubscriptBox["r", "\<\"i+1\"\>"], " ", 
     SubscriptBox["\[CapitalDelta]", "r"]}]], "-", 
   FractionBox[
    RowBox[{"\[ImaginaryI]", " ", 
     SubscriptBox["Er", "i"], " ", 
     SubscriptBox["n", "\[Phi]"]}], 
    RowBox[{
     SubscriptBox["r", "i"], " ", 
     SubscriptBox["\[CapitalDelta]", "r"]}]], "+", 
   RowBox[{
    SubscriptBox["Eth", "\<\"i+1/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["kz", "2"], "+", 
      FractionBox[
       SubscriptBox["r", "\<\"i+1/2\"\>"], 
       RowBox[{
        SubscriptBox["r", "\<\"i+1\"\>"], " ", 
        SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]], "+", 
      FractionBox[
       SubscriptBox["r", "\<\"i+1/2\"\>"], 
       RowBox[{
        SubscriptBox["r", "i"], " ", 
        SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]], "-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["\[Omega]", "2"], " ", 
        SubsuperscriptBox["\[Epsilon]", "\<\"i+1/2\"\>", 
         "\[Theta]\[Theta]"]}], 
       SuperscriptBox["c", "2"]]}], ")"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.4692009776780148`*^9, 3.469289328968992*^9, 
  3.469298008453195*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"lhsCentralDiffZ", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"centralDiffCCEzCons", "-", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Omega]", "^", "2"}], "/", 
       RowBox[{"c", "^", "2"}]}], " ", 
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"+", 
         SubsuperscriptBox["\[Epsilon]", "\"\<i+1/2\>\"", "zz"]}], 
        SubscriptBox["Ez", "\"\<i+1/2\>\""]}], "\[IndentingNewLine]", 
       ")"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["Er", "\"\<i-1\>\""], ",", 
      SubscriptBox["Er", "i"], ",", 
      SubscriptBox["Er", "\"\<i+1\>\""], ",", 
      SubscriptBox["Eth", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+3/2\>\""]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.469201205372305*^9, 3.469201205918182*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     RowBox[{"kz", " ", 
      SubscriptBox["Eth", "\<\"i+1/2\"\>"], " ", 
      SubscriptBox["n", "\[Phi]"]}], 
     SubscriptBox["r", "\<\"i+1/2\"\>"]]}], "-", 
   FractionBox[
    RowBox[{
     SubscriptBox["Ez", "\<\"i+3/2\"\>"], " ", 
     SubscriptBox["r", "\<\"i+1\"\>"]}], 
    RowBox[{
     SubscriptBox["r", "\<\"i+1/2\"\>"], " ", 
     SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]], "-", 
   FractionBox[
    RowBox[{
     SubscriptBox["Ez", "\<\"i-1/2\"\>"], " ", 
     SubscriptBox["r", "i"]}], 
    RowBox[{
     SubscriptBox["r", "\<\"i+1/2\"\>"], " ", 
     SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]], "+", 
   FractionBox[
    RowBox[{"\[ImaginaryI]", " ", "kz", " ", 
     SubscriptBox["Er", "\<\"i+1\"\>"], " ", 
     SubscriptBox["r", "\<\"i+1\"\>"]}], 
    RowBox[{
     SubscriptBox["r", "\<\"i+1/2\"\>"], " ", 
     SubscriptBox["\[CapitalDelta]", "r"]}]], "-", 
   FractionBox[
    RowBox[{"\[ImaginaryI]", " ", "kz", " ", 
     SubscriptBox["Er", "i"], " ", 
     SubscriptBox["r", "i"]}], 
    RowBox[{
     SubscriptBox["r", "\<\"i+1/2\"\>"], " ", 
     SubscriptBox["\[CapitalDelta]", "r"]}]], "+", 
   RowBox[{
    SubscriptBox["Ez", "\<\"i+1/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       SubsuperscriptBox["n", "\[Phi]", "2"], 
       SubsuperscriptBox["r", "\<\"i+1/2\"\>", "2"]], "+", 
      FractionBox[
       RowBox[{
        SubscriptBox["r", "\<\"i+1\"\>"], "+", 
        SubscriptBox["r", "i"]}], 
       RowBox[{
        SubscriptBox["r", "\<\"i+1/2\"\>"], " ", 
        SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]], "-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["\[Omega]", "2"], " ", 
        SubsuperscriptBox["\[Epsilon]", "\<\"i+1/2\"\>", "zz"]}], 
       SuperscriptBox["c", "2"]]}], ")"}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.469201206843419*^9, {3.469287710711307*^9, 3.469287734751236*^9}, 
   3.469288147493711*^9, 3.46928933142992*^9, 3.4692980111752853`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["left boundary eqns", "Section",
 CellChangeTimes->{{3.469381447634151*^9, 3.469381451937461*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"centralDiffCCEthCons", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "kz"}], " ", 
       RowBox[{
        SubscriptBox["n", "\[Phi]"], "/", 
        SubscriptBox["r", "\"\<i+1/2\>\""]}], 
       SubscriptBox["Ez", "\"\<i+1/2\>\""]}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"kz", "^", "2"}], " ", 
       SubscriptBox["Eth", "\"\<i+1/2\>\""]}], "\[IndentingNewLine]", "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SubscriptBox["r", "\"\<i+3/2\>\""], 
          RowBox[{
           SubscriptBox["Eth", "\"\<i+3/2\>\""], "/", 
           SubscriptBox["r", "\"\<i+1\>\""]}]}], "-", 
         RowBox[{
          SubscriptBox["r", "\"\<i+1/2\>\""], 
          RowBox[{
           SubscriptBox["Eth", "\"\<i+1/2\>\""], "/", 
           SubscriptBox["r", "\"\<i+1\>\""]}]}], "-", 
         RowBox[{
          SubscriptBox["r", "\"\<i+1/2\>\""], 
          RowBox[{
           SubscriptBox["Eth", "\"\<i+1/2\>\""], "/", 
           SubscriptBox["r", "i"]}]}], "+", 
         RowBox[{
          SubscriptBox["r", "\"\<i-1/2\>\""], 
          RowBox[{
           SubscriptBox["Eth", "\"\<i-1/2\>\""], "/", 
           SubscriptBox["r", "i"]}]}]}], ")"}], "/", 
       RowBox[{
        SubscriptBox["\[CapitalDelta]", "r"], "^", "2"}]}], 
      "\[IndentingNewLine]", "+", 
      RowBox[{"I", " ", 
       RowBox[{
        SubscriptBox["n", "\[Phi]"], "/", 
        SubscriptBox["\[CapitalDelta]", "r"]}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SubscriptBox["Er", "\"\<i+1\>\""], "/", 
          SubscriptBox["r", "\"\<i+1\>\""]}], "-", 
         RowBox[{
          SubscriptBox["Er", "i"], "/", 
          SubscriptBox["r", "i"]}]}], ")"}]}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["Er", "\"\<i-1\>\""], ",", 
      SubscriptBox["Er", "i"], ",", 
      SubscriptBox["Er", "\"\<i+1\>\""], ",", 
      SubscriptBox["Eth", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+3/2\>\""]}], "}"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     RowBox[{"kz", " ", 
      SubscriptBox["Ez", "\<\"i+1/2\"\>"], " ", 
      SubscriptBox["n", "\[Phi]"]}], 
     SubscriptBox["r", "\<\"i+1/2\"\>"]]}], "+", 
   RowBox[{
    SubscriptBox["Eth", "\<\"i+1/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["kz", "2"], "+", 
      FractionBox[
       SubscriptBox["r", "\<\"i+1/2\"\>"], 
       RowBox[{
        SubscriptBox["r", "\<\"i+1\"\>"], " ", 
        SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]], "+", 
      FractionBox[
       SubscriptBox["r", "\<\"i+1/2\"\>"], 
       RowBox[{
        SubscriptBox["r", "i"], " ", 
        SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]]}], ")"}]}], "-", 
   FractionBox[
    RowBox[{
     SubscriptBox["Eth", "\<\"i+3/2\"\>"], " ", 
     SubscriptBox["r", "\<\"i+3/2\"\>"]}], 
    RowBox[{
     SubscriptBox["r", "\<\"i+1\"\>"], " ", 
     SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]], "-", 
   FractionBox[
    RowBox[{
     SubscriptBox["Eth", "\<\"i-1/2\"\>"], " ", 
     SubscriptBox["r", "\<\"i-1/2\"\>"]}], 
    RowBox[{
     SubscriptBox["r", "i"], " ", 
     SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]], "+", 
   FractionBox[
    RowBox[{"\[ImaginaryI]", " ", 
     SubscriptBox["Er", "\<\"i+1\"\>"], " ", 
     SubscriptBox["n", "\[Phi]"]}], 
    RowBox[{
     SubscriptBox["r", "\<\"i+1\"\>"], " ", 
     SubscriptBox["\[CapitalDelta]", "r"]}]], "-", 
   FractionBox[
    RowBox[{"\[ImaginaryI]", " ", 
     SubscriptBox["Er", "i"], " ", 
     SubscriptBox["n", "\[Phi]"]}], 
    RowBox[{
     SubscriptBox["r", "i"], " ", 
     SubscriptBox["\[CapitalDelta]", "r"]}]]}], "}"}]], "Output",
 CellChangeTimes->{3.4693815366553173`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"lhsCentralDiffTh", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"centralDiffCCEthCons", "-", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Omega]", "^", "2"}], "/", 
       RowBox[{"c", "^", "2"}]}], " ", 
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["r", "i"], 
            SubsuperscriptBox["\[Epsilon]", "i", "\[Theta]r"], 
            SubscriptBox["Er", "i"]}], "+", 
           RowBox[{
            SubscriptBox["r", "\"\<i+1\>\""], 
            SubsuperscriptBox["\[Epsilon]", "\"\<i+1\>\"", "\[Theta]r"], 
            SubscriptBox["Er", "\"\<i+1\>\""]}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["r", "\"\<i+1/2\>\""], "2"}], ")"}]}], 
        "\[IndentingNewLine]", "+", 
        RowBox[{
         SubsuperscriptBox["\[Epsilon]", "\"\<i+1/2\>\"", "\[Theta]\[Theta]"], 
         SubscriptBox["Eth", "\"\<i+1/2\>\""]}], "\[IndentingNewLine]", "+", 
        RowBox[{
         SubsuperscriptBox["\[Epsilon]", "\"\<i+1/2\>\"", "\[Theta]z"], 
         SubscriptBox["Ez", "\"\<i+1/2\>\""]}]}], "\[IndentingNewLine]", 
       ")"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["Er", "\"\<i-1\>\""], ",", 
      SubscriptBox["Er", "i"], ",", 
      SubscriptBox["Er", "\"\<i+1\>\""], ",", 
      SubscriptBox["Eth", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+3/2\>\""]}], "}"}], ",", "Simplify"}], 
   "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      SubscriptBox["Eth", "\<\"i+3/2\"\>"], " ", 
      SubscriptBox["r", "\<\"i+3/2\"\>"]}], 
     RowBox[{
      SubscriptBox["r", "\<\"i+1\"\>"], " ", 
      SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]]}], "-", 
   FractionBox[
    RowBox[{
     SubscriptBox["Eth", "\<\"i-1/2\"\>"], " ", 
     SubscriptBox["r", "\<\"i-1/2\"\>"]}], 
    RowBox[{
     SubscriptBox["r", "i"], " ", 
     SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]], "+", 
   RowBox[{
    SubscriptBox["Er", "\<\"i+1\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", 
        SubscriptBox["n", "\[Phi]"]}], 
       RowBox[{
        SubscriptBox["r", "\<\"i+1\"\>"], " ", 
        SubscriptBox["\[CapitalDelta]", "r"]}]], "-", 
      FractionBox[
       RowBox[{"0.19766548602178405`", " ", 
        SubscriptBox["r", "\<\"i+1\"\>"], " ", 
        SubsuperscriptBox["\[Epsilon]", "\<\"i+1\"\>", "\[Theta]r"]}], 
       SubscriptBox["r", "\<\"i+1/2\"\>"]]}], ")"}]}], "+", 
   RowBox[{
    SubscriptBox["Ez", "\<\"i+1/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{"kz", " ", 
         SubscriptBox["n", "\[Phi]"]}], 
        SubscriptBox["r", "\<\"i+1/2\"\>"]]}], "-", 
      RowBox[{"0.3953309720435681`", " ", 
       SubsuperscriptBox["\[Epsilon]", "\<\"i+1/2\"\>", "\[Theta]z"]}]}], 
     ")"}]}], "+", 
   RowBox[{
    SubscriptBox["Eth", "\<\"i+1/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["kz", "2"], "+", 
      FractionBox[
       SubscriptBox["r", "\<\"i+1/2\"\>"], 
       RowBox[{
        SubscriptBox["r", "\<\"i+1\"\>"], " ", 
        SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]], "+", 
      FractionBox[
       SubscriptBox["r", "\<\"i+1/2\"\>"], 
       RowBox[{
        SubscriptBox["r", "i"], " ", 
        SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]], "-", 
      RowBox[{"0.3953309720435681`", " ", 
       SubsuperscriptBox["\[Epsilon]", "\<\"i+1/2\"\>", 
        "\[Theta]\[Theta]"]}]}], ")"}]}], "+", 
   RowBox[{
    SubscriptBox["Er", "i"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", 
         SubscriptBox["n", "\[Phi]"]}], 
        RowBox[{
         SubscriptBox["r", "i"], " ", 
         SubscriptBox["\[CapitalDelta]", "r"]}]]}], "-", 
      FractionBox[
       RowBox[{"0.19766548602178405`", " ", 
        SubscriptBox["r", "i"], " ", 
        SubsuperscriptBox["\[Epsilon]", "i", "\[Theta]r"]}], 
       SubscriptBox["r", "\<\"i+1/2\"\>"]]}], ")"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.469381517987337*^9, 3.469381540228685*^9}}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{786, 795},
WindowMargins->{{47, Automatic}, {Automatic, 0}},
PrintingCopies->1,
PrintingPageRange->{1, Automatic},
PrintingOptions->{"PaperOrientation"->"Portrait",
"PrintCellBrackets"->True,
"PrintMultipleHorizontalPages"->False,
"PrintRegistrationMarks"->False,
"PrintingMargins"->{{54, 54}, {72, 72}}},
ShowSelection->True,
Magnification->1.25,
FrontEndVersion->"7.0 for Mac OS X x86 (32-bit) (November 10, 2008)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[422, 15, 2949, 76, 224, "Input"],
Cell[3374, 93, 2774, 79, 199, "Output"]
}, Open  ]],
Cell[6163, 175, 92, 1, 33, "Input"],
Cell[CellGroupData[{
Cell[6280, 180, 190, 2, 83, "Section"],
Cell[CellGroupData[{
Cell[6495, 186, 1001, 29, 72, "Input"],
Cell[7499, 217, 192, 3, 33, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7728, 225, 1120, 33, 72, "Input"],
Cell[8851, 260, 120, 2, 33, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9008, 267, 1040, 31, 72, "Input"],
Cell[10051, 300, 146, 2, 33, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[10246, 308, 120, 1, 83, "Section"],
Cell[10369, 311, 1544, 45, 72, "Input"],
Cell[CellGroupData[{
Cell[11938, 360, 869, 19, 33, "Input"],
Cell[12810, 381, 214, 4, 33, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13061, 390, 849, 21, 33, "Input"],
Cell[13913, 413, 338, 5, 33, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14288, 423, 729, 20, 33, "Input"],
Cell[15020, 445, 238, 3, 33, "Output"]
}, Open  ]],
Cell[15273, 451, 94, 1, 33, "Input"],
Cell[CellGroupData[{
Cell[15392, 456, 546, 10, 33, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[15941, 468, 735, 17, 203, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[16679, 487, 2012, 49, 468, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[18694, 538, 814, 21, 218, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[19511, 561, 1851, 44, 493, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[21365, 607, 692, 17, 218, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[22060, 626, 1833, 47, 491, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[23896, 675, 848, 25, 262, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Closed]],
Cell[CellGroupData[{
Cell[24781, 705, 3345, 76, 159, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.}],
Cell[28129, 783, 1683, 45, 281, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10001.}],
Cell[29815, 830, 3102, 80, 696, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.}],
Cell[32920, 912, 1932, 57, 457, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10001.}],
Cell[34855, 971, 2967, 78, 696, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.}],
Cell[37825, 1051, 1681, 51, 468, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10001.}]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[39555, 1108, 145, 1, 83, "Section"],
Cell[CellGroupData[{
Cell[39725, 1113, 2601, 69, 131, "Input"],
Cell[42329, 1184, 2057, 56, 118, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[44423, 1245, 2376, 64, 169, "Input"],
Cell[46802, 1311, 1897, 54, 114, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[48736, 1370, 2022, 53, 150, "Input"],
Cell[50761, 1425, 1402, 37, 119, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[52212, 1468, 101, 1, 83, "Section"],
Cell[CellGroupData[{
Cell[52338, 1473, 2526, 59, 160, "Input"],
Cell[54867, 1534, 3192, 90, 182, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[58096, 1629, 2008, 48, 165, "Input"],
Cell[60107, 1679, 3218, 93, 172, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[63362, 1777, 1954, 47, 162, "Input"],
Cell[65319, 1826, 2961, 84, 173, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[68329, 1916, 100, 1, 83, "Section"],
Cell[CellGroupData[{
Cell[68454, 1921, 2817, 73, 167, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[71274, 1996, 1243, 33, 227, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[72520, 2031, 3748, 98, 762, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[76271, 2131, 1854, 49, 262, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[78128, 2182, 3685, 97, 745, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[81816, 2281, 1634, 44, 262, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[83453, 2327, 1287, 33, 228, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[84743, 2362, 1387, 38, 228, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[86133, 2402, 1297, 33, 235, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[87433, 2437, 1943, 55, 457, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[89379, 2494, 1548, 37, 370, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[90930, 2533, 1794, 50, 262, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[92727, 2585, 3513, 89, 696, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[96243, 2676, 2427, 68, 415, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[98673, 2746, 3438, 90, 862, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[102114, 2838, 2080, 61, 415, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[104197, 2901, 1888, 45, 457, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[106088, 2948, 3376, 99, 640, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[109467, 3049, 1684, 42, 457, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[111154, 3093, 3005, 91, 633, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[114162, 3186, 2637, 69, 543, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[116802, 3257, 1151, 33, 227, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[117956, 3292, 1292, 34, 300, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[119251, 3328, 1343, 38, 228, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[120597, 3368, 3343, 87, 696, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[123943, 3457, 2136, 63, 457, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[126082, 3522, 1896, 46, 457, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[127981, 3570, 3151, 94, 678, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[131135, 3666, 3380, 88, 862, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[134518, 3756, 1930, 58, 415, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[136451, 3816, 1811, 45, 457, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[138265, 3863, 2939, 89, 633, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[141207, 3954, 3515, 94, 762, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[144725, 4050, 1544, 45, 262, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[146272, 4097, 1250, 33, 306, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[147525, 4132, 1741, 51, 457, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[149269, 4185, 3410, 93, 745, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[152682, 4280, 1406, 41, 262, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[154091, 4323, 1448, 36, 370, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[155542, 4361, 1623, 48, 262, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[157168, 4411, 2685, 70, 651, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[159856, 4483, 987, 28, 228, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[160846, 4513, 1722, 46, 387, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[162571, 4561, 1672, 49, 238, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[164246, 4612, 2591, 69, 651, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[166840, 4683, 870, 26, 275, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[167713, 4711, 1847, 47, 476, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[169563, 4760, 1685, 51, 327, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[171297, 4817, 112, 1, 83, "Section"],
Cell[CellGroupData[{
Cell[171434, 4822, 4296, 100, 205, "Input"],
Cell[175733, 4924, 659, 12, 55, "Output"],
Cell[176395, 4938, 3078, 88, 222, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[179522, 5032, 105, 1, 83, "Section"],
Cell[CellGroupData[{
Cell[179652, 5037, 978, 24, 110, "Input"],
Cell[180633, 5063, 1533, 42, 119, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[182203, 5110, 1084, 28, 114, "Input"],
Cell[183290, 5140, 2011, 59, 116, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[185338, 5204, 1035, 26, 111, "Input"],
Cell[186376, 5232, 2054, 58, 119, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[188479, 5296, 103, 1, 83, "Section"],
Cell[CellGroupData[{
Cell[188607, 5301, 2310, 63, 169, "Input"],
Cell[190920, 5366, 1751, 52, 114, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[192708, 5423, 1743, 44, 206, "Input"],
Cell[194454, 5469, 2751, 79, 275, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)

