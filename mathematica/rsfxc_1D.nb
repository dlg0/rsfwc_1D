(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[         0,          0]
NotebookDataLength[    168615,       4897]
NotebookOptionsPosition[    163421,       4716]
NotebookOutlinePosition[    163760,       4731]
CellTagsIndexPosition[    163717,       4728]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{"\[Theta]", ":=", 
  RowBox[{"ArcTan", "[", 
   RowBox[{
    RowBox[{"Sqrt", "[", 
     RowBox[{
      RowBox[{"kR", "^", "2"}], "+", 
      RowBox[{"kz", "^", "2"}]}], "]"}], ",", 
    RowBox[{"kPhi", "^", "2"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"k", ":=", 
  RowBox[{"Sqrt", " ", "[", " ", 
   RowBox[{
    RowBox[{"kR", "^", "2"}], "+", 
    RowBox[{"kPhi", "^", "2"}], "+", 
    RowBox[{"nz", "^", "2"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"n", ":=", 
  RowBox[{"k", " ", 
   RowBox[{"c", " ", "/", " ", "\[Omega]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"coldDispersionMat", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"S", "-", 
        RowBox[{
         RowBox[{"n", "^", "2"}], " ", 
         RowBox[{
          RowBox[{"Cos", "[", "\[Theta]", "]"}], "^", "2"}]}]}], ",", 
       RowBox[{
        RowBox[{"-", "I"}], " ", "D"}], ",", " ", 
       RowBox[{
        RowBox[{"n", "^", "2"}], " ", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}], 
        RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"I", " ", "D"}], ",", " ", 
       RowBox[{"D", "-", 
        RowBox[{"n", "^", "2"}]}], ",", " ", "0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"n", "^", "2"}], " ", 
        RowBox[{"Cos", "[", "\[Theta]", "]"}], 
        RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", " ", "0", ",", " ", 
       RowBox[{"P", "-", 
        RowBox[{
         RowBox[{"n", "^", "2"}], " ", 
         RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}]}], "}"}]}], "}"}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.467560402580155*^9, 3.4675605596550817`*^9}, {
  3.4675608810944777`*^9, 3.4675609000953493`*^9}, {3.4675609400680647`*^9, 
  3.467560949983992*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"coldDispersionEqn", "=", 
  RowBox[{
   RowBox[{"Simplify", "[", 
    RowBox[{"Det", "[", "coldDispersionMat", "]"}], "]"}], "\[Equal]", 
   "0"}]}]], "Input",
 CellChangeTimes->{{3.467561011244174*^9, 3.467561060724011*^9}, {
  3.46756110183291*^9, 3.467561102219039*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["D", "2"]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"D", "-", 
         FractionBox[
          RowBox[{
           SuperscriptBox["c", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["kPhi", "2"], "+", 
             SuperscriptBox["kR", "2"], "+", 
             SuperscriptBox["nz", "2"]}], ")"}]}], 
          SuperscriptBox["\[Omega]", "2"]]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"S", "-", 
         FractionBox[
          RowBox[{
           SuperscriptBox["c", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["kPhi", "2"], "+", 
             SuperscriptBox["kR", "2"], "+", 
             SuperscriptBox["nz", "2"]}], ")"}], " ", 
           SuperscriptBox[
            RowBox[{"Cos", "[", 
             RowBox[{"ArcTan", "[", 
              RowBox[{
               SqrtBox[
                RowBox[{
                 SuperscriptBox["kR", "2"], "+", 
                 SuperscriptBox["kz", "2"]}]], ",", 
               SuperscriptBox["kPhi", "2"]}], "]"}], "]"}], "2"]}], 
          SuperscriptBox["\[Omega]", "2"]]}], ")"}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"P", "-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["c", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["kPhi", "2"], "+", 
          SuperscriptBox["kR", "2"], "+", 
          SuperscriptBox["nz", "2"]}], ")"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"ArcTan", "[", 
          RowBox[{
           SqrtBox[
            RowBox[{
             SuperscriptBox["kR", "2"], "+", 
             SuperscriptBox["kz", "2"]}]], ",", 
           SuperscriptBox["kPhi", "2"]}], "]"}], "]"}]}], 
       SuperscriptBox["\[Omega]", "2"]]}], ")"}]}], "+", 
   FractionBox[
    RowBox[{
     SuperscriptBox["c", "4"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["kPhi", "2"], "+", 
        SuperscriptBox["kR", "2"], "+", 
        SuperscriptBox["nz", "2"]}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["c", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["kPhi", "2"], "+", 
          SuperscriptBox["kR", "2"], "+", 
          SuperscriptBox["nz", "2"]}], ")"}]}], "-", 
       RowBox[{"D", " ", 
        SuperscriptBox["\[Omega]", "2"]}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"Sin", "[", 
       RowBox[{"2", " ", 
        RowBox[{"ArcTan", "[", 
         RowBox[{
          SqrtBox[
           RowBox[{
            SuperscriptBox["kR", "2"], "+", 
            SuperscriptBox["kz", "2"]}]], ",", 
          SuperscriptBox["kPhi", "2"]}], "]"}]}], "]"}], "2"]}], 
    RowBox[{"4", " ", 
     SuperscriptBox["\[Omega]", "6"]}]]}], "\[Equal]", "0"}]], "Output",
 CellChangeTimes->{
  3.4675604847014*^9, {3.467560549574977*^9, 3.467560560784693*^9}, 
   3.4675609026879063`*^9, 3.4675609508412533`*^9, 3.4675610278588057`*^9, 
   3.467561062074854*^9, 3.4675611029794827`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{"coldDispersionEqn", ",", "kR"}], "]"}]], "Input",
 CellChangeTimes->{{3.467561108617193*^9, 3.4675611292021513`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Solve", "::", "\<\"tdep\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"\\!\\(\\*StyleBox[\\\"\\\\\\\"The equations appear to \
involve the variables to be solved for in an essentially non-algebraic way.\\\
\\\\\"\\\", \\\"MT\\\"]\\) \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/Solve/tdep\\\", ButtonNote -> \
\\\"Solve::tdep\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.4675611321618834`*^9}],

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["D", "2"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"D", "-", 
           FractionBox[
            RowBox[{
             SuperscriptBox["c", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["kPhi", "2"], "+", 
               SuperscriptBox["kR", "2"], "+", 
               SuperscriptBox["nz", "2"]}], ")"}]}], 
            SuperscriptBox["\[Omega]", "2"]]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"S", "-", 
           FractionBox[
            RowBox[{
             SuperscriptBox["c", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["kPhi", "2"], "+", 
               SuperscriptBox["kR", "2"], "+", 
               SuperscriptBox["nz", "2"]}], ")"}], " ", 
             SuperscriptBox[
              RowBox[{"Cos", "[", 
               RowBox[{"ArcTan", "[", 
                RowBox[{
                 SqrtBox[
                  RowBox[{
                   SuperscriptBox["kR", "2"], "+", 
                   SuperscriptBox["kz", "2"]}]], ",", 
                 SuperscriptBox["kPhi", "2"]}], "]"}], "]"}], "2"]}], 
            SuperscriptBox["\[Omega]", "2"]]}], ")"}]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"P", "-", 
        FractionBox[
         RowBox[{
          SuperscriptBox["c", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["kPhi", "2"], "+", 
            SuperscriptBox["kR", "2"], "+", 
            SuperscriptBox["nz", "2"]}], ")"}], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"ArcTan", "[", 
            RowBox[{
             SqrtBox[
              RowBox[{
               SuperscriptBox["kR", "2"], "+", 
               SuperscriptBox["kz", "2"]}]], ",", 
             SuperscriptBox["kPhi", "2"]}], "]"}], "]"}]}], 
         SuperscriptBox["\[Omega]", "2"]]}], ")"}]}], "+", 
     FractionBox[
      RowBox[{
       SuperscriptBox["c", "4"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["kPhi", "2"], "+", 
          SuperscriptBox["kR", "2"], "+", 
          SuperscriptBox["nz", "2"]}], ")"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["c", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["kPhi", "2"], "+", 
            SuperscriptBox["kR", "2"], "+", 
            SuperscriptBox["nz", "2"]}], ")"}]}], "-", 
         RowBox[{"D", " ", 
          SuperscriptBox["\[Omega]", "2"]}]}], ")"}], " ", 
       SuperscriptBox[
        RowBox[{"Sin", "[", 
         RowBox[{"2", " ", 
          RowBox[{"ArcTan", "[", 
           RowBox[{
            SqrtBox[
             RowBox[{
              SuperscriptBox["kR", "2"], "+", 
              SuperscriptBox["kz", "2"]}]], ",", 
            SuperscriptBox["kPhi", "2"]}], "]"}]}], "]"}], "2"]}], 
      RowBox[{"4", " ", 
       SuperscriptBox["\[Omega]", "6"]}]]}], "\[Equal]", "0"}], ",", "kR"}], 
  "]"}]], "Output",
 CellChangeTimes->{3.467561132165556*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Needs", "[", "\"\<VectorAnalysis`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetCoordinates", "[", "Cylindrical", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ExpVar", ":=", 
  RowBox[{"Exp", "[", 
   RowBox[{"I", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"nPhi", "*", "Ttheta"}], "+", 
      RowBox[{"kz", "*", "Zz"}]}], ")"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"EField", ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"Er", "[", "Rr", "]"}], "*", "ExpVar"}], ",", 
    RowBox[{
     RowBox[{"Eth", "[", "Rr", "]"}], "*", "ExpVar"}], ",", 
    RowBox[{
     RowBox[{"Ez", "[", "Rr", "]"}], "*", "ExpVar"}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CurlE", "=", 
   RowBox[{"Curl", "[", "EField", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CurlCurlE", "=", 
   RowBox[{"Curl", "[", "CurlE", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"CurlE", "/", "ExpVar"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Er", "[", "Rr", "]"}], ",", 
      RowBox[{"Eth", "[", "Rr", "]"}], ",", 
      RowBox[{"Ez", "[", "Rr", "]"}]}], "}"}], ",", "Simplify"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"CCE", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"CurlCurlE", "/", "ExpVar"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Er", "[", "Rr", "]"}], ",", 
      RowBox[{"Eth", "[", "Rr", "]"}], ",", 
      RowBox[{"Ez", "[", "Rr", "]"}], ",", 
      RowBox[{
       SubscriptBox["\[PartialD]", "Rr"], 
       RowBox[{"Er", "[", "Rr", "]"}]}], ",", 
      RowBox[{
       SubscriptBox["\[PartialD]", "Rr"], 
       RowBox[{"Eth", "[", "Rr", "]"}]}], ",", 
      RowBox[{
       SubscriptBox["\[PartialD]", "Rr"], 
       RowBox[{"Ez", "[", "Rr", "]"}]}]}], "}"}], ",", "Simplify"}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.467030510801816*^9, 3.467030523420287*^9}, 
   3.4671126982647467`*^9, {3.467112994722177*^9, 3.4671131146028423`*^9}, {
   3.467113445088431*^9, 3.4671134621176434`*^9}, {3.4671136474538097`*^9, 
   3.467113698994087*^9}, {3.467113776583261*^9, 3.4671138482713013`*^9}, {
   3.467113922482967*^9, 3.467114078108139*^9}, {3.467114860474598*^9, 
   3.46711486268414*^9}, {3.467396216753858*^9, 3.467396239665422*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["kz", "2"], "+", 
       FractionBox[
        SuperscriptBox["nPhi", "2"], 
        SuperscriptBox["Rr", "2"]]}], ")"}], " ", 
     RowBox[{"Er", "[", "Rr", "]"}]}], "+", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", "nPhi", " ", 
      RowBox[{"Eth", "[", "Rr", "]"}]}], 
     SuperscriptBox["Rr", "2"]], "+", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", "nPhi", " ", 
      RowBox[{
       SuperscriptBox["Eth", "\[Prime]",
        MultilineFunction->None], "[", "Rr", "]"}]}], "Rr"], "+", 
    RowBox[{"\[ImaginaryI]", " ", "kz", " ", 
     RowBox[{
      SuperscriptBox["Ez", "\[Prime]",
       MultilineFunction->None], "[", "Rr", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", "nPhi", " ", 
       RowBox[{"Er", "[", "Rr", "]"}]}], 
      SuperscriptBox["Rr", "2"]]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["kz", "2"], "+", 
       FractionBox["1", 
        SuperscriptBox["Rr", "2"]]}], ")"}], " ", 
     RowBox[{"Eth", "[", "Rr", "]"}]}], "-", 
    FractionBox[
     RowBox[{"kz", " ", "nPhi", " ", 
      RowBox[{"Ez", "[", "Rr", "]"}]}], "Rr"], "+", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", "nPhi", " ", 
      RowBox[{
       SuperscriptBox["Er", "\[Prime]",
        MultilineFunction->None], "[", "Rr", "]"}]}], "Rr"], "-", 
    FractionBox[
     RowBox[{
      SuperscriptBox["Eth", "\[Prime]",
       MultilineFunction->None], "[", "Rr", "]"}], "Rr"], "-", 
    RowBox[{
     SuperscriptBox["Eth", "\[Prime]\[Prime]",
      MultilineFunction->None], "[", "Rr", "]"}]}], ",", 
   RowBox[{
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", "kz", " ", 
      RowBox[{"Er", "[", "Rr", "]"}]}], "Rr"], "-", 
    FractionBox[
     RowBox[{"kz", " ", "nPhi", " ", 
      RowBox[{"Eth", "[", "Rr", "]"}]}], "Rr"], "+", 
    FractionBox[
     RowBox[{
      SuperscriptBox["nPhi", "2"], " ", 
      RowBox[{"Ez", "[", "Rr", "]"}]}], 
     SuperscriptBox["Rr", "2"]], "+", 
    RowBox[{"\[ImaginaryI]", " ", "kz", " ", 
     RowBox[{
      SuperscriptBox["Er", "\[Prime]",
       MultilineFunction->None], "[", "Rr", "]"}]}], "-", 
    FractionBox[
     RowBox[{
      SuperscriptBox["Ez", "\[Prime]",
       MultilineFunction->None], "[", "Rr", "]"}], "Rr"], "-", 
    RowBox[{
     SuperscriptBox["Ez", "\[Prime]\[Prime]",
      MultilineFunction->None], "[", "Rr", "]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.467473691677279*^9, 3.4674737206849117`*^9}, 
   3.467479462892971*^9, 3.467558259359735*^9, 3.467638832912352*^9, 
   3.467719888071718*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"divE", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{"Div", "[", "EField", "]"}], "/", "ExpVar"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.467464631950495*^9, 3.467464643067532*^9}, {
  3.467464682769896*^9, 3.467464683951932*^9}, {3.4674655361661997`*^9, 
  3.46746554981322*^9}, {3.467465627134987*^9, 3.467465629522121*^9}, {
  3.4674795100887623`*^9, 3.46747951098778*^9}, {3.4674799893426123`*^9, 
  3.4674799911568727`*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"Er", "[", "Rr", "]"}], "+", 
   RowBox[{"\[ImaginaryI]", " ", "nPhi", " ", 
    RowBox[{"Eth", "[", "Rr", "]"}]}], "+", 
   RowBox[{"\[ImaginaryI]", " ", "kz", " ", "Rr", " ", 
    RowBox[{"Ez", "[", "Rr", "]"}]}], "+", 
   RowBox[{"Rr", " ", 
    RowBox[{
     SuperscriptBox["Er", "\[Prime]",
      MultilineFunction->None], "[", "Rr", "]"}]}]}], "Rr"]], "Output",
 CellChangeTimes->{
  3.467464645040159*^9, 3.467464684895516*^9, {3.467465539649313*^9, 
   3.467465550660543*^9}, 3.4674656301574383`*^9, 3.4674737358561583`*^9, 
   3.467479513559597*^9, 3.4674799919659147`*^9, 3.4675582631318607`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"finiteDiffDivE", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"divE", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Er", "[", "Rr", "]"}], "\[Rule]", 
        SubscriptBox["Er", "i"]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Eth", "[", "Rr", "]"}], "\[Rule]", 
        SubscriptBox["Eth", "i"]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Ez", "[", "Rr", "]"}], "\[Rule]", 
        SubscriptBox["Ez", "i"]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", "Rr"], 
         RowBox[{"Er", "[", "Rr", "]"}]}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            SubscriptBox["Er", "\"\<i-1\>\""]}], "+", 
           SubscriptBox["Er", "\"\<i+1\>\""]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"2", 
           SubscriptBox["\[CapitalDelta]", "r"]}], ")"}]}]}]}], "}"}]}], ",", 
    
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["Er", "\"\<i-1\>\""], ",", 
      SubscriptBox["Er", "i"], ",", 
      SubscriptBox["Er", "\"\<i+1\>\""], ",", 
      SubscriptBox["Eth", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Er", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Er", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Eth", "i"]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.467465638689001*^9, 3.467465740846663*^9}, {
  3.467466017121579*^9, 3.46746607352496*^9}, {3.46747510461122*^9, 
  3.467475169316496*^9}, {3.46747524646348*^9, 3.467475250157578*^9}, {
  3.467480051317449*^9, 3.467480056333741*^9}, {3.467480119622591*^9, 
  3.467480121853593*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   SubscriptBox["Er", "i"], "Rr"], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", "nPhi", " ", 
    SubscriptBox["Eth", "i"]}], "Rr"], "+", 
  RowBox[{"\[ImaginaryI]", " ", "kz", " ", 
   SubscriptBox["Ez", "i"]}], "-", 
  FractionBox[
   SubscriptBox["Er", "\<\"i-1\"\>"], 
   RowBox[{"2", " ", 
    SubscriptBox["\[CapitalDelta]", "r"]}]], "+", 
  FractionBox[
   SubscriptBox["Er", "\<\"i+1\"\>"], 
   RowBox[{"2", " ", 
    SubscriptBox["\[CapitalDelta]", "r"]}]]}]], "Output",
 CellChangeTimes->{
  3.467465700211741*^9, 3.46746574201748*^9, 3.467466075342485*^9, {
   3.4674751461071663`*^9, 3.467475170095726*^9}, 3.467475250966309*^9, 
   3.467480057937952*^9, 3.4674801225697603`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"finiteDiffDivE", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"divE", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Er", "[", "Rr", "]"}], "\[Rule]", 
        SubscriptBox["Er", "\"\<i+1/2\>\""]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Eth", "[", "Rr", "]"}], "\[Rule]", 
        SubscriptBox["Eth", "\"\<i+1/2\>\""]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Ez", "[", "Rr", "]"}], "\[Rule]", 
        SubscriptBox["Ez", "\"\<i+1/2\>\""]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", "Rr"], 
         RowBox[{"Er", "[", "Rr", "]"}]}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            SubscriptBox["Er", "i"]}], "+", 
           SubscriptBox["Er", "\"\<i+1\>\""]}], ")"}], "/", 
         SubscriptBox["\[CapitalDelta]", "r"]}]}]}], "}"}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["Er", "\"\<i-1\>\""], ",", 
      SubscriptBox["Er", "i"], ",", 
      SubscriptBox["Er", "\"\<i+1\>\""], ",", 
      SubscriptBox["Eth", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Er", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Er", "\"\<i+1/2\>\""]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.4674736576437807`*^9, 3.4674736745415983`*^9}, {
  3.467473901671974*^9, 3.4674739092072783`*^9}, {3.467473972328877*^9, 
  3.4674740689511623`*^9}, {3.467474299973078*^9, 3.467474313752681*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   SubscriptBox["Er", "\<\"i+1/2\"\>"], "Rr"], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", "nPhi", " ", 
    SubscriptBox["Eth", "\<\"i+1/2\"\>"]}], "Rr"], "+", 
  RowBox[{"\[ImaginaryI]", " ", "kz", " ", 
   SubscriptBox["Ez", "\<\"i+1/2\"\>"]}], "+", 
  FractionBox[
   SubscriptBox["Er", "\<\"i+1\"\>"], 
   SubscriptBox["\[CapitalDelta]", "r"]], "-", 
  FractionBox[
   SubscriptBox["Er", "i"], 
   SubscriptBox["\[CapitalDelta]", "r"]]}]], "Output",
 CellChangeTimes->{{3.467474030495983*^9, 3.467474070155527*^9}, 
   3.467474314490143*^9, 3.467474838925352*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"finiteDiffDivE", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"divE", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Er", "[", "Rr", "]"}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["Er", "i"], "+", 
           SubscriptBox["Er", "\"\<i+1\>\""]}], ")"}], "/", "2"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Eth", "[", "Rr", "]"}], "\[Rule]", 
        SubscriptBox["Eth", "\"\<i+1/2\>\""]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Ez", "[", "Rr", "]"}], "\[Rule]", 
        SubscriptBox["Ez", "\"\<i+1/2\>\""]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", "Rr"], 
         RowBox[{"Er", "[", "Rr", "]"}]}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            SubscriptBox["Er", "i"]}], "+", 
           SubscriptBox["Er", "\"\<i+1\>\""]}], ")"}], "/", 
         SubscriptBox["\[CapitalDelta]", "r"]}]}]}], "}"}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["Er", "\"\<i-1\>\""], ",", 
      SubscriptBox["Er", "i"], ",", 
      SubscriptBox["Er", "\"\<i+1\>\""], ",", 
      SubscriptBox["Eth", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Er", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Er", "\"\<i+1/2\>\""]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.467558271762272*^9, 3.4675582914407597`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", "nPhi", " ", 
    SubscriptBox["Eth", "\<\"i+1/2\"\>"]}], "Rr"], "+", 
  RowBox[{"\[ImaginaryI]", " ", "kz", " ", 
   SubscriptBox["Ez", "\<\"i+1/2\"\>"]}], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["Er", "i"], " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "2"], "-", 
      FractionBox["Rr", 
       SubscriptBox["\[CapitalDelta]", "r"]]}], ")"}]}], "Rr"], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["Er", "\<\"i+1\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "2"], "+", 
      FractionBox["Rr", 
       SubscriptBox["\[CapitalDelta]", "r"]]}], ")"}]}], "Rr"]}]], "Output",
 CellChangeTimes->{{3.467558266557085*^9, 3.4675582941542683`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"centralDiffCCER", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"CCE", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "/.", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Er", "[", "Rr", "]"}], "\[Rule]", 
        SubscriptBox["Er", "i"]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Eth", "[", "Rr", "]"}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["Eth", "\"\<i+1/2\>\""], "+", 
           SubscriptBox["Eth", "\"\<i-1/2\>\""]}], ")"}], "/", "2"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Ez", "[", "Rr", "]"}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["Ez", "\"\<i+1/2\>\""], "+", 
           SubscriptBox["Ez", "\"\<i-1/2\>\""]}], ")"}], "/", "2"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", "Rr"], 
         RowBox[{"Eth", "[", "Rr", "]"}]}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            SubscriptBox["Eth", "\"\<i-1/2\>\""]}], "+", 
           SubscriptBox["Eth", "\"\<i+1/2\>\""]}], ")"}], "/", 
         SubscriptBox["\[CapitalDelta]", "r"]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", "Rr"], 
         RowBox[{"Ez", "[", "Rr", "]"}]}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            SubscriptBox["Ez", "\"\<i-1/2\>\""]}], "+", 
           SubscriptBox["Ez", "\"\<i+1/2\>\""]}], ")"}], "/", 
         SubscriptBox["\[CapitalDelta]", "r"]}]}]}], "}"}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["Er", "\"\<i-1\>\""], ",", 
      SubscriptBox["Er", "i"], ",", 
      SubscriptBox["Er", "\"\<i+1\>\""], ",", 
      SubscriptBox["Eth", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+3/2\>\""]}], "}"}], ",", "Simplify"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.46711486696596*^9, 3.467114959908531*^9}, {
   3.46711502692426*^9, 3.467115039230502*^9}, {3.467115079855693*^9, 
   3.467115183938445*^9}, {3.467115217136676*^9, 3.467115344723304*^9}, {
   3.467115378264489*^9, 3.467115521585041*^9}, {3.467115552982044*^9, 
   3.467115585083452*^9}, {3.467115733690442*^9, 3.467115810223687*^9}, {
   3.467115949314406*^9, 3.467115966767949*^9}, {3.467116174392415*^9, 
   3.467116193584591*^9}, {3.46711624236598*^9, 3.467116273107946*^9}, {
   3.4671163157900667`*^9, 3.4671164597113743`*^9}, {3.46711649861541*^9, 
   3.467116501929596*^9}, {3.467116595046652*^9, 3.467116596723604*^9}, {
   3.467117001681385*^9, 3.467117053140646*^9}, {3.467117229942638*^9, 
   3.467117237069922*^9}, {3.467117319421308*^9, 3.467117321300304*^9}, 
   3.4671178373188057`*^9, {3.467120903290702*^9, 3.4671209106576967`*^9}, {
   3.4673962864841003`*^9, 3.4673962970708942`*^9}, 3.467721327119359*^9, {
   3.4677213720956917`*^9, 3.467721372705097*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["kz", "2"], "+", 
     FractionBox[
      SuperscriptBox["nPhi", "2"], 
      SuperscriptBox["Rr", "2"]]}], ")"}], " ", 
   SubscriptBox["Er", "i"]}], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", "nPhi", " ", 
    SubscriptBox["Eth", "\<\"i-1/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      FractionBox[
       RowBox[{"2", " ", "Rr"}], 
       SubscriptBox["\[CapitalDelta]", "r"]]}], ")"}]}], 
   RowBox[{"2", " ", 
    SuperscriptBox["Rr", "2"]}]], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", "kz", " ", 
    SubscriptBox["Ez", "\<\"i-1/2\"\>"]}], 
   SubscriptBox["\[CapitalDelta]", "r"]], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", "kz", " ", 
    SubscriptBox["Ez", "\<\"i+1/2\"\>"]}], 
   SubscriptBox["\[CapitalDelta]", "r"]], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", "nPhi", " ", 
    SubscriptBox["Eth", "\<\"i+1/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "Rr"}], "+", 
      SubscriptBox["\[CapitalDelta]", "r"]}], ")"}]}], 
   RowBox[{"2", " ", 
    SuperscriptBox["Rr", "2"], " ", 
    SubscriptBox["\[CapitalDelta]", "r"]}]]}]], "Output",
 CellChangeTimes->{
  3.4671162737509623`*^9, {3.4671163278171988`*^9, 3.467116377430644*^9}, 
   3.467116461325861*^9, 3.467116503350456*^9, 3.467116598361773*^9, {
   3.467117026602261*^9, 3.467117055072234*^9}, 3.467117243676259*^9, 
   3.4671173241509857`*^9, 3.467117838477056*^9, 3.467638847228546*^9, 
   3.467719893913512*^9, 3.467721343816605*^9, 3.4677213740203657`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"centralDiffCCETh", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"CCE", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "/.", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Er", "[", "Rr", "]"}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["Er", "i"], "+", 
           SubscriptBox["Er", "\"\<i+1\>\""]}], ")"}], "/", "2"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Eth", "[", "Rr", "]"}], "\[Rule]", 
        SubscriptBox["Eth", "\"\<i+1/2\>\""]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Ez", "[", "Rr", "]"}], "\[Rule]", 
        SubscriptBox["Ez", "\"\<i+1/2\>\""]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", "Rr"], 
         RowBox[{"Er", "[", "Rr", "]"}]}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            SubscriptBox["Er", "i"]}], "+", 
           SubscriptBox["Er", "\"\<i+1\>\""]}], ")"}], "/", 
         SubscriptBox["\[CapitalDelta]", "r"]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", "Rr"], 
         RowBox[{"Eth", "[", "Rr", "]"}]}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            SubscriptBox["Eth", "\"\<i-1/2\>\""]}], "+", 
           SubscriptBox["Eth", "\"\<i+3/2\>\""]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"2", " ", 
           SubscriptBox["\[CapitalDelta]", "r"]}], ")"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", 
          RowBox[{"Rr", ",", "Rr"}]], 
         RowBox[{"Eth", "[", "Rr", "]"}]}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["Eth", "\"\<i-1/2\>\""], "-", 
           RowBox[{"2", " ", 
            SubscriptBox["Eth", "\"\<i+1/2\>\""]}], "+", 
           SubscriptBox["Eth", "\"\<i+3/2\>\""]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["\[CapitalDelta]", "r"], "^", "2"}], ")"}]}]}]}], 
      "}"}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["Er", "\"\<i-1\>\""], ",", 
      SubscriptBox["Er", "i"], ",", 
      SubscriptBox["Er", "\"\<i+1\>\""], ",", 
      SubscriptBox["Eth", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+3/2\>\""]}], "}"}], ",", "Simplify"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.467117541690158*^9, 3.467117683942123*^9}, {
  3.46711782075948*^9, 3.4671178269913387`*^9}, {3.4673963018211317`*^9, 
  3.467396314982942*^9}, {3.467397444741393*^9, 3.467397448785953*^9}, {
  3.467721466565564*^9, 3.467721469948475*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{"kz", " ", "nPhi", " ", 
     SubscriptBox["Ez", "\<\"i+1/2\"\>"]}], "Rr"]}], "+", 
  RowBox[{
   SubscriptBox["Eth", "\<\"i+1/2\"\>"], " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["kz", "2"], "+", 
     FractionBox["1", 
      SuperscriptBox["Rr", "2"]], "+", 
     FractionBox["2", 
      SubsuperscriptBox["\[CapitalDelta]", "r", "2"]]}], ")"}]}], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", "nPhi", " ", 
    SubscriptBox["Er", "\<\"i+1\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "Rr"}], "-", 
      SubscriptBox["\[CapitalDelta]", "r"]}], ")"}]}], 
   RowBox[{"2", " ", 
    SuperscriptBox["Rr", "2"], " ", 
    SubscriptBox["\[CapitalDelta]", "r"]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["Eth", "\<\"i-1/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", "Rr"}], "+", 
      SubscriptBox["\[CapitalDelta]", "r"]}], ")"}]}], 
   RowBox[{"2", " ", "Rr", " ", 
    SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", "nPhi", " ", 
    SubscriptBox["Er", "i"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "Rr"}], "+", 
      SubscriptBox["\[CapitalDelta]", "r"]}], ")"}]}], 
   RowBox[{"2", " ", 
    SuperscriptBox["Rr", "2"], " ", 
    SubscriptBox["\[CapitalDelta]", "r"]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["Eth", "\<\"i+3/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{"2", "+", 
      FractionBox[
       SubscriptBox["\[CapitalDelta]", "r"], "Rr"]}], ")"}]}], 
   RowBox[{"2", " ", 
    SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]]}]], "Output",
 CellChangeTimes->{3.467117628972191*^9, 3.467117684879393*^9, 
  3.467117828685483*^9, 3.467397450540337*^9, 3.4677214708951597`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"centralDiffCCEZ", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"CCE", "[", 
      RowBox[{"[", "3", "]"}], "]"}], "/.", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Er", "[", "Rr", "]"}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["Er", "i"], "+", 
           SubscriptBox["Er", "\"\<i+1\>\""]}], ")"}], "/", "2"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Eth", "[", "Rr", "]"}], "\[Rule]", 
        SubscriptBox["Eth", "\"\<i+1/2\>\""]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Ez", "[", "Rr", "]"}], "\[Rule]", 
        SubscriptBox["Ez", "\"\<i+1/2\>\""]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", "Rr"], 
         RowBox[{"Er", "[", "Rr", "]"}]}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            SubscriptBox["Er", "i"]}], "+", 
           SubscriptBox["Er", "\"\<i+1\>\""]}], ")"}], "/", 
         SubscriptBox["\[CapitalDelta]", "r"]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", "Rr"], 
         RowBox[{"Ez", "[", "Rr", "]"}]}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            SubscriptBox["Ez", "\"\<i-1/2\>\""]}], "+", 
           SubscriptBox["Ez", "\"\<i+3/2\>\""]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"2", " ", 
           SubscriptBox["\[CapitalDelta]", "r"]}], ")"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", 
          RowBox[{"Rr", ",", "Rr"}]], 
         RowBox[{"Ez", "[", "Rr", "]"}]}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["Ez", "\"\<i-1/2\>\""], "-", 
           RowBox[{"2", " ", 
            SubscriptBox["Ez", "\"\<i+1/2\>\""]}], "+", 
           SubscriptBox["Ez", "\"\<i+3/2\>\""]}], ")"}], "/", 
         RowBox[{
          SubscriptBox["\[CapitalDelta]", "r"], "^", "2"}]}]}]}], "}"}]}], 
    ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["Er", "\"\<i-1\>\""], ",", 
      SubscriptBox["Er", "i"], ",", 
      SubscriptBox["Er", "\"\<i+1\>\""], ",", 
      SubscriptBox["Eth", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+3/2\>\""]}], "}"}], ",", "Simplify"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.467118235882575*^9, 3.4671182652263193`*^9}, {
  3.467396318377055*^9, 3.4673963295521603`*^9}, {3.467721491480073*^9, 
  3.467721504810925*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{"kz", " ", "nPhi", " ", 
     SubscriptBox["Eth", "\<\"i+1/2\"\>"]}], "Rr"]}], "+", 
  RowBox[{
   SubscriptBox["Ez", "\<\"i+1/2\"\>"], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      SuperscriptBox["nPhi", "2"], 
      SuperscriptBox["Rr", "2"]], "+", 
     FractionBox["2", 
      SubsuperscriptBox["\[CapitalDelta]", "r", "2"]]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", "kz", " ", 
   SubscriptBox["Er", "i"], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox["1", "Rr"], "-", 
     FractionBox["2", 
      SubscriptBox["\[CapitalDelta]", "r"]]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", "kz", " ", 
   SubscriptBox["Er", "\<\"i+1\"\>"], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox["1", "Rr"], "+", 
     FractionBox["2", 
      SubscriptBox["\[CapitalDelta]", "r"]]}], ")"}]}], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["Ez", "\<\"i-1/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", "Rr"}], "+", 
      SubscriptBox["\[CapitalDelta]", "r"]}], ")"}]}], 
   RowBox[{"2", " ", "Rr", " ", 
    SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["Ez", "\<\"i+3/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{"2", "+", 
      FractionBox[
       SubscriptBox["\[CapitalDelta]", "r"], "Rr"]}], ")"}]}], 
   RowBox[{"2", " ", 
    SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]]}]], "Output",
 CellChangeTimes->{3.467732628525804*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"centralDiffCCEzCons", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"I", " ", 
       RowBox[{"kz", " ", "/", " ", 
        SubscriptBox["r", "\"\<i+1/2\>\""]}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SubscriptBox["r", "\"\<i+1\>\""], 
          SubscriptBox["Er", "\"\<i+1\>\""]}], "-", 
         RowBox[{
          SubscriptBox["r", "i"], 
          SubscriptBox["Er", "i"]}]}], ")"}]}], "\[IndentingNewLine]", "-", 
      RowBox[{
       RowBox[{"1", "/", 
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["r", "\"\<i+1/2\>\""], 
          RowBox[{
           SubscriptBox["\[CapitalDelta]", "r"], "^", "2"}]}], ")"}]}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SubscriptBox["r", "\"\<i+1\>\""], 
          SubscriptBox["Ez", "\"\<i+3/2\>\""]}], "-", 
         RowBox[{
          RowBox[{"(", " ", 
           RowBox[{
            SubscriptBox["r", "\"\<i+1\>\""], "+", 
            SubscriptBox["r", "i"]}], ")"}], 
          SubscriptBox["Ez", "\"\<i+1/2\>\""]}], "+", 
         RowBox[{
          SubscriptBox["r", "i"], 
          SubscriptBox["Ez", "\"\<i-1/2\>\""]}]}], ")"}]}], 
      "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["n", "\[Phi]"], "^", "2"}], "/", 
        SubscriptBox["r", "\"\<i+1/2\>\""]}], 
       SubscriptBox["Ez", "\"\<i+1/2\>\""]}], "\[IndentingNewLine]", "-", 
      RowBox[{
       SubscriptBox["n", "\[Phi]"], "kz", " ", 
       SubscriptBox["Eth", "\"\<i+1/2\>\""]}]}], "}"}], "\[IndentingNewLine]",
     ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["Er", "\"\<i-1\>\""], ",", 
      SubscriptBox["Er", "i"], ",", 
      SubscriptBox["Er", "\"\<i+1\>\""], ",", 
      SubscriptBox["Eth", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+3/2\>\""]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.467730282987255*^9, 3.467730673272217*^9}, {
  3.4677325607270308`*^9, 3.467732587280139*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "kz"}], " ", 
    SubscriptBox["Eth", "\<\"i+1/2\"\>"], " ", 
    SubscriptBox["n", "\[Phi]"]}], "+", 
   FractionBox[
    RowBox[{"\[ImaginaryI]", " ", "kz", " ", 
     SubscriptBox["Er", "\<\"i+1\"\>"], " ", 
     SubscriptBox["r", "\<\"i+1\"\>"]}], 
    SubscriptBox["r", "\<\"i+1/2\"\>"]], "-", 
   FractionBox[
    RowBox[{"\[ImaginaryI]", " ", "kz", " ", 
     SubscriptBox["Er", "i"], " ", 
     SubscriptBox["r", "i"]}], 
    SubscriptBox["r", "\<\"i+1/2\"\>"]], "+", 
   RowBox[{
    SubscriptBox["Ez", "\<\"i+1/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       SubsuperscriptBox["n", "\[Phi]", "2"], 
       SubscriptBox["r", "\<\"i+1/2\"\>"]], "+", 
      FractionBox[
       RowBox[{
        SubscriptBox["r", "\<\"i+1\"\>"], "+", 
        SubscriptBox["r", "i"]}], 
       RowBox[{
        SubscriptBox["r", "\<\"i+1/2\"\>"], " ", 
        SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]]}], ")"}]}], "-", 
   FractionBox[
    RowBox[{
     SubscriptBox["Ez", "\<\"i+3/2\"\>"], " ", 
     SubscriptBox["r", "\<\"i+1\"\>"]}], 
    RowBox[{
     SubscriptBox["r", "\<\"i+1/2\"\>"], " ", 
     SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]], "-", 
   FractionBox[
    RowBox[{
     SubscriptBox["Ez", "\<\"i-1/2\"\>"], " ", 
     SubscriptBox["r", "i"]}], 
    RowBox[{
     SubscriptBox["r", "\<\"i+1/2\"\>"], " ", 
     SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]]}], "}"}]], "Output",
 CellChangeTimes->{
  3.467730585894215*^9, {3.467730622898634*^9, 3.467730674419004*^9}, 
   3.467732589485693*^9, 3.467732631028617*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"centralDiffCCEthCons", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "kz"}], " ", 
       RowBox[{
        SubscriptBox["n", "\[Phi]"], "/", 
        SubscriptBox["r", "\"\<i+1/2\>\""]}], 
       SubscriptBox["Ez", "\"\<i+1/2\>\""]}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"kz", "^", "2"}], " ", 
       SubscriptBox["Eth", "\"\<i+1/2\>\""]}], "\[IndentingNewLine]", "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SubscriptBox["r", "\"\<i+3/2\>\""], 
          RowBox[{
           SubscriptBox["Eth", "\"\<i+3/2\>\""], "/", 
           SubscriptBox["r", "\"\<i+1\>\""]}]}], "-", 
         RowBox[{
          SubscriptBox["r", "\"\<i+1/2\>\""], 
          RowBox[{
           SubscriptBox["Eth", "\"\<i+1/2\>\""], "/", 
           SubscriptBox["r", "\"\<i+1\>\""]}]}], "-", 
         RowBox[{
          SubscriptBox["r", "\"\<i+1/2\>\""], 
          RowBox[{
           SubscriptBox["Eth", "\"\<i+1/2\>\""], "/", 
           SubscriptBox["r", "i"]}]}], "+", 
         RowBox[{
          SubscriptBox["r", "\"\<i-1/2\>\""], 
          RowBox[{
           SubscriptBox["Eth", "\"\<i-1/2\>\""], "/", 
           SubscriptBox["r", "i"]}]}]}], ")"}], "/", 
       RowBox[{
        SubscriptBox["\[CapitalDelta]", "r"], "^", "2"}]}], 
      "\[IndentingNewLine]", "+", 
      RowBox[{"I", " ", 
       RowBox[{
        SubscriptBox["n", "\[Phi]"], "/", 
        SubscriptBox["\[CapitalDelta]", "r"]}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SubscriptBox["Er", "\"\<i+1\>\""], "/", 
          SubscriptBox["r", "\"\<i+1\>\""]}], "-", 
         RowBox[{
          SubscriptBox["Er", "i"], "/", 
          SubscriptBox["r", "i"]}]}], ")"}]}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["Er", "\"\<i-1\>\""], ",", 
      SubscriptBox["Er", "i"], ",", 
      SubscriptBox["Er", "\"\<i+1\>\""], ",", 
      SubscriptBox["Eth", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+3/2\>\""]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.467733850611885*^9, 3.467734141804339*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     RowBox[{"kz", " ", 
      SubscriptBox["Ez", "\<\"i+1/2\"\>"], " ", 
      SubscriptBox["n", "\[Phi]"]}], 
     SubscriptBox["r", "\<\"i+1/2\"\>"]]}], "+", 
   RowBox[{
    SubscriptBox["Eth", "\<\"i+1/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["kz", "2"], "+", 
      FractionBox[
       SubscriptBox["r", "\<\"i+1/2\"\>"], 
       RowBox[{
        SubscriptBox["r", "\<\"i+1\"\>"], " ", 
        SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]], "+", 
      FractionBox[
       SubscriptBox["r", "\<\"i+1/2\"\>"], 
       RowBox[{
        SubscriptBox["r", "i"], " ", 
        SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]]}], ")"}]}], "-", 
   FractionBox[
    RowBox[{
     SubscriptBox["Eth", "\<\"i+3/2\"\>"], " ", 
     SubscriptBox["r", "\<\"i+3/2\"\>"]}], 
    RowBox[{
     SubscriptBox["r", "\<\"i+1\"\>"], " ", 
     SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]], "-", 
   FractionBox[
    RowBox[{
     SubscriptBox["Eth", "\<\"i-1/2\"\>"], " ", 
     SubscriptBox["r", "\<\"i-1/2\"\>"]}], 
    RowBox[{
     SubscriptBox["r", "i"], " ", 
     SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]], "+", 
   FractionBox[
    RowBox[{"\[ImaginaryI]", " ", 
     SubscriptBox["Er", "\<\"i+1\"\>"], " ", 
     SubscriptBox["n", "\[Phi]"]}], 
    RowBox[{
     SubscriptBox["r", "\<\"i+1\"\>"], " ", 
     SubscriptBox["\[CapitalDelta]", "r"]}]], "-", 
   FractionBox[
    RowBox[{"\[ImaginaryI]", " ", 
     SubscriptBox["Er", "i"], " ", 
     SubscriptBox["n", "\[Phi]"]}], 
    RowBox[{
     SubscriptBox["r", "i"], " ", 
     SubscriptBox["\[CapitalDelta]", "r"]}]]}], "}"}]], "Output",
 CellChangeTimes->{{3.467734119495326*^9, 3.467734143097394*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"centralDiffCCErCons", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"I", " ", 
       RowBox[{
        SubscriptBox["n", "\[Phi]"], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SubscriptBox["r", "i"], "^", "2"}], " ", 
          SubscriptBox["\[CapitalDelta]", "r"]}], ")"}]}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SubscriptBox["r", "\"\<i+1/2\>\""], 
          SubscriptBox["Eth", "\"\<i+1/2\>\""]}], "-", 
         RowBox[{
          SubscriptBox["r", "\"\<i-1/2\>\""], 
          SubscriptBox["Eth", "\"\<i-1/2\>\""]}]}], ")"}]}], 
      "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["n", "\[Phi]"], "^", "2"}], "/", 
        SubscriptBox["r", "i"]}], 
       SubscriptBox["Er", "i"]}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"kz", "^", "2"}], " ", 
       SubscriptBox["Er", "i"]}], "\[IndentingNewLine]", "+", 
      RowBox[{"I", " ", "kz", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["Ez", "\"\<i+1/2\>\""], "-", 
          SubscriptBox["Ez", "\"\<i-1/2\>\""]}], ")"}], "/", 
        SubscriptBox["\[CapitalDelta]", "r"]}]}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["Er", "\"\<i-1\>\""], ",", 
      SubscriptBox["Er", "i"], ",", 
      SubscriptBox["Er", "\"\<i+1\>\""], ",", 
      SubscriptBox["Eth", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+3/2\>\""]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.467734537124938*^9, 3.467734604126576*^9}, {
  3.4677346609779663`*^9, 3.467734736981732*^9}, {3.467734777762794*^9, 
  3.467734848046871*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SubscriptBox["Er", "i"], " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["kz", "2"], "+", 
      FractionBox[
       SubsuperscriptBox["n", "\[Phi]", "2"], 
       SubscriptBox["r", "i"]]}], ")"}]}], "-", 
   FractionBox[
    RowBox[{"\[ImaginaryI]", " ", "kz", " ", 
     SubscriptBox["Ez", "\<\"i-1/2\"\>"]}], 
    SubscriptBox["\[CapitalDelta]", "r"]], "+", 
   FractionBox[
    RowBox[{"\[ImaginaryI]", " ", "kz", " ", 
     SubscriptBox["Ez", "\<\"i+1/2\"\>"]}], 
    SubscriptBox["\[CapitalDelta]", "r"]], "-", 
   FractionBox[
    RowBox[{"\[ImaginaryI]", " ", 
     SubscriptBox["Eth", "\<\"i-1/2\"\>"], " ", 
     SubscriptBox["n", "\[Phi]"], " ", 
     SubscriptBox["r", "\<\"i-1/2\"\>"]}], 
    RowBox[{
     SubsuperscriptBox["r", "i", "2"], " ", 
     SubscriptBox["\[CapitalDelta]", "r"]}]], "+", 
   FractionBox[
    RowBox[{"\[ImaginaryI]", " ", 
     SubscriptBox["Eth", "\<\"i+1/2\"\>"], " ", 
     SubscriptBox["n", "\[Phi]"], " ", 
     SubscriptBox["r", "\<\"i+1/2\"\>"]}], 
    RowBox[{
     SubsuperscriptBox["r", "i", "2"], " ", 
     SubscriptBox["\[CapitalDelta]", "r"]}]]}], "}"}]], "Output",
 CellChangeTimes->{3.467734811414145*^9, 3.467734849020029*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"lhsCentralDiffR", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"centralDiffCCErCons", "-", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Omega]", "^", "2"}], "/", 
       RowBox[{"c", "^", "2"}]}], " ", 
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         SubsuperscriptBox["\[Epsilon]", "i", "rr"], 
         SubscriptBox["Er", "i"]}], "\[IndentingNewLine]", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubsuperscriptBox["\[Epsilon]", "\"\<i-1/2\>\"", "r\[Theta]"], 
            SubscriptBox["Eth", "\"\<i-1/2\>\""]}], "+", 
           RowBox[{
            SubsuperscriptBox["\[Epsilon]", "\"\<i+1/2\>\"", "r\[Theta]"], 
            SubscriptBox["Eth", "\"\<i+1/2\>\""]}]}], ")"}], "/", "2"}], 
        "\[IndentingNewLine]", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubsuperscriptBox["\[Epsilon]", "\"\<i-1/2\>\"", "rz"], 
            SubscriptBox["Ez", "\"\<i-1/2\>\""]}], "+", 
           RowBox[{
            SubsuperscriptBox["\[Epsilon]", "\"\<i+1/2\>\"", "rz"], 
            SubscriptBox["Ez", "\"\<i+1/2\>\""]}]}], ")"}], "/", "2"}]}], 
       "\[IndentingNewLine]", ")"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["Er", "\"\<i-1\>\""], ",", 
      SubscriptBox["Er", "i"], ",", 
      SubscriptBox["Er", "\"\<i+1\>\""], ",", 
      SubscriptBox["Eth", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+3/2\>\""]}], "}"}], ",", "Simplify"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.467118539167849*^9, 3.4671187614832687`*^9}, {
  3.467118832411359*^9, 3.467118843337426*^9}, {3.467118951486752*^9, 
  3.4671190871795053`*^9}, {3.467721728243784*^9, 3.467721740976564*^9}, {
  3.467732733805286*^9, 3.4677327370117693`*^9}, {3.467734894748211*^9, 
  3.467734895751389*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SubscriptBox["Ez", "\<\"i-1/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "kz"}], 
        SubscriptBox["\[CapitalDelta]", "r"]]}], "-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["\[Omega]", "2"], " ", 
        SubsuperscriptBox["\[Epsilon]", "\<\"i-1/2\"\>", "rz"]}], 
       RowBox[{"2", " ", 
        SuperscriptBox["c", "2"]}]]}], ")"}]}], "+", 
   RowBox[{
    SubscriptBox["Eth", "\<\"i-1/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", 
         SubscriptBox["n", "\[Phi]"], " ", 
         SubscriptBox["r", "\<\"i-1/2\"\>"]}], 
        RowBox[{
         SubsuperscriptBox["r", "i", "2"], " ", 
         SubscriptBox["\[CapitalDelta]", "r"]}]]}], "-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["\[Omega]", "2"], " ", 
        SubsuperscriptBox["\[Epsilon]", "\<\"i-1/2\"\>", "r\[Theta]"]}], 
       RowBox[{"2", " ", 
        SuperscriptBox["c", "2"]}]]}], ")"}]}], "+", 
   RowBox[{
    SubscriptBox["Ez", "\<\"i+1/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", "kz"}], 
       SubscriptBox["\[CapitalDelta]", "r"]], "-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["\[Omega]", "2"], " ", 
        SubsuperscriptBox["\[Epsilon]", "\<\"i+1/2\"\>", "rz"]}], 
       RowBox[{"2", " ", 
        SuperscriptBox["c", "2"]}]]}], ")"}]}], "+", 
   RowBox[{
    SubscriptBox["Eth", "\<\"i+1/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", 
        SubscriptBox["n", "\[Phi]"], " ", 
        SubscriptBox["r", "\<\"i+1/2\"\>"]}], 
       RowBox[{
        SubsuperscriptBox["r", "i", "2"], " ", 
        SubscriptBox["\[CapitalDelta]", "r"]}]], "-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["\[Omega]", "2"], " ", 
        SubsuperscriptBox["\[Epsilon]", "\<\"i+1/2\"\>", "r\[Theta]"]}], 
       RowBox[{"2", " ", 
        SuperscriptBox["c", "2"]}]]}], ")"}]}], "+", 
   RowBox[{
    SubscriptBox["Er", "i"], " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["kz", "2"], "+", 
      FractionBox[
       SubsuperscriptBox["n", "\[Phi]", "2"], 
       SubscriptBox["r", "i"]], "-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["\[Omega]", "2"], " ", 
        SubsuperscriptBox["\[Epsilon]", "i", "rr"]}], 
       SuperscriptBox["c", "2"]]}], ")"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.467118763614427*^9, 3.467118844898011*^9, 
  3.4671190884653053`*^9, 3.467638852179057*^9, 3.467721744681933*^9, 
  3.467734896581316*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"lhsCentralDiffTh", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"centralDiffCCEthCons", "-", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Omega]", "^", "2"}], "/", 
       RowBox[{"c", "^", "2"}]}], " ", 
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubsuperscriptBox["\[Epsilon]", "i", "\[Theta]r"], 
            SubscriptBox["Er", "i"]}], "+", 
           RowBox[{
            SubsuperscriptBox["\[Epsilon]", "\"\<i+1\>\"", "\[Theta]r"], 
            SubscriptBox["Er", "\"\<i+1\>\""]}]}], ")"}], "/", "2"}], 
        "\[IndentingNewLine]", "+", 
        RowBox[{
         SubsuperscriptBox["\[Epsilon]", "\"\<i+1/2\>\"", "\[Theta]\[Theta]"], 
         SubscriptBox["Eth", "\"\<i+1/2\>\""]}], "\[IndentingNewLine]", "+", 
        RowBox[{
         SubsuperscriptBox["\[Epsilon]", "\"\<i+1/2\>\"", "\[Theta]z"], 
         SubscriptBox["Ez", "\"\<i+1/2\>\""]}]}], "\[IndentingNewLine]", 
       ")"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["Er", "\"\<i-1\>\""], ",", 
      SubscriptBox["Er", "i"], ",", 
      SubscriptBox["Er", "\"\<i+1\>\""], ",", 
      SubscriptBox["Eth", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+3/2\>\""]}], "}"}], ",", "Simplify"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.467119216181141*^9, 3.467119316858678*^9}, {
  3.4671194143861113`*^9, 3.467119429819611*^9}, {3.4677219365281887`*^9, 
  3.467721946857273*^9}, {3.467734192003886*^9, 3.467734200154168*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      SubscriptBox["Eth", "\<\"i+3/2\"\>"], " ", 
      SubscriptBox["r", "\<\"i+3/2\"\>"]}], 
     RowBox[{
      SubscriptBox["r", "\<\"i+1\"\>"], " ", 
      SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]]}], "-", 
   FractionBox[
    RowBox[{
     SubscriptBox["Eth", "\<\"i-1/2\"\>"], " ", 
     SubscriptBox["r", "\<\"i-1/2\"\>"]}], 
    RowBox[{
     SubscriptBox["r", "i"], " ", 
     SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]], "+", 
   RowBox[{
    SubscriptBox["Er", "\<\"i+1\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", 
        SubscriptBox["n", "\[Phi]"]}], 
       RowBox[{
        SubscriptBox["r", "\<\"i+1\"\>"], " ", 
        SubscriptBox["\[CapitalDelta]", "r"]}]], "-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["\[Omega]", "2"], " ", 
        SubsuperscriptBox["\[Epsilon]", "\<\"i+1\"\>", "\[Theta]r"]}], 
       RowBox[{"2", " ", 
        SuperscriptBox["c", "2"]}]]}], ")"}]}], "+", 
   RowBox[{
    SubscriptBox["Ez", "\<\"i+1/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{"kz", " ", 
         SubscriptBox["n", "\[Phi]"]}], 
        SubscriptBox["r", "\<\"i+1/2\"\>"]]}], "-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["\[Omega]", "2"], " ", 
        SubsuperscriptBox["\[Epsilon]", "\<\"i+1/2\"\>", "\[Theta]z"]}], 
       SuperscriptBox["c", "2"]]}], ")"}]}], "+", 
   RowBox[{
    SubscriptBox["Eth", "\<\"i+1/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["kz", "2"], "+", 
      FractionBox[
       SubscriptBox["r", "\<\"i+1/2\"\>"], 
       RowBox[{
        SubscriptBox["r", "\<\"i+1\"\>"], " ", 
        SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]], "+", 
      FractionBox[
       SubscriptBox["r", "\<\"i+1/2\"\>"], 
       RowBox[{
        SubscriptBox["r", "i"], " ", 
        SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]], "-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["\[Omega]", "2"], " ", 
        SubsuperscriptBox["\[Epsilon]", "\<\"i+1/2\"\>", 
         "\[Theta]\[Theta]"]}], 
       SuperscriptBox["c", "2"]]}], ")"}]}], "+", 
   RowBox[{
    SubscriptBox["Er", "i"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", 
         SubscriptBox["n", "\[Phi]"]}], 
        RowBox[{
         SubscriptBox["r", "i"], " ", 
         SubscriptBox["\[CapitalDelta]", "r"]}]]}], "-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["\[Omega]", "2"], " ", 
        SubsuperscriptBox["\[Epsilon]", "i", "\[Theta]r"]}], 
       RowBox[{"2", " ", 
        SuperscriptBox["c", "2"]}]]}], ")"}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.467119317649967*^9, 3.467119431412118*^9, 3.46772196403935*^9, {
   3.467734193913422*^9, 3.467734200636364*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"lhsCentralDiffZ", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"centralDiffCCEzCons", "-", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Omega]", "^", "2"}], "/", 
       RowBox[{"c", "^", "2"}]}], " ", 
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubsuperscriptBox["\[Epsilon]", "i", "zr"], 
            SubscriptBox["Er", "i"]}], "+", 
           RowBox[{
            SubsuperscriptBox["\[Epsilon]", "\"\<i+1\>\"", "zr"], 
            SubscriptBox["Er", "\"\<i+1\>\""]}]}], ")"}], "/", "2"}], 
        "\[IndentingNewLine]", "+", 
        RowBox[{
         SubsuperscriptBox["\[Epsilon]", "\"\<i+1/2\>\"", "z\[Theta]"], 
         SubscriptBox["Eth", "\"\<i+1/2\>\""]}], "\[IndentingNewLine]", "+", 
        RowBox[{
         SubsuperscriptBox["\[Epsilon]", "\"\<i+1/2\>\"", "zz"], 
         SubscriptBox["Ez", "\"\<i+1/2\>\""]}]}], "\[IndentingNewLine]", 
       ")"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["Er", "\"\<i-1\>\""], ",", 
      SubscriptBox["Er", "i"], ",", 
      SubscriptBox["Er", "\"\<i+1\>\""], ",", 
      SubscriptBox["Eth", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+3/2\>\""]}], "}"}], ",", "Simplify"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.4671198836143427`*^9, 3.467119912702475*^9}, {
  3.4677219681256657`*^9, 3.467721978052608*^9}, {3.467732740447309*^9, 
  3.46773275797504*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      SubscriptBox["Ez", "\<\"i+3/2\"\>"], " ", 
      SubscriptBox["r", "\<\"i+1\"\>"]}], 
     RowBox[{
      SubscriptBox["r", "\<\"i+1/2\"\>"], " ", 
      SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]]}], "-", 
   FractionBox[
    RowBox[{
     SubscriptBox["Ez", "\<\"i-1/2\"\>"], " ", 
     SubscriptBox["r", "i"]}], 
    RowBox[{
     SubscriptBox["r", "\<\"i+1/2\"\>"], " ", 
     SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]], "+", 
   RowBox[{
    SubscriptBox["Er", "\<\"i+1\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", "kz", " ", 
        SubscriptBox["r", "\<\"i+1\"\>"]}], 
       SubscriptBox["r", "\<\"i+1/2\"\>"]], "-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["\[Omega]", "2"], " ", 
        SubsuperscriptBox["\[Epsilon]", "\<\"i+1\"\>", "zr"]}], 
       RowBox[{"2", " ", 
        SuperscriptBox["c", "2"]}]]}], ")"}]}], "+", 
   RowBox[{
    SubscriptBox["Ez", "\<\"i+1/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       SubsuperscriptBox["n", "\[Phi]", "2"], 
       SubscriptBox["r", "\<\"i+1/2\"\>"]], "+", 
      FractionBox[
       RowBox[{
        SubscriptBox["r", "\<\"i+1\"\>"], "+", 
        SubscriptBox["r", "i"]}], 
       RowBox[{
        SubscriptBox["r", "\<\"i+1/2\"\>"], " ", 
        SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]], "-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["\[Omega]", "2"], " ", 
        SubsuperscriptBox["\[Epsilon]", "\<\"i+1/2\"\>", "zz"]}], 
       SuperscriptBox["c", "2"]]}], ")"}]}], "+", 
   RowBox[{
    SubscriptBox["Eth", "\<\"i+1/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "kz"}], " ", 
       SubscriptBox["n", "\[Phi]"]}], "-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["\[Omega]", "2"], " ", 
        SubsuperscriptBox["\[Epsilon]", "\<\"i+1/2\"\>", "z\[Theta]"]}], 
       SuperscriptBox["c", "2"]]}], ")"}]}], "+", 
   RowBox[{
    SubscriptBox["Er", "i"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "kz", " ", 
         SubscriptBox["r", "i"]}], 
        SubscriptBox["r", "\<\"i+1/2\"\>"]]}], "-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["\[Omega]", "2"], " ", 
        SubsuperscriptBox["\[Epsilon]", "i", "zr"]}], 
       RowBox[{"2", " ", 
        SuperscriptBox["c", "2"]}]]}], ")"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.4671198916896963`*^9, 3.4671199134456387`*^9}, 
   3.4677219817386017`*^9, {3.4677327415225677`*^9, 3.467732758461028*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"forwardDiffCCER", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"CCE", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "/.", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Er", "[", "Rr", "]"}], "\[Rule]", 
        SubscriptBox["Er", "i"]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Eth", "[", "Rr", "]"}], "\[Rule]", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Ez", "[", "Rr", "]"}], "\[Rule]", "0"}], ",", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", "Rr"], 
         RowBox[{"Eth", "[", "Rr", "]"}]}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "3"}], 
            SubscriptBox["Eth", "i"], "*", "0"}], "+", 
           RowBox[{"4", 
            SubscriptBox["Eth", "\"\<i+1/2\>\""]}], "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["Eth", "\"\<i+1/2\>\""], "+", 
              SubscriptBox["Eth", "\"\<i+3/2\>\""]}], ")"}], "/", "2"}]}], 
          ")"}], "/", 
         SubscriptBox["\[CapitalDelta]", "r"]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", "Rr"], 
         RowBox[{"Ez", "[", "Rr", "]"}]}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "3"}], 
            SubscriptBox["Ez", "i"], "*", "0"}], "+", 
           RowBox[{"4", 
            SubscriptBox["Ez", "\"\<i+1/2\>\""]}], "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["Ez", "\"\<i+1/2\>\""], "+", 
              SubscriptBox["Ez", "\"\<i+3/2\>\""]}], ")"}], "/", "2"}]}], 
          ")"}], "/", 
         SubscriptBox["\[CapitalDelta]", "r"]}]}]}], "}"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["Er", "\"\<i-1\>\""], ",", 
      SubscriptBox["Er", "i"], ",", 
      SubscriptBox["Er", "\"\<i+1\>\""], ",", 
      SubscriptBox["Eth", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+3/2\>\""]}], "}"}], ",", "Simplify"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.46712092554318*^9, 3.467120959806765*^9}, 
   3.467120989942895*^9, {3.467121026828197*^9, 3.467121123490306*^9}, {
   3.4671212334888144`*^9, 3.4671212681753483`*^9}, {3.467130395092301*^9, 
   3.4671304062851*^9}, {3.4671305322267857`*^9, 3.4671305325197563`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["kz", "2"], "+", 
     FractionBox[
      SuperscriptBox["nPhi", "2"], 
      SuperscriptBox["Rr", "2"]]}], ")"}], " ", 
   SubscriptBox["Er", "i"]}], "+", 
  FractionBox[
   RowBox[{"7", " ", "\[ImaginaryI]", " ", "nPhi", " ", 
    SubscriptBox["Eth", "\<\"i+1/2\"\>"]}], 
   RowBox[{"2", " ", "Rr", " ", 
    SubscriptBox["\[CapitalDelta]", "r"]}]], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", "nPhi", " ", 
    SubscriptBox["Eth", "\<\"i+3/2\"\>"]}], 
   RowBox[{"2", " ", "Rr", " ", 
    SubscriptBox["\[CapitalDelta]", "r"]}]], "+", 
  FractionBox[
   RowBox[{"7", " ", "\[ImaginaryI]", " ", "kz", " ", 
    SubscriptBox["Ez", "\<\"i+1/2\"\>"]}], 
   RowBox[{"2", " ", 
    SubscriptBox["\[CapitalDelta]", "r"]}]], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", "kz", " ", 
    SubscriptBox["Ez", "\<\"i+3/2\"\>"]}], 
   RowBox[{"2", " ", 
    SubscriptBox["\[CapitalDelta]", "r"]}]]}]], "Output",
 CellChangeTimes->{{3.4671209321828213`*^9, 3.467120960598419*^9}, 
   3.467120991253046*^9, 3.467121125283483*^9, 3.467121268781879*^9, 
   3.467130533299623*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"forwardDiffCCEThB", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"CCE", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "/.", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Er", "[", "Rr", "]"}], "\[Rule]", 
        SubscriptBox["Er", "i"]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Eth", "[", "Rr", "]"}], "\[Rule]", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Ez", "[", "Rr", "]"}], "\[Rule]", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", "Rr"], 
         RowBox[{"Er", "[", "Rr", "]"}]}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "3"}], 
            SubscriptBox["Er", "i"]}], "+", 
           RowBox[{"4", 
            SubscriptBox["Er", "\"\<i+1\>\""]}], "-", 
           SubscriptBox["Er", "\"\<i+2\>\""]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"2", 
           SubscriptBox["\[CapitalDelta]", "r"]}], ")"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", "Rr"], 
         RowBox[{"Eth", "[", "Rr", "]"}]}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "3"}], 
            SubscriptBox["Eth", "i"], "*", "0"}], "+", 
           RowBox[{"4", 
            SubscriptBox["Eth", "\"\<i+1/2\>\""]}], "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["Eth", "\"\<i+1/2\>\""], "+", 
              SubscriptBox["Eth", "\"\<i+3/2\>\""]}], ")"}], "/", "2"}]}], 
          ")"}], "/", " ", 
         SubscriptBox["\[CapitalDelta]", "r"]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", 
          RowBox[{"Rr", ",", "Rr"}]], 
         RowBox[{"Eth", "[", "Rr", "]"}]}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", 
            SubscriptBox["Eth", "i"], "*", "0"}], "-", 
           RowBox[{"5", " ", 
            SubscriptBox["Eth", "\"\<i+1/2\>\""]}], "+", 
           RowBox[{"4", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SubscriptBox["Eth", "\"\<i+1/2\>\""], "+", 
               SubscriptBox["Eth", "\"\<i+3/2\>\""]}], ")"}], "/", "2"}]}], 
           "-", 
           SubscriptBox["Eth", "\"\<i+3/2\>\""]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["\[CapitalDelta]", "r"], "/", "2"}], ")"}], "^", 
           "2"}], ")"}]}]}]}], "}"}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["Er", "\"\<i-1\>\""], ",", 
      SubscriptBox["Er", "i"], ",", 
      SubscriptBox["Er", "\"\<i+1\>\""], ",", 
      SubscriptBox["Eth", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+3/2\>\""]}], "}"}], ",", "Simplify"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.467121626923188*^9, 3.4671216712588797`*^9}, {
   3.467121722606091*^9, 3.467121790220256*^9}, {3.4671218400057917`*^9, 
   3.467121937909718*^9}, {3.4671219946811047`*^9, 3.467122013863697*^9}, {
   3.467122046069212*^9, 3.46712211661957*^9}, {3.4671231110363607`*^9, 
   3.4671231112164497`*^9}, 3.467127992482522*^9, {3.467130572966669*^9, 
   3.467130590187583*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"2", " ", "\[ImaginaryI]", " ", "nPhi", " ", 
    SubscriptBox["Er", "\<\"i+1\"\>"]}], 
   RowBox[{"Rr", " ", 
    SubscriptBox["\[CapitalDelta]", "r"]}]], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", "nPhi", " ", 
    SubscriptBox["Er", "\<\"i+2\"\>"]}], 
   RowBox[{"2", " ", "Rr", " ", 
    SubscriptBox["\[CapitalDelta]", "r"]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["Eth", "\<\"i+3/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "8"}], " ", "Rr"}], "+", 
      SubscriptBox["\[CapitalDelta]", "r"]}], ")"}]}], 
   RowBox[{"2", " ", "Rr", " ", 
    SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", "nPhi", " ", 
    SubscriptBox["Er", "i"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"3", " ", "Rr"}], "+", 
      RowBox[{"2", " ", 
       SubscriptBox["\[CapitalDelta]", "r"]}]}], ")"}]}], 
   RowBox[{"2", " ", 
    SuperscriptBox["Rr", "2"], " ", 
    SubscriptBox["\[CapitalDelta]", "r"]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["Eth", "\<\"i+1/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{"24", "-", 
      FractionBox[
       RowBox[{"7", " ", 
        SubscriptBox["\[CapitalDelta]", "r"]}], "Rr"]}], ")"}]}], 
   RowBox[{"2", " ", 
    SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]]}]], "Output",
 CellChangeTimes->{{3.467121631274913*^9, 3.467121671801921*^9}, 
   3.467121723787715*^9, {3.4671218723848467`*^9, 3.4671219075323133`*^9}, 
   3.467121941461226*^9, 3.467122015650145*^9, 3.467122049512948*^9, {
   3.46712211205774*^9, 3.467122117554337*^9}, 3.467123111899165*^9, 
   3.467127995842539*^9, 3.4671305930902863`*^9, 3.467138694817461*^9, 
   3.467140116405477*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"forwardDiffCCEZB", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"CCE", "[", 
      RowBox[{"[", "3", "]"}], "]"}], "/.", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Er", "[", "Rr", "]"}], "\[Rule]", 
        SubscriptBox["Er", "i"]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Eth", "[", "Rr", "]"}], "\[Rule]", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Ez", "[", "Rr", "]"}], "\[Rule]", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", "Rr"], 
         RowBox[{"Er", "[", "Rr", "]"}]}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "3"}], 
            SubscriptBox["Er", "i"]}], "+", 
           RowBox[{"4", 
            SubscriptBox["Er", "\"\<i+1\>\""]}], "-", 
           SubscriptBox["Er", "\"\<i+2\>\""]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"2", 
           SubscriptBox["\[CapitalDelta]", "r"]}], ")"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", "Rr"], 
         RowBox[{"Ez", "[", "Rr", "]"}]}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "3"}], 
            SubscriptBox["Ez", "i"], "*", "0"}], "+", 
           RowBox[{"4", 
            SubscriptBox["Ez", "\"\<i+1/2\>\""]}], "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["Ez", "\"\<i+1/2\>\""], "+", 
              SubscriptBox["Ez", "\"\<i+3/2\>\""]}], ")"}], "/", "2"}]}], 
          ")"}], "/", 
         SubscriptBox["\[CapitalDelta]", "r"]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", 
          RowBox[{"Rr", ",", "Rr"}]], 
         RowBox[{"Ez", "[", "Rr", "]"}]}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", 
            SubscriptBox["Ez", "i"], "*", "0"}], "-", 
           RowBox[{"5", 
            SubscriptBox["Ez", "\"\<i+1/2\>\""]}], "+", 
           RowBox[{"4", 
            RowBox[{
             RowBox[{"(", " ", 
              RowBox[{
               SubscriptBox["Ez", "\"\<i+1/2\>\""], "+", 
               SubscriptBox["Ez", "\"\<i+3/2\>\""]}], ")"}], "/", "2"}]}], 
           "-", 
           SubscriptBox["Ez", "\"\<i+3/2\>\""]}], ")"}], "/", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["\[CapitalDelta]", "r"], "/", "2"}], ")"}], "^", 
          "2"}]}]}]}], "}"}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["Er", "\"\<i-1\>\""], ",", 
      SubscriptBox["Er", "i"], ",", 
      SubscriptBox["Er", "\"\<i+1\>\""], ",", 
      SubscriptBox["Er", "\"\<i+2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+3/2\>\""]}], "}"}], ",", "Simplify"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.4671222507006073`*^9, 3.467122283248406*^9}, {
   3.46712235078962*^9, 3.467122374201294*^9}, {3.467122410970413*^9, 
   3.467122609735561*^9}, {3.467122701230378*^9, 3.467122708497486*^9}, 
   3.4671285596532183`*^9, {3.467130596718939*^9, 3.467130607869158*^9}, {
   3.467130822108036*^9, 3.467130822520479*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", "kz", " ", 
   SubscriptBox["Er", "i"], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox["2", "Rr"], "-", 
     FractionBox["3", 
      SubscriptBox["\[CapitalDelta]", "r"]]}], ")"}]}], "+", 
  FractionBox[
   RowBox[{"2", " ", "\[ImaginaryI]", " ", "kz", " ", 
    SubscriptBox["Er", "\<\"i+1\"\>"]}], 
   SubscriptBox["\[CapitalDelta]", "r"]], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", "kz", " ", 
    SubscriptBox["Er", "\<\"i+2\"\>"]}], 
   RowBox[{"2", " ", 
    SubscriptBox["\[CapitalDelta]", "r"]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["Ez", "\<\"i+3/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "8"}], " ", "Rr"}], "+", 
      SubscriptBox["\[CapitalDelta]", "r"]}], ")"}]}], 
   RowBox[{"2", " ", "Rr", " ", 
    SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["Ez", "\<\"i+1/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{"24", "-", 
      FractionBox[
       RowBox[{"7", " ", 
        SubscriptBox["\[CapitalDelta]", "r"]}], "Rr"]}], ")"}]}], 
   RowBox[{"2", " ", 
    SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]]}]], "Output",
 CellChangeTimes->{{3.467122256395174*^9, 3.467122283857655*^9}, 
   3.467122405456542*^9, 3.4671224559407673`*^9, 3.467122527423361*^9, 
   3.467122611920767*^9, 3.4671227093631573`*^9, 3.467128562234849*^9, 
   3.467130611767555*^9, 3.467130830173387*^9, 3.467138983055255*^9, 
   3.46714012211762*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"lhsForwardDiffR", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"forwardDiffCCER", "-", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Omega]", "^", "2"}], "/", 
       RowBox[{"c", "^", "2"}]}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubsuperscriptBox["\[Epsilon]", "i", "rr"], 
         SubscriptBox["Er", "i"]}], "+", 
        RowBox[{
         SubscriptBox["Eth", "i"], "*", "0"}], "+", 
        RowBox[{
         SubscriptBox["Ez", "i"], "*", "0"}]}], ")"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["Er", "\"\<i-1\>\""], ",", 
      SubscriptBox["Er", "i"], ",", 
      SubscriptBox["Er", "\"\<i+1\>\""], ",", 
      SubscriptBox["Eth", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+3/2\>\""]}], "}"}], ",", "Simplify"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.467122823498157*^9, 3.467122826920107*^9}, {
  3.4671228834295673`*^9, 3.4671229094072437`*^9}, {3.467122955079473*^9, 
  3.46712295795221*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"7", " ", "\[ImaginaryI]", " ", "nPhi", " ", 
    SubscriptBox["Eth", "\<\"i+1/2\"\>"]}], 
   RowBox[{"2", " ", "Rr", " ", 
    SubscriptBox["\[CapitalDelta]", "r"]}]], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", "nPhi", " ", 
    SubscriptBox["Eth", "\<\"i+3/2\"\>"]}], 
   RowBox[{"2", " ", "Rr", " ", 
    SubscriptBox["\[CapitalDelta]", "r"]}]], "+", 
  FractionBox[
   RowBox[{"7", " ", "\[ImaginaryI]", " ", "kz", " ", 
    SubscriptBox["Ez", "\<\"i+1/2\"\>"]}], 
   RowBox[{"2", " ", 
    SubscriptBox["\[CapitalDelta]", "r"]}]], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", "kz", " ", 
    SubscriptBox["Ez", "\<\"i+3/2\"\>"]}], 
   RowBox[{"2", " ", 
    SubscriptBox["\[CapitalDelta]", "r"]}]], "+", 
  RowBox[{
   SubscriptBox["Er", "i"], " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["kz", "2"], "+", 
     FractionBox[
      SuperscriptBox["nPhi", "2"], 
      SuperscriptBox["Rr", "2"]], "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["\[Omega]", "2"], " ", 
       SubsuperscriptBox["\[Epsilon]", "i", "rr"]}], 
      SuperscriptBox["c", "2"]]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.467122829376876*^9, 3.467122910246443*^9, 
  3.4671229593186417`*^9, 3.46713042690282*^9, 3.46713053994899*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"lhsForwardDiffThB", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"forwardDiffCCEThB", "-", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Omega]", "^", "2"}], "/", 
       RowBox[{"c", "^", "2"}]}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubsuperscriptBox["\[Epsilon]", "i", "\[Theta]r"], 
         SubscriptBox["Er", "i"]}], "+", 
        RowBox[{
         SubscriptBox["Eth", "i"], "*", "0"}], "+", 
        RowBox[{
         SubscriptBox["Ez", "i"], "*", "0"}]}], ")"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["Er", "\"\<i-1\>\""], ",", 
      SubscriptBox["Er", "i"], ",", 
      SubscriptBox["Er", "\"\<i+1\>\""], ",", 
      SubscriptBox["Eth", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+3/2\>\""]}], "}"}], ",", "Simplify"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.467123047334916*^9, 3.467123057494323*^9}, {
  3.467123201102316*^9, 3.467123243558998*^9}, {3.4671280020608883`*^9, 
  3.467128003418392*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"2", " ", "\[ImaginaryI]", " ", "nPhi", " ", 
    SubscriptBox["Er", "\<\"i+1\"\>"]}], 
   RowBox[{"Rr", " ", 
    SubscriptBox["\[CapitalDelta]", "r"]}]], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", "nPhi", " ", 
    SubscriptBox["Er", "\<\"i+2\"\>"]}], 
   RowBox[{"2", " ", "Rr", " ", 
    SubscriptBox["\[CapitalDelta]", "r"]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["Eth", "\<\"i+3/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "8"}], " ", "Rr"}], "+", 
      SubscriptBox["\[CapitalDelta]", "r"]}], ")"}]}], 
   RowBox[{"2", " ", "Rr", " ", 
    SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["Eth", "\<\"i+1/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{"24", "-", 
      FractionBox[
       RowBox[{"7", " ", 
        SubscriptBox["\[CapitalDelta]", "r"]}], "Rr"]}], ")"}]}], 
   RowBox[{"2", " ", 
    SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]], "+", 
  RowBox[{
   SubscriptBox["Er", "i"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", "nPhi", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"3", " ", "Rr"}], "+", 
          RowBox[{"2", " ", 
           SubscriptBox["\[CapitalDelta]", "r"]}]}], ")"}]}], 
       RowBox[{"2", " ", 
        SuperscriptBox["Rr", "2"], " ", 
        SubscriptBox["\[CapitalDelta]", "r"]}]]}], "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["\[Omega]", "2"], " ", 
       SubsuperscriptBox["\[Epsilon]", "i", "\[Theta]r"]}], 
      SuperscriptBox["c", "2"]]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.467123059254613*^9, 3.46712311575961*^9, 
  3.467123244691629*^9, 3.467128004322277*^9, 3.467130615557563*^9, 
  3.467138708851452*^9, 3.467140129453472*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"lhsForwardDiffZB", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"forwardDiffCCEZB", "-", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Omega]", "^", "2"}], "/", 
       RowBox[{"c", "^", "2"}]}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubsuperscriptBox["\[Epsilon]", "i", "zr"], 
         SubscriptBox["Er", "i"]}], "+", 
        RowBox[{
         SubsuperscriptBox["\[Epsilon]", "\"\<i+1/2\>\"", "z\[Theta]"], 
         SubscriptBox["Eth", "\"\<i+1/2\>\""], "*", "0"}], "+", 
        RowBox[{
         SubsuperscriptBox["\[Epsilon]", "\"\<i+1/2\>\"", "zz"], 
         SubscriptBox["Ez", "\"\<i+1/2\>\""], "*", "0"}]}], ")"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["Er", "\"\<i-1\>\""], ",", 
      SubscriptBox["Er", "i"], ",", 
      SubscriptBox["Er", "\"\<i+1\>\""], ",", 
      SubscriptBox["Eth", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Er", "\"\<i+2\>\""]}], "}"}], ",", "Simplify"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.467123357654759*^9, 3.467123379724112*^9}, {
  3.467128566444023*^9, 3.467128567583799*^9}, {3.467130760085243*^9, 
  3.467130764898137*^9}, {3.4671390101012573`*^9, 3.467139014760504*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"2", " ", "\[ImaginaryI]", " ", "kz", " ", 
    SubscriptBox["Er", "\<\"i+1\"\>"]}], 
   SubscriptBox["\[CapitalDelta]", "r"]], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", "kz", " ", 
    SubscriptBox["Er", "\<\"i+2\"\>"]}], 
   RowBox[{"2", " ", 
    SubscriptBox["\[CapitalDelta]", "r"]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["Ez", "\<\"i+3/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "8"}], " ", "Rr"}], "+", 
      SubscriptBox["\[CapitalDelta]", "r"]}], ")"}]}], 
   RowBox[{"2", " ", "Rr", " ", 
    SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["Ez", "\<\"i+1/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{"24", "-", 
      FractionBox[
       RowBox[{"7", " ", 
        SubscriptBox["\[CapitalDelta]", "r"]}], "Rr"]}], ")"}]}], 
   RowBox[{"2", " ", 
    SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]], "+", 
  RowBox[{
   SubscriptBox["Er", "i"], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", "kz"}], "Rr"], "-", 
     FractionBox[
      RowBox[{"3", " ", "\[ImaginaryI]", " ", "kz"}], 
      RowBox[{"2", " ", 
       SubscriptBox["\[CapitalDelta]", "r"]}]], "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["\[Omega]", "2"], " ", 
       SubsuperscriptBox["\[Epsilon]", "i", "zr"]}], 
      SuperscriptBox["c", "2"]]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.4671233680454617`*^9, 3.467123380441832*^9}, 
   3.467128568482047*^9, 3.467130618096303*^9, 3.4671307655407553`*^9, 
   3.467130834401061*^9, {3.467138989204126*^9, 3.467139016483869*^9}, 
   3.4671401350323973`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"forwardDiffCCETh", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"CCE", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "/.", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Er", "[", "Rr", "]"}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["Er", "i"], "+", 
           SubscriptBox["Er", "\"\<i+1\>\""]}], ")"}], "/", "2"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Eth", "[", "Rr", "]"}], "\[Rule]", 
        SubscriptBox["Eth", "\"\<i+1/2\>\""]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Ez", "[", "Rr", "]"}], "\[Rule]", 
        SubscriptBox["Ez", "\"\<i+1/2\>\""]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", "Rr"], 
         RowBox[{"Er", "[", "Rr", "]"}]}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            SubscriptBox["Er", "i"]}], "+", 
           SubscriptBox["Er", "\"\<i+1\>\""]}], ")"}], "/", 
         SubscriptBox["\[CapitalDelta]", "r"]}]}], ",", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", "Rr"], 
         RowBox[{"Eth", "[", "Rr", "]"}]}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "3"}], 
            SubscriptBox["Eth", "\"\<i+1/2\>\""]}], "+", 
           RowBox[{"4", 
            SubscriptBox["Eth", "\"\<i+3/2\>\""]}], "-", 
           SubscriptBox["Eth", "\"\<i+5/2\>\""]}], ")"}], "/", " ", 
         RowBox[{"(", 
          RowBox[{"2", 
           SubscriptBox["\[CapitalDelta]", "r"]}], ")"}]}]}], ",", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", 
          RowBox[{"Rr", ",", "Rr"}]], 
         RowBox[{"Eth", "[", "Rr", "]"}]}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", 
            SubscriptBox["Eth", "\"\<i+1/2\>\""]}], "-", 
           RowBox[{"5", " ", 
            SubscriptBox["Eth", "\"\<i+3/2\>\""]}], "+", 
           RowBox[{"4", 
            SubscriptBox["Eth", "\"\<i+5/2\>\""]}], "-", 
           SubscriptBox["Eth", "\"\<i+7/2\>\""]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["\[CapitalDelta]", "r"], "^", "2"}], ")"}]}]}]}], 
      "}"}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["Er", "\"\<i-1\>\""], ",", 
      SubscriptBox["Er", "i"], ",", 
      SubscriptBox["Er", "\"\<i+1\>\""], ",", 
      SubscriptBox["Eth", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+5/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+7/2\>\""]}], "}"}], ",", "Simplify"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.467128072362768*^9, 3.467128110954628*^9}, {
  3.467128166374642*^9, 3.467128178694627*^9}, {3.467128308851215*^9, 
  3.467128385937302*^9}, {3.4671284369824*^9, 3.467128484388092*^9}, {
  3.467128704768985*^9, 3.467128718552446*^9}, {3.4671288516165447`*^9, 
  3.467128880844287*^9}, {3.467130097738212*^9, 3.4671300986646338`*^9}, {
  3.467130129945713*^9, 3.467130130296011*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{"kz", " ", "nPhi", " ", 
     SubscriptBox["Ez", "\<\"i+1/2\"\>"]}], "Rr"]}], "+", 
  RowBox[{
   SubscriptBox["Eth", "\<\"i+1/2\"\>"], " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["kz", "2"], "+", 
     FractionBox["1", 
      SuperscriptBox["Rr", "2"]], "-", 
     FractionBox["2", 
      SubsuperscriptBox["\[CapitalDelta]", "r", "2"]], "+", 
     FractionBox["3", 
      RowBox[{"2", " ", "Rr", " ", 
       SubscriptBox["\[CapitalDelta]", "r"]}]]}], ")"}]}], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["Eth", "\<\"i+3/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"5", " ", "Rr"}], "-", 
      RowBox[{"2", " ", 
       SubscriptBox["\[CapitalDelta]", "r"]}]}], ")"}]}], 
   RowBox[{"Rr", " ", 
    SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", "nPhi", " ", 
    SubscriptBox["Er", "\<\"i+1\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "Rr"}], "-", 
      SubscriptBox["\[CapitalDelta]", "r"]}], ")"}]}], 
   RowBox[{"2", " ", 
    SuperscriptBox["Rr", "2"], " ", 
    SubscriptBox["\[CapitalDelta]", "r"]}]], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", "nPhi", " ", 
    SubscriptBox["Er", "i"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "Rr"}], "+", 
      SubscriptBox["\[CapitalDelta]", "r"]}], ")"}]}], 
   RowBox[{"2", " ", 
    SuperscriptBox["Rr", "2"], " ", 
    SubscriptBox["\[CapitalDelta]", "r"]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"2", " ", "Rr", " ", 
     SubscriptBox["Eth", "\<\"i+7/2\"\>"]}], "+", 
    RowBox[{
     SubscriptBox["Eth", "\<\"i+5/2\"\>"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "8"}], " ", "Rr"}], "+", 
       SubscriptBox["\[CapitalDelta]", "r"]}], ")"}]}]}], 
   RowBox[{"2", " ", "Rr", " ", 
    SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]]}]], "Output",
 CellChangeTimes->{
  3.46712800789612*^9, {3.467128089736055*^9, 3.4671281123007727`*^9}, {
   3.4671281677670927`*^9, 3.467128184089032*^9}, 3.46712832242666*^9, 
   3.4671283866265163`*^9, 3.467128485505718*^9, {3.467128705452487*^9, 
   3.467128719200521*^9}, {3.467128856936949*^9, 3.467128881747652*^9}, 
   3.467129806595656*^9, 3.467130099358769*^9, 3.46713013083107*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"forwardDiffCCEZ", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"CCE", "[", 
      RowBox[{"[", "3", "]"}], "]"}], "/.", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Er", "[", "Rr", "]"}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["Er", "i"], "+", 
           SubscriptBox["Er", "\"\<i+1\>\""]}], ")"}], "/", "2"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Eth", "[", "Rr", "]"}], "\[Rule]", 
        SubscriptBox["Eth", "\"\<i+1/2\>\""]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Ez", "[", "Rr", "]"}], "\[Rule]", 
        SubscriptBox["Ez", "\"\<i+1/2\>\""]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", "Rr"], 
         RowBox[{"Er", "[", "Rr", "]"}]}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            SubscriptBox["Er", "i"]}], "+", 
           SubscriptBox["Er", "\"\<i+1\>\""]}], ")"}], "/", 
         SubscriptBox["\[CapitalDelta]", "r"]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", "Rr"], 
         RowBox[{"Ez", "[", "Rr", "]"}]}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "3"}], 
            SubscriptBox["Ez", "\"\<i+1/2\>\""]}], "+", 
           RowBox[{"4", 
            SubscriptBox["Ez", "\"\<i+3/2\>\""]}], "-", 
           SubscriptBox["Ez", "\"\<i+5/2\>\""]}], ")"}], "/", " ", 
         RowBox[{"(", 
          RowBox[{"2", 
           SubscriptBox["\[CapitalDelta]", "r"]}], ")"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", 
          RowBox[{"Rr", ",", "Rr"}]], 
         RowBox[{"Ez", "[", "Rr", "]"}]}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", 
            SubscriptBox["Ez", "\"\<i+1/2\>\""]}], "-", 
           RowBox[{"5", " ", 
            SubscriptBox["Ez", "\"\<i+3/2\>\""]}], "+", 
           RowBox[{"4", 
            SubscriptBox["Ez", "\"\<i+5/2\>\""]}], "-", 
           SubscriptBox["Ez", "\"\<i+7/2\>\""]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["\[CapitalDelta]", "r"], "^", "2"}], ")"}]}]}]}], 
      "}"}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["Er", "\"\<i-1\>\""], ",", 
      SubscriptBox["Er", "i"], ",", 
      SubscriptBox["Er", "\"\<i+1\>\""], ",", 
      SubscriptBox["Er", "\"\<i+2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Ez", 
       RowBox[{"\"\<i+5/2\>\"", ",", 
        SubscriptBox["Ez", "\"\<i+7/2\>\""]}]]}], "}"}], ",", "Simplify"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.4671285789755583`*^9, 3.467128726122414*^9}, {
  3.467129753730772*^9, 3.4671297655013533`*^9}, {3.467130092621418*^9, 
  3.467130092928871*^9}, {3.467130123856051*^9, 3.4671301242354393`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{"kz", " ", "nPhi", " ", 
     SubscriptBox["Eth", "\<\"i+1/2\"\>"]}], "Rr"]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", "kz", " ", 
   SubscriptBox["Er", "i"], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox["1", "Rr"], "-", 
     FractionBox["2", 
      SubscriptBox["\[CapitalDelta]", "r"]]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", "kz", " ", 
   SubscriptBox["Er", "\<\"i+1\"\>"], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox["1", "Rr"], "+", 
     FractionBox["2", 
      SubscriptBox["\[CapitalDelta]", "r"]]}], ")"}]}], "+", 
  RowBox[{
   SubscriptBox["Ez", "\<\"i+1/2\"\>"], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      SuperscriptBox["nPhi", "2"], 
      SuperscriptBox["Rr", "2"]], "-", 
     FractionBox["2", 
      SubsuperscriptBox["\[CapitalDelta]", "r", "2"]], "+", 
     FractionBox["3", 
      RowBox[{"2", " ", "Rr", " ", 
       SubscriptBox["\[CapitalDelta]", "r"]}]]}], ")"}]}], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["Ez", "\<\"i+3/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"5", " ", "Rr"}], "-", 
      RowBox[{"2", " ", 
       SubscriptBox["\[CapitalDelta]", "r"]}]}], ")"}]}], 
   RowBox[{"Rr", " ", 
    SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"2", " ", "Rr", " ", 
     SubscriptBox["Ez", "\<\"i+7/2\"\>"]}], "+", 
    RowBox[{
     SubscriptBox["Ez", "\<\"i+5/2\"\>"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "8"}], " ", "Rr"}], "+", 
       SubscriptBox["\[CapitalDelta]", "r"]}], ")"}]}]}], 
   RowBox[{"2", " ", "Rr", " ", 
    SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]]}]], "Output",
 CellChangeTimes->{
  3.467128579508546*^9, {3.467128659441821*^9, 3.4671287267341146`*^9}, {
   3.467129758648752*^9, 3.467129766683848*^9}, {3.467130093878833*^9, 
   3.467130126820765*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"lhsForwardDiffTh", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"forwardDiffCCETh", "-", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Omega]", "^", "2"}], "/", 
       RowBox[{"c", "^", "2"}]}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubsuperscriptBox["\[Epsilon]", "i", "\[Theta]r"], 
            SubscriptBox["Er", "i"]}], "+", 
           RowBox[{
            SubsuperscriptBox["\[Epsilon]", "\"\<i+1\>\"", "\[Theta]r"], 
            SubscriptBox["Er", "\"\<i+1\>\""]}]}], ")"}], "/", "2"}], "+", 
        RowBox[{
         SubsuperscriptBox["\[Epsilon]", "\"\<i+1/2\>\"", "\[Theta]\[Theta]"], 
         SubscriptBox["Eth", "\"\<i+1/2\>\""]}], "+", 
        RowBox[{
         SubsuperscriptBox["\[Epsilon]", "\"\<i+1/2\>\"", "\[Theta]z"], 
         SubscriptBox["Ez", "\"\<i+1/2\>\""]}]}], ")"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["Er", "\"\<i-1\>\""], ",", 
      SubscriptBox["Er", "i"], ",", 
      SubscriptBox["Er", "\"\<i+1\>\""], ",", 
      SubscriptBox["Eth", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+5/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+7/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+5/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+7/2\>\""]}], "}"}], ",", "Simplify"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.4671298673533163`*^9, 3.467129894335156*^9}, {
  3.467129952530354*^9, 3.467129973497611*^9}, {3.467130279977552*^9, 
  3.467130314094928*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   SubscriptBox["Eth", "\<\"i+7/2\"\>"], 
   SubsuperscriptBox["\[CapitalDelta]", "r", "2"]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["Eth", "\<\"i+3/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"5", " ", "Rr"}], "-", 
      RowBox[{"2", " ", 
       SubscriptBox["\[CapitalDelta]", "r"]}]}], ")"}]}], 
   RowBox[{"Rr", " ", 
    SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["Eth", "\<\"i+5/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "8"}], " ", "Rr"}], "+", 
      SubscriptBox["\[CapitalDelta]", "r"]}], ")"}]}], 
   RowBox[{"2", " ", "Rr", " ", 
    SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]], "+", 
  RowBox[{
   SubscriptBox["Er", "\<\"i+1\"\>"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", "nPhi"}], 
       RowBox[{"2", " ", 
        SuperscriptBox["Rr", "2"]}]]}], "+", 
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", "nPhi"}], 
      RowBox[{"Rr", " ", 
       SubscriptBox["\[CapitalDelta]", "r"]}]], "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["\[Omega]", "2"], " ", 
       SubsuperscriptBox["\[Epsilon]", "\<\"i+1\"\>", "\[Theta]r"]}], 
      RowBox[{"2", " ", 
       SuperscriptBox["c", "2"]}]]}], ")"}]}], "+", 
  RowBox[{
   SubscriptBox["Ez", "\<\"i+1/2\"\>"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"kz", " ", "nPhi"}], "Rr"]}], "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["\[Omega]", "2"], " ", 
       SubsuperscriptBox["\[Epsilon]", "\<\"i+1/2\"\>", "\[Theta]z"]}], 
      SuperscriptBox["c", "2"]]}], ")"}]}], "+", 
  RowBox[{
   SubscriptBox["Eth", "\<\"i+1/2\"\>"], " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["kz", "2"], "+", 
     FractionBox["1", 
      SuperscriptBox["Rr", "2"]], "-", 
     FractionBox["2", 
      SubsuperscriptBox["\[CapitalDelta]", "r", "2"]], "+", 
     FractionBox["3", 
      RowBox[{"2", " ", "Rr", " ", 
       SubscriptBox["\[CapitalDelta]", "r"]}]], "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["\[Omega]", "2"], " ", 
       SubsuperscriptBox["\[Epsilon]", "\<\"i+1/2\"\>", "\[Theta]\[Theta]"]}], 
      SuperscriptBox["c", "2"]]}], ")"}]}], "+", 
  RowBox[{
   SubscriptBox["Er", "i"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", "nPhi", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "Rr"}], "+", 
          SubscriptBox["\[CapitalDelta]", "r"]}], ")"}]}], 
       RowBox[{"2", " ", 
        SuperscriptBox["Rr", "2"], " ", 
        SubscriptBox["\[CapitalDelta]", "r"]}]]}], "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["\[Omega]", "2"], " ", 
       SubsuperscriptBox["\[Epsilon]", "i", "\[Theta]r"]}], 
      RowBox[{"2", " ", 
       SuperscriptBox["c", "2"]}]]}], ")"}]}]}]], "Output",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{{3.467129877125142*^9, 3.467129895800413*^9}, 
   3.467129974235074*^9, 3.467130103468919*^9, 3.467130133544167*^9, {
   3.467130282067296*^9, 3.467130315010271*^9}, {3.4671433308588343`*^9, 
   3.467143335272706*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"lhsForwardDiffZ", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"forwardDiffCCEZ", "-", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Omega]", "^", "2"}], "/", 
       RowBox[{"c", "^", "2"}]}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubsuperscriptBox["\[Epsilon]", "i", "zr"], 
            SubscriptBox["Er", "i"]}], "+", 
           RowBox[{
            SubsuperscriptBox["\[Epsilon]", "\"\<i+1\>\"", "zr"], 
            SubscriptBox["Er", "\"\<i+1\>\""]}]}], ")"}], "/", "2"}], "+", 
        RowBox[{
         SubsuperscriptBox["\[Epsilon]", "\"\<i+1/2\>\"", "z\[Theta]"], 
         SubscriptBox["Eth", "\"\<i+1/2\>\""]}], "+", 
        RowBox[{
         SubsuperscriptBox["\[Epsilon]", "\"\<i+1/2\>\"", "zz"], 
         SubscriptBox["Ez", "\"\<i+1/2\>\""]}]}], ")"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["Er", "\"\<i-1\>\""], ",", 
      SubscriptBox["Er", "i"], ",", 
      SubscriptBox["Er", "\"\<i+1\>\""], ",", 
      SubscriptBox["Eth", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+5/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+7/2\>\""]}], "}"}], ",", "Simplify"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.467129931227438*^9, 3.467129940488978*^9}, 
   3.467129985539524*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   SubscriptBox["Ez", "\<\"i+7/2\"\>"], 
   SubsuperscriptBox["\[CapitalDelta]", "r", "2"]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["Ez", "\<\"i+3/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"5", " ", "Rr"}], "-", 
      RowBox[{"2", " ", 
       SubscriptBox["\[CapitalDelta]", "r"]}]}], ")"}]}], 
   RowBox[{"Rr", " ", 
    SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["Ez", "\<\"i+5/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "8"}], " ", "Rr"}], "+", 
      SubscriptBox["\[CapitalDelta]", "r"]}], ")"}]}], 
   RowBox[{"2", " ", "Rr", " ", 
    SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]], "+", 
  RowBox[{
   SubscriptBox["Er", "\<\"i+1\"\>"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", "kz", " ", 
      RowBox[{"(", 
       RowBox[{
        FractionBox["1", "Rr"], "+", 
        FractionBox["2", 
         SubscriptBox["\[CapitalDelta]", "r"]]}], ")"}]}], "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["\[Omega]", "2"], " ", 
       SubsuperscriptBox["\[Epsilon]", "\<\"i+1\"\>", "zr"]}], 
      RowBox[{"2", " ", 
       SuperscriptBox["c", "2"]}]]}], ")"}]}], "+", 
  RowBox[{
   SubscriptBox["Ez", "\<\"i+1/2\"\>"], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      SuperscriptBox["nPhi", "2"], 
      SuperscriptBox["Rr", "2"]], "-", 
     FractionBox["2", 
      SubsuperscriptBox["\[CapitalDelta]", "r", "2"]], "+", 
     FractionBox["3", 
      RowBox[{"2", " ", "Rr", " ", 
       SubscriptBox["\[CapitalDelta]", "r"]}]], "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["\[Omega]", "2"], " ", 
       SubsuperscriptBox["\[Epsilon]", "\<\"i+1/2\"\>", "zz"]}], 
      SuperscriptBox["c", "2"]]}], ")"}]}], "+", 
  RowBox[{
   SubscriptBox["Eth", "\<\"i+1/2\"\>"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"kz", " ", "nPhi"}], "Rr"]}], "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["\[Omega]", "2"], " ", 
       SubsuperscriptBox["\[Epsilon]", "\<\"i+1/2\"\>", "z\[Theta]"]}], 
      SuperscriptBox["c", "2"]]}], ")"}]}], "+", 
  RowBox[{
   SubscriptBox["Er", "i"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", "kz", " ", 
      RowBox[{"(", 
       RowBox[{
        FractionBox["1", "Rr"], "-", 
        FractionBox["2", 
         SubscriptBox["\[CapitalDelta]", "r"]]}], ")"}]}], "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["\[Omega]", "2"], " ", 
       SubsuperscriptBox["\[Epsilon]", "i", "zr"]}], 
      RowBox[{"2", " ", 
       SuperscriptBox["c", "2"]}]]}], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.467129944048914*^9, 3.4671299861277723`*^9, {3.467130105789238*^9, 
   3.467130135558035*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"backwardDiffCCER", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"CCE", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "/.", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Er", "[", "Rr", "]"}], "\[Rule]", 
        SubscriptBox["Er", "i"]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Eth", "[", "Rr", "]"}], "\[Rule]", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Ez", "[", "Rr", "]"}], "\[Rule]", "0"}], ",", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", "Rr"], 
         RowBox[{"Eth", "[", "Rr", "]"}]}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"3", 
            SubscriptBox["Eth", "i"], "*", "0"}], "-", 
           RowBox[{"4", 
            SubscriptBox["Eth", "\"\<i-1/2\>\""]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["Eth", "\"\<i-1/2\>\""], "+", 
              SubscriptBox["Eth", "\"\<i-3/2\>\""]}], ")"}], "/", "2"}]}], 
          ")"}], "/", 
         SubscriptBox["\[CapitalDelta]", "r"]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", "Rr"], 
         RowBox[{"Ez", "[", "Rr", "]"}]}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"3", 
            SubscriptBox["Ez", "i"], "*", "0"}], "-", 
           RowBox[{"4", 
            SubscriptBox["Ez", "\"\<i-1/2\>\""]}], "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["Ez", "\"\<i-1/2\>\""], "+", 
              SubscriptBox["Ez", "\"\<i-3/2\>\""]}], ")"}], "/", "2"}]}], 
          ")"}], "/", 
         SubscriptBox["\[CapitalDelta]", "r"]}]}]}], "}"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["Er", "\"\<i-1\>\""], ",", 
      SubscriptBox["Er", "i"], ",", 
      SubscriptBox["Er", "\"\<i+1\>\""], ",", 
      SubscriptBox["Eth", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+3/2\>\""]}], "}"}], ",", "Simplify"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.4671330409863997`*^9, 3.467133044233219*^9}, {
  3.467133309045768*^9, 3.467133310951014*^9}, {3.467133358656662*^9, 
  3.4671334104560328`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["kz", "2"], "+", 
     FractionBox[
      SuperscriptBox["nPhi", "2"], 
      SuperscriptBox["Rr", "2"]]}], ")"}], " ", 
   SubscriptBox["Er", "i"]}], "-", 
  FractionBox[
   RowBox[{"7", " ", "\[ImaginaryI]", " ", "nPhi", " ", 
    SubscriptBox["Eth", "\<\"i-1/2\"\>"]}], 
   RowBox[{"2", " ", "Rr", " ", 
    SubscriptBox["\[CapitalDelta]", "r"]}]], "-", 
  FractionBox[
   RowBox[{"9", " ", "\[ImaginaryI]", " ", "kz", " ", 
    SubscriptBox["Ez", "\<\"i-1/2\"\>"]}], 
   RowBox[{"2", " ", 
    SubscriptBox["\[CapitalDelta]", "r"]}]], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"nPhi", " ", 
       SubscriptBox["Eth", "\<\"i-3/2\"\>"]}], "-", 
      RowBox[{"kz", " ", "Rr", " ", 
       SubscriptBox["Ez", "\<\"i-3/2\"\>"]}]}], ")"}]}], 
   RowBox[{"2", " ", "Rr", " ", 
    SubscriptBox["\[CapitalDelta]", "r"]}]]}]], "Output",
 CellChangeTimes->{
  3.4671330499818993`*^9, {3.467133391542015*^9, 3.467133412439702*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"lhsBackwardDiffR", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"backwardDiffCCER", "-", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Omega]", "^", "2"}], "/", 
       RowBox[{"c", "^", "2"}]}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubsuperscriptBox["\[Epsilon]", "i", "rr"], 
         SubscriptBox["Er", "i"]}], "+", 
        RowBox[{
         SubscriptBox["Eth", "i"], "*", "0"}], "+", 
        RowBox[{
         SubscriptBox["Ez", "i"], "*", "0"}]}], ")"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["Er", "\"\<i-1\>\""], ",", 
      SubscriptBox["Er", "i"], ",", 
      SubscriptBox["Er", "\"\<i+1\>\""], ",", 
      SubscriptBox["Eth", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i-3/2\>\""]}], "}"}], ",", "Simplify"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.4671334528971443`*^9, 3.467133496471504*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{"7", " ", "\[ImaginaryI]", " ", "nPhi", " ", 
     SubscriptBox["Eth", "\<\"i-1/2\"\>"]}], 
    RowBox[{"2", " ", "Rr", " ", 
     SubscriptBox["\[CapitalDelta]", "r"]}]]}], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", "nPhi", " ", 
    SubscriptBox["Eth", "\<\"i-3/2\"\>"]}], 
   RowBox[{"2", " ", "Rr", " ", 
    SubscriptBox["\[CapitalDelta]", "r"]}]], "-", 
  FractionBox[
   RowBox[{"9", " ", "\[ImaginaryI]", " ", "kz", " ", 
    SubscriptBox["Ez", "\<\"i-1/2\"\>"]}], 
   RowBox[{"2", " ", 
    SubscriptBox["\[CapitalDelta]", "r"]}]], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", "kz", " ", 
    SubscriptBox["Ez", "\<\"i-3/2\"\>"]}], 
   RowBox[{"2", " ", 
    SubscriptBox["\[CapitalDelta]", "r"]}]], "+", 
  RowBox[{
   SubscriptBox["Er", "i"], " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["kz", "2"], "+", 
     FractionBox[
      SuperscriptBox["nPhi", "2"], 
      SuperscriptBox["Rr", "2"]], "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["\[Omega]", "2"], " ", 
       SubsuperscriptBox["\[Epsilon]", "i", "rr"]}], 
      SuperscriptBox["c", "2"]]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.467133464845953*^9, 3.467133497772313*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"backwardDiffCCETh", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"CCE", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "/.", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Er", "[", "Rr", "]"}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["Er", "i"], "+", 
           SubscriptBox["Er", "\"\<i+1\>\""]}], ")"}], "/", "2"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Eth", "[", "Rr", "]"}], "\[Rule]", 
        SubscriptBox["Eth", "\"\<i+1/2\>\""]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Ez", "[", "Rr", "]"}], "\[Rule]", 
        SubscriptBox["Ez", "\"\<i+1/2\>\""]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", "Rr"], 
         RowBox[{"Er", "[", "Rr", "]"}]}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            SubscriptBox["Er", "i"]}], "+", 
           SubscriptBox["Er", "\"\<i+1\>\""]}], ")"}], "/", 
         SubscriptBox["\[CapitalDelta]", "r"]}]}], ",", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", "Rr"], 
         RowBox[{"Eth", "[", "Rr", "]"}]}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"3", 
            SubscriptBox["Eth", "\"\<i+1/2\>\""]}], "-", 
           RowBox[{"4", 
            SubscriptBox["Eth", "\"\<i-1/2\>\""]}], "+", 
           SubscriptBox["Eth", "\"\<i-3/2\>\""]}], ")"}], "/", " ", 
         RowBox[{"(", 
          RowBox[{"2", 
           SubscriptBox["\[CapitalDelta]", "r"]}], ")"}]}]}], ",", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", 
          RowBox[{"Rr", ",", "Rr"}]], 
         RowBox[{"Eth", "[", "Rr", "]"}]}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", 
            SubscriptBox["Eth", "\"\<i+1/2\>\""]}], "-", 
           RowBox[{"5", " ", 
            SubscriptBox["Eth", "\"\<i-1/2\>\""]}], "+", 
           RowBox[{"4", 
            SubscriptBox["Eth", "\"\<i-3/2\>\""]}], "-", 
           SubscriptBox["Eth", "\"\<i-5/2\>\""]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["\[CapitalDelta]", "r"], "^", "2"}], ")"}]}]}]}], 
      "}"}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["Er", "\"\<i-1\>\""], ",", 
      SubscriptBox["Er", "i"], ",", 
      SubscriptBox["Er", "\"\<i+1\>\""], ",", 
      SubscriptBox["Eth", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+5/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+7/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i-3/2\>\""]}], "}"}], ",", "Simplify"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.4671343705273438`*^9, 3.467134373496046*^9}, {
  3.467134418882927*^9, 3.467134434928857*^9}, {3.467134537743643*^9, 
  3.46713458879793*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{"kz", " ", "nPhi", " ", 
     SubscriptBox["Ez", "\<\"i+1/2\"\>"]}], "Rr"]}], "+", 
  RowBox[{
   SubscriptBox["Eth", "\<\"i+1/2\"\>"], " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["kz", "2"], "+", 
     FractionBox["1", 
      SuperscriptBox["Rr", "2"]], "-", 
     FractionBox["2", 
      SubsuperscriptBox["\[CapitalDelta]", "r", "2"]], "-", 
     FractionBox["3", 
      RowBox[{"2", " ", "Rr", " ", 
       SubscriptBox["\[CapitalDelta]", "r"]}]]}], ")"}]}], "+", 
  FractionBox[
   SubscriptBox["Eth", "\<\"i-5/2\"\>"], 
   SubsuperscriptBox["\[CapitalDelta]", "r", "2"]], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", "nPhi", " ", 
    SubscriptBox["Er", "\<\"i+1\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "Rr"}], "-", 
      SubscriptBox["\[CapitalDelta]", "r"]}], ")"}]}], 
   RowBox[{"2", " ", 
    SuperscriptBox["Rr", "2"], " ", 
    SubscriptBox["\[CapitalDelta]", "r"]}]], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", "nPhi", " ", 
    SubscriptBox["Er", "i"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "Rr"}], "+", 
      SubscriptBox["\[CapitalDelta]", "r"]}], ")"}]}], 
   RowBox[{"2", " ", 
    SuperscriptBox["Rr", "2"], " ", 
    SubscriptBox["\[CapitalDelta]", "r"]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["Eth", "\<\"i-1/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"5", " ", "Rr"}], "+", 
      RowBox[{"2", " ", 
       SubscriptBox["\[CapitalDelta]", "r"]}]}], ")"}]}], 
   RowBox[{"Rr", " ", 
    SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["Eth", "\<\"i-3/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{"8", "+", 
      FractionBox[
       SubscriptBox["\[CapitalDelta]", "r"], "Rr"]}], ")"}]}], 
   RowBox[{"2", " ", 
    SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]]}]], "Output",
 CellChangeTimes->{
  3.467134375479273*^9, {3.467134562262381*^9, 3.4671345893935823`*^9}, 
   3.467141658876927*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"lhsbackwardDiffTh", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"backwardDiffCCETh", "-", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Omega]", "^", "2"}], "/", 
       RowBox[{"c", "^", "2"}]}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubsuperscriptBox["\[Epsilon]", "i", "\[Theta]r"], 
            SubscriptBox["Er", "i"]}], "+", 
           RowBox[{
            SubsuperscriptBox["\[Epsilon]", "\"\<i+1\>\"", "\[Theta]r"], 
            SubscriptBox["Er", "\"\<i+1\>\""]}]}], ")"}], "/", "2"}], "+", 
        RowBox[{
         SubsuperscriptBox["\[Epsilon]", "\"\<i+1/2\>\"", "\[Theta]\[Theta]"], 
         SubscriptBox["Eth", "\"\<i+1/2\>\""]}], "+", 
        RowBox[{
         SubsuperscriptBox["\[Epsilon]", "\"\<i+1/2\>\"", "\[Theta]z"], 
         SubscriptBox["Ez", "\"\<i+1/2\>\""]}]}], ")"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["Er", "\"\<i-1\>\""], ",", 
      SubscriptBox["Er", "i"], ",", 
      SubscriptBox["Er", "\"\<i+1\>\""], ",", 
      SubscriptBox["Eth", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+5/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+7/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+5/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+7/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i-3/2\>\""]}], "}"}], ",", "Simplify"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.4671346277518463`*^9, 3.4671346501279173`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   SubscriptBox["Eth", "\<\"i-5/2\"\>"], 
   SubsuperscriptBox["\[CapitalDelta]", "r", "2"]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["Eth", "\<\"i-1/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"5", " ", "Rr"}], "+", 
      RowBox[{"2", " ", 
       SubscriptBox["\[CapitalDelta]", "r"]}]}], ")"}]}], 
   RowBox[{"Rr", " ", 
    SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["Eth", "\<\"i-3/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{"8", "+", 
      FractionBox[
       SubscriptBox["\[CapitalDelta]", "r"], "Rr"]}], ")"}]}], 
   RowBox[{"2", " ", 
    SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]], "+", 
  RowBox[{
   SubscriptBox["Er", "\<\"i+1\"\>"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", "nPhi"}], 
       RowBox[{"2", " ", 
        SuperscriptBox["Rr", "2"]}]]}], "+", 
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", "nPhi"}], 
      RowBox[{"Rr", " ", 
       SubscriptBox["\[CapitalDelta]", "r"]}]], "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["\[Omega]", "2"], " ", 
       SubsuperscriptBox["\[Epsilon]", "\<\"i+1\"\>", "\[Theta]r"]}], 
      RowBox[{"2", " ", 
       SuperscriptBox["c", "2"]}]]}], ")"}]}], "+", 
  RowBox[{
   SubscriptBox["Ez", "\<\"i+1/2\"\>"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"kz", " ", "nPhi"}], "Rr"]}], "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["\[Omega]", "2"], " ", 
       SubsuperscriptBox["\[Epsilon]", "\<\"i+1/2\"\>", "\[Theta]z"]}], 
      SuperscriptBox["c", "2"]]}], ")"}]}], "+", 
  RowBox[{
   SubscriptBox["Eth", "\<\"i+1/2\"\>"], " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["kz", "2"], "+", 
     FractionBox["1", 
      SuperscriptBox["Rr", "2"]], "-", 
     FractionBox["2", 
      SubsuperscriptBox["\[CapitalDelta]", "r", "2"]], "-", 
     FractionBox["3", 
      RowBox[{"2", " ", "Rr", " ", 
       SubscriptBox["\[CapitalDelta]", "r"]}]], "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["\[Omega]", "2"], " ", 
       SubsuperscriptBox["\[Epsilon]", "\<\"i+1/2\"\>", "\[Theta]\[Theta]"]}], 
      SuperscriptBox["c", "2"]]}], ")"}]}], "+", 
  RowBox[{
   SubscriptBox["Er", "i"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", "nPhi", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "Rr"}], "+", 
          SubscriptBox["\[CapitalDelta]", "r"]}], ")"}]}], 
       RowBox[{"2", " ", 
        SuperscriptBox["Rr", "2"], " ", 
        SubscriptBox["\[CapitalDelta]", "r"]}]]}], "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["\[Omega]", "2"], " ", 
       SubsuperscriptBox["\[Epsilon]", "i", "\[Theta]r"]}], 
      RowBox[{"2", " ", 
       SuperscriptBox["c", "2"]}]]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.467134637206115*^9, 3.4671346506019382`*^9}, 
   3.4671417563691607`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"backwardDiffCCEZ", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"CCE", "[", 
      RowBox[{"[", "3", "]"}], "]"}], "/.", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Er", "[", "Rr", "]"}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["Er", "i"], "+", 
           SubscriptBox["Er", "\"\<i+1\>\""]}], ")"}], "/", "2"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Eth", "[", "Rr", "]"}], "\[Rule]", 
        SubscriptBox["Eth", "\"\<i+1/2\>\""]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Ez", "[", "Rr", "]"}], "\[Rule]", 
        SubscriptBox["Ez", "\"\<i+1/2\>\""]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", "Rr"], 
         RowBox[{"Er", "[", "Rr", "]"}]}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            SubscriptBox["Er", "i"]}], "+", 
           SubscriptBox["Er", "\"\<i+1\>\""]}], ")"}], "/", 
         SubscriptBox["\[CapitalDelta]", "r"]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", "Rr"], 
         RowBox[{"Ez", "[", "Rr", "]"}]}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"3", 
            SubscriptBox["Ez", "\"\<i+1/2\>\""]}], "-", 
           RowBox[{"4", 
            SubscriptBox["Ez", "\"\<i-1/2\>\""]}], "+", 
           SubscriptBox["Ez", "\"\<i-3/2\>\""]}], ")"}], "/", " ", 
         RowBox[{"(", 
          RowBox[{"2", 
           SubscriptBox["\[CapitalDelta]", "r"]}], ")"}]}]}], ",", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", 
          RowBox[{"Rr", ",", "Rr"}]], 
         RowBox[{"Ez", "[", "Rr", "]"}]}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", 
            SubscriptBox["Ez", "\"\<i+1/2\>\""]}], "-", 
           RowBox[{"5", " ", 
            SubscriptBox["Ez", "\"\<i-1/2\>\""]}], "+", 
           RowBox[{"4", 
            SubscriptBox["Ez", "\"\<i-3/2\>\""]}], "-", 
           SubscriptBox["Ez", "\"\<i-5/2\>\""]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["\[CapitalDelta]", "r"], "^", "2"}], ")"}]}]}]}], 
      "}"}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["Er", "\"\<i-1\>\""], ",", 
      SubscriptBox["Er", "i"], ",", 
      SubscriptBox["Er", "\"\<i+1\>\""], ",", 
      SubscriptBox["Er", "\"\<i+2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Ez", 
       RowBox[{"\"\<i+5/2\>\"", ",", 
        SubscriptBox["Ez", "\"\<i+7/2\>\""]}]], ",", 
      SubscriptBox["Eth", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i-3/2\>\""]}], "}"}], ",", "Simplify"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.467135393183098*^9, 3.4671353962715387`*^9}, {
  3.4671354528287077`*^9, 3.4671354887434883`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{"kz", " ", "nPhi", " ", 
     SubscriptBox["Eth", "\<\"i+1/2\"\>"]}], "Rr"]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", "kz", " ", 
   SubscriptBox["Er", "i"], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox["1", "Rr"], "-", 
     FractionBox["2", 
      SubscriptBox["\[CapitalDelta]", "r"]]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", "kz", " ", 
   SubscriptBox["Er", "\<\"i+1\"\>"], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox["1", "Rr"], "+", 
     FractionBox["2", 
      SubscriptBox["\[CapitalDelta]", "r"]]}], ")"}]}], "+", 
  RowBox[{
   SubscriptBox["Ez", "\<\"i+1/2\"\>"], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      SuperscriptBox["nPhi", "2"], 
      SuperscriptBox["Rr", "2"]], "-", 
     FractionBox["2", 
      SubsuperscriptBox["\[CapitalDelta]", "r", "2"]], "-", 
     FractionBox["3", 
      RowBox[{"2", " ", "Rr", " ", 
       SubscriptBox["\[CapitalDelta]", "r"]}]]}], ")"}]}], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["Ez", "\<\"i-1/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"5", " ", "Rr"}], "+", 
      RowBox[{"2", " ", 
       SubscriptBox["\[CapitalDelta]", "r"]}]}], ")"}]}], 
   RowBox[{"Rr", " ", 
    SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"2", " ", "Rr", " ", 
     SubscriptBox["Ez", "\<\"i-5/2\"\>"]}], "-", 
    RowBox[{
     SubscriptBox["Ez", "\<\"i-3/2\"\>"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"8", " ", "Rr"}], "+", 
       SubscriptBox["\[CapitalDelta]", "r"]}], ")"}]}]}], 
   RowBox[{"2", " ", "Rr", " ", 
    SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]]}]], "Output",
 CellChangeTimes->{3.467135397873271*^9, 3.467135490636345*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"lhsBackwardDiffZ", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"backwardDiffCCEZ", "-", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Omega]", "^", "2"}], "/", 
       RowBox[{"c", "^", "2"}]}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubsuperscriptBox["\[Epsilon]", "i", "zr"], 
            SubscriptBox["Er", "i"]}], "+", 
           RowBox[{
            SubsuperscriptBox["\[Epsilon]", "\"\<i+1\>\"", "zr"], 
            SubscriptBox["Er", "\"\<i+1\>\""]}]}], ")"}], "/", "2"}], "+", 
        RowBox[{
         SubsuperscriptBox["\[Epsilon]", "\"\<i+1/2\>\"", "z\[Theta]"], 
         SubscriptBox["Eth", "\"\<i+1/2\>\""]}], "+", 
        RowBox[{
         SubsuperscriptBox["\[Epsilon]", "\"\<i+1/2\>\"", "zz"], 
         SubscriptBox["Ez", "\"\<i+1/2\>\""]}]}], ")"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["Er", "\"\<i-1\>\""], ",", 
      SubscriptBox["Er", "i"], ",", 
      SubscriptBox["Er", "\"\<i+1\>\""], ",", 
      SubscriptBox["Eth", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+5/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+7/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i-3/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i-5/2\>\""]}], "}"}], ",", "Simplify"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.467135625311262*^9, 3.467135679793124*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   SubscriptBox["Ez", "\<\"i-5/2\"\>"], 
   SubsuperscriptBox["\[CapitalDelta]", "r", "2"]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["Ez", "\<\"i-3/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"8", " ", "Rr"}], "+", 
      SubscriptBox["\[CapitalDelta]", "r"]}], ")"}]}], 
   RowBox[{"2", " ", "Rr", " ", 
    SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["Ez", "\<\"i-1/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"5", " ", "Rr"}], "+", 
      RowBox[{"2", " ", 
       SubscriptBox["\[CapitalDelta]", "r"]}]}], ")"}]}], 
   RowBox[{"Rr", " ", 
    SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]], "+", 
  RowBox[{
   SubscriptBox["Er", "\<\"i+1\"\>"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", "kz", " ", 
      RowBox[{"(", 
       RowBox[{
        FractionBox["1", "Rr"], "+", 
        FractionBox["2", 
         SubscriptBox["\[CapitalDelta]", "r"]]}], ")"}]}], "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["\[Omega]", "2"], " ", 
       SubsuperscriptBox["\[Epsilon]", "\<\"i+1\"\>", "zr"]}], 
      RowBox[{"2", " ", 
       SuperscriptBox["c", "2"]}]]}], ")"}]}], "+", 
  RowBox[{
   SubscriptBox["Ez", "\<\"i+1/2\"\>"], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      SuperscriptBox["nPhi", "2"], 
      SuperscriptBox["Rr", "2"]], "-", 
     FractionBox["2", 
      SubsuperscriptBox["\[CapitalDelta]", "r", "2"]], "-", 
     FractionBox["3", 
      RowBox[{"2", " ", "Rr", " ", 
       SubscriptBox["\[CapitalDelta]", "r"]}]], "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["\[Omega]", "2"], " ", 
       SubsuperscriptBox["\[Epsilon]", "\<\"i+1/2\"\>", "zz"]}], 
      SuperscriptBox["c", "2"]]}], ")"}]}], "+", 
  RowBox[{
   SubscriptBox["Eth", "\<\"i+1/2\"\>"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"kz", " ", "nPhi"}], "Rr"]}], "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["\[Omega]", "2"], " ", 
       SubsuperscriptBox["\[Epsilon]", "\<\"i+1/2\"\>", "z\[Theta]"]}], 
      SuperscriptBox["c", "2"]]}], ")"}]}], "+", 
  RowBox[{
   SubscriptBox["Er", "i"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", "kz", " ", 
      RowBox[{"(", 
       RowBox[{
        FractionBox["1", "Rr"], "-", 
        FractionBox["2", 
         SubscriptBox["\[CapitalDelta]", "r"]]}], ")"}]}], "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["\[Omega]", "2"], " ", 
       SubsuperscriptBox["\[Epsilon]", "i", "zr"]}], 
      RowBox[{"2", " ", 
       SuperscriptBox["c", "2"]}]]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.4671356383651333`*^9, 3.4671356810296307`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"backwardDiffCCEThB", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"CCE", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "/.", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Er", "[", "Rr", "]"}], "\[Rule]", 
        SubscriptBox["Er", "i"]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Eth", "[", "Rr", "]"}], "\[Rule]", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Ez", "[", "Rr", "]"}], "\[Rule]", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", "Rr"], 
         RowBox[{"Er", "[", "Rr", "]"}]}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"3", 
            SubscriptBox["Er", "i"]}], "-", 
           RowBox[{"4", 
            SubscriptBox["Er", "\"\<i-1\>\""]}], "+", 
           SubscriptBox["Er", "\"\<i-2\>\""]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"2", 
           SubscriptBox["\[CapitalDelta]", "r"]}], ")"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", "Rr"], 
         RowBox[{"Eth", "[", "Rr", "]"}]}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"3", 
            SubscriptBox["Eth", "i"], "*", "0"}], "-", 
           RowBox[{"4", 
            SubscriptBox["Eth", "\"\<i-1/2\>\""]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["Eth", "\"\<i-1/2\>\""], "+", 
              SubscriptBox["Eth", "\"\<i-3/2\>\""]}], ")"}], "/", "2"}]}], 
          ")"}], "/", " ", 
         SubscriptBox["\[CapitalDelta]", "r"]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", 
          RowBox[{"Rr", ",", "Rr"}]], 
         RowBox[{"Eth", "[", "Rr", "]"}]}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", 
            SubscriptBox["Eth", "i"], "*", "0"}], "-", 
           RowBox[{"5", " ", 
            SubscriptBox["Eth", "\"\<i-1/2\>\""]}], "+", 
           RowBox[{"4", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SubscriptBox["Eth", "\"\<i-1/2\>\""], "+", 
               SubscriptBox["Eth", "\"\<i-3/2\>\""]}], ")"}], "/", "2"}]}], 
           "-", 
           SubscriptBox["Eth", "\"\<i-3/2\>\""]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["\[CapitalDelta]", "r"], "/", "2"}], ")"}], "^", 
           "2"}], ")"}]}]}]}], "}"}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["Er", "\"\<i-1\>\""], ",", 
      SubscriptBox["Er", "i"], ",", 
      SubscriptBox["Er", "\"\<i+1\>\""], ",", 
      SubscriptBox["Eth", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Er", "\"\<i-2\>\""]}], "}"}], ",", "Simplify"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.467150873721483*^9, 3.467150876529737*^9}, {
  3.467150922177738*^9, 3.4671509697695932`*^9}, {3.4671510741858473`*^9, 
  3.467151089085392*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{"2", " ", "\[ImaginaryI]", " ", "nPhi", " ", 
     SubscriptBox["Er", "\<\"i-1\"\>"]}], 
    RowBox[{"Rr", " ", 
     SubscriptBox["\[CapitalDelta]", "r"]}]]}], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", "nPhi", " ", 
    SubscriptBox["Er", "\<\"i-2\"\>"]}], 
   RowBox[{"2", " ", "Rr", " ", 
    SubscriptBox["\[CapitalDelta]", "r"]}]], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", "nPhi", " ", 
    SubscriptBox["Er", "i"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"3", " ", "Rr"}], "-", 
      RowBox[{"2", " ", 
       SubscriptBox["\[CapitalDelta]", "r"]}]}], ")"}]}], 
   RowBox[{"2", " ", 
    SuperscriptBox["Rr", "2"], " ", 
    SubscriptBox["\[CapitalDelta]", "r"]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["Eth", "\<\"i-3/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"8", " ", "Rr"}], "+", 
      SubscriptBox["\[CapitalDelta]", "r"]}], ")"}]}], 
   RowBox[{"2", " ", "Rr", " ", 
    SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["Eth", "\<\"i-1/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{"24", "+", 
      FractionBox[
       RowBox[{"7", " ", 
        SubscriptBox["\[CapitalDelta]", "r"]}], "Rr"]}], ")"}]}], 
   RowBox[{"2", " ", 
    SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]]}]], "Output",
 CellChangeTimes->{3.4671510591281843`*^9, 3.4671510902367764`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"lhsBackwardDiffThB", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"backwardDiffCCEThB", "-", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Omega]", "^", "2"}], "/", 
       RowBox[{"c", "^", "2"}]}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubsuperscriptBox["\[Epsilon]", "i", "\[Theta]r"], 
         SubscriptBox["Er", "i"]}], "+", 
        RowBox[{
         SubscriptBox["Eth", "i"], "*", "0"}], "+", 
        RowBox[{
         SubscriptBox["Ez", "i"], "*", "0"}]}], ")"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["Er", "\"\<i-1\>\""], ",", 
      SubscriptBox["Er", "i"], ",", 
      SubscriptBox["Er", "\"\<i+1\>\""], ",", 
      SubscriptBox["Eth", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Er", "\"\<i-2\>\""]}], "}"}], ",", "Simplify"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.4671512043335123`*^9, 3.467151234981352*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{"2", " ", "\[ImaginaryI]", " ", "nPhi", " ", 
     SubscriptBox["Er", "\<\"i-1\"\>"]}], 
    RowBox[{"Rr", " ", 
     SubscriptBox["\[CapitalDelta]", "r"]}]]}], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", "nPhi", " ", 
    SubscriptBox["Er", "\<\"i-2\"\>"]}], 
   RowBox[{"2", " ", "Rr", " ", 
    SubscriptBox["\[CapitalDelta]", "r"]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["Eth", "\<\"i-3/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"8", " ", "Rr"}], "+", 
      SubscriptBox["\[CapitalDelta]", "r"]}], ")"}]}], 
   RowBox[{"2", " ", "Rr", " ", 
    SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["Eth", "\<\"i-1/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{"24", "+", 
      FractionBox[
       RowBox[{"7", " ", 
        SubscriptBox["\[CapitalDelta]", "r"]}], "Rr"]}], ")"}]}], 
   RowBox[{"2", " ", 
    SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]], "+", 
  RowBox[{
   SubscriptBox["Er", "i"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", "nPhi"}], 
       SuperscriptBox["Rr", "2"]]}], "+", 
     FractionBox[
      RowBox[{"3", " ", "\[ImaginaryI]", " ", "nPhi"}], 
      RowBox[{"2", " ", "Rr", " ", 
       SubscriptBox["\[CapitalDelta]", "r"]}]], "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["\[Omega]", "2"], " ", 
       SubsuperscriptBox["\[Epsilon]", "i", "\[Theta]r"]}], 
      SuperscriptBox["c", "2"]]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.467151197548012*^9, 3.467151235988831*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"backwardDiffCCEZB", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"CCE", "[", 
      RowBox[{"[", "3", "]"}], "]"}], "/.", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Er", "[", "Rr", "]"}], "\[Rule]", 
        SubscriptBox["Er", "i"]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Eth", "[", "Rr", "]"}], "\[Rule]", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Ez", "[", "Rr", "]"}], "\[Rule]", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", "Rr"], 
         RowBox[{"Er", "[", "Rr", "]"}]}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"3", 
            SubscriptBox["Er", "i"]}], "-", 
           RowBox[{"4", 
            SubscriptBox["Er", "\"\<i-1\>\""]}], "+", 
           SubscriptBox["Er", "\"\<i-2\>\""]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"2", 
           SubscriptBox["\[CapitalDelta]", "r"]}], ")"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", "Rr"], 
         RowBox[{"Ez", "[", "Rr", "]"}]}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"3", 
            SubscriptBox["Ez", "i"], "*", "0"}], "-", 
           RowBox[{"4", 
            SubscriptBox["Ez", "\"\<i-1/2\>\""]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["Ez", "\"\<i-1/2\>\""], "+", 
              SubscriptBox["Ez", "\"\<i-3/2\>\""]}], ")"}], "/", "2"}]}], 
          ")"}], "/", 
         SubscriptBox["\[CapitalDelta]", "r"]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", 
          RowBox[{"Rr", ",", "Rr"}]], 
         RowBox[{"Ez", "[", "Rr", "]"}]}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", 
            SubscriptBox["Ez", "i"], "*", "0"}], "-", 
           RowBox[{"5", 
            SubscriptBox["Ez", "\"\<i-1/2\>\""]}], "+", 
           RowBox[{"4", 
            RowBox[{
             RowBox[{"(", " ", 
              RowBox[{
               SubscriptBox["Ez", "\"\<i-1/2\>\""], "+", 
               SubscriptBox["Ez", "\"\<i-3/2\>\""]}], ")"}], "/", "2"}]}], 
           "-", 
           SubscriptBox["Ez", "\"\<i-3/2\>\""]}], ")"}], "/", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["\[CapitalDelta]", "r"], "/", "2"}], ")"}], "^", 
          "2"}]}]}]}], "}"}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["Er", "\"\<i-1\>\""], ",", 
      SubscriptBox["Er", "i"], ",", 
      SubscriptBox["Er", "\"\<i+1\>\""], ",", 
      SubscriptBox["Er", "\"\<i+2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Er", "\"\<i-2\>\""]}], "}"}], ",", "Simplify"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.467151315268499*^9, 3.467151391515766*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", "kz", " ", 
   SubscriptBox["Er", "i"], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox["2", "Rr"], "+", 
     FractionBox["3", 
      SubscriptBox["\[CapitalDelta]", "r"]]}], ")"}]}], "-", 
  FractionBox[
   RowBox[{"2", " ", "\[ImaginaryI]", " ", "kz", " ", 
    SubscriptBox["Er", "\<\"i-1\"\>"]}], 
   SubscriptBox["\[CapitalDelta]", "r"]], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", "kz", " ", 
    SubscriptBox["Er", "\<\"i-2\"\>"]}], 
   RowBox[{"2", " ", 
    SubscriptBox["\[CapitalDelta]", "r"]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["Ez", "\<\"i-3/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"8", " ", "Rr"}], "+", 
      SubscriptBox["\[CapitalDelta]", "r"]}], ")"}]}], 
   RowBox[{"2", " ", "Rr", " ", 
    SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["Ez", "\<\"i-1/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{"24", "+", 
      FractionBox[
       RowBox[{"7", " ", 
        SubscriptBox["\[CapitalDelta]", "r"]}], "Rr"]}], ")"}]}], 
   RowBox[{"2", " ", 
    SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]]}]], "Output",
 CellChangeTimes->{
  3.46715132205549*^9, {3.4671513690154676`*^9, 3.4671513925205584`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"lhsBackwardDiffZB", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"backwardDiffCCEZB", "-", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Omega]", "^", "2"}], "/", 
       RowBox[{"c", "^", "2"}]}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubsuperscriptBox["\[Epsilon]", "i", "zr"], 
         SubscriptBox["Er", "i"]}], "+", 
        RowBox[{
         SubsuperscriptBox["\[Epsilon]", "\"\<i+1/2\>\"", "z\[Theta]"], 
         SubscriptBox["Eth", "\"\<i+1/2\>\""], "*", "0"}], "+", 
        RowBox[{
         SubsuperscriptBox["\[Epsilon]", "\"\<i+1/2\>\"", "zz"], 
         SubscriptBox["Ez", "\"\<i+1/2\>\""], "*", "0"}]}], ")"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["Er", "\"\<i-1\>\""], ",", 
      SubscriptBox["Er", "i"], ",", 
      SubscriptBox["Er", "\"\<i+1\>\""], ",", 
      SubscriptBox["Eth", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Er", "\"\<i+2\>\""], ",", 
      SubscriptBox["Er", "\"\<i-2\>\""]}], "}"}], ",", "Simplify"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.46715151261775*^9, 3.467151541823331*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{"2", " ", "\[ImaginaryI]", " ", "kz", " ", 
     SubscriptBox["Er", "\<\"i-1\"\>"]}], 
    SubscriptBox["\[CapitalDelta]", "r"]]}], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", "kz", " ", 
    SubscriptBox["Er", "\<\"i-2\"\>"]}], 
   RowBox[{"2", " ", 
    SubscriptBox["\[CapitalDelta]", "r"]}]], "-", 
  FractionBox[
   RowBox[{
    SubscriptBox["Ez", "\<\"i-3/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"8", " ", "Rr"}], "+", 
      SubscriptBox["\[CapitalDelta]", "r"]}], ")"}]}], 
   RowBox[{"2", " ", "Rr", " ", 
    SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]], "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["Ez", "\<\"i-1/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{"24", "+", 
      FractionBox[
       RowBox[{"7", " ", 
        SubscriptBox["\[CapitalDelta]", "r"]}], "Rr"]}], ")"}]}], 
   RowBox[{"2", " ", 
    SubsuperscriptBox["\[CapitalDelta]", "r", "2"]}]], "+", 
  RowBox[{
   SubscriptBox["Er", "i"], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", "kz"}], "Rr"], "+", 
     FractionBox[
      RowBox[{"3", " ", "\[ImaginaryI]", " ", "kz"}], 
      RowBox[{"2", " ", 
       SubscriptBox["\[CapitalDelta]", "r"]}]], "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["\[Omega]", "2"], " ", 
       SubsuperscriptBox["\[Epsilon]", "i", "zr"]}], 
      SuperscriptBox["c", "2"]]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.467151508707793*^9, 3.467151542835836*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"forwardDiffCCERHalfGridBry", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"CCE", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "/.", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Er", "[", "Rr", "]"}], "\[Rule]", 
        SubscriptBox["Er", "i"]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Eth", "[", "Rr", "]"}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["Eth", "\"\<i-1/2\>\""], "*", "0"}], "+", 
           SubscriptBox["Eth", "\"\<i+1/2\>\""]}], ")"}], "/", "2"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Ez", "[", "Rr", "]"}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["Ez", "\"\<i-1/2\>\""], "*", "0"}], "+", 
           SubscriptBox["Ez", "\"\<i+1/2\>\""]}], ")"}], "/", "2"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", "Rr"], 
         RowBox[{"Eth", "[", "Rr", "]"}]}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             SubscriptBox["Eth", "\"\<i-1/2\>\""]}], "*", "0"}], "+", 
           SubscriptBox["Eth", "\"\<i+1/2\>\""]}], ")"}], "/", 
         SubscriptBox["\[CapitalDelta]", "r"]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", "Rr"], 
         RowBox[{"Ez", "[", "Rr", "]"}]}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             SubscriptBox["Ez", "\"\<i-1/2\>\""]}], "*", "0"}], "+", 
           SubscriptBox["Ez", "\"\<i+1/2\>\""]}], ")"}], "/", 
         SubscriptBox["\[CapitalDelta]", "r"]}]}]}], "}"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["Er", "\"\<i-1\>\""], ",", 
      SubscriptBox["Er", "i"], ",", 
      SubscriptBox["Er", "\"\<i+1\>\""], ",", 
      SubscriptBox["Eth", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+3/2\>\""]}], "}"}], ",", "Simplify"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.467222475751841*^9, 3.4672226360995493`*^9}, {
  3.467222852041398*^9, 3.46722285235238*^9}, {3.467224433009432*^9, 
  3.467224517170988*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["kz", "2"], "+", 
     FractionBox[
      SuperscriptBox["nPhi", "2"], 
      SuperscriptBox["Rr", "2"]]}], ")"}], " ", 
   SubscriptBox["Er", "i"]}], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", "kz", " ", 
    SubscriptBox["Ez", "\<\"i+1/2\"\>"]}], 
   SubscriptBox["\[CapitalDelta]", "r"]], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", "nPhi", " ", 
    SubscriptBox["Eth", "\<\"i+1/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "Rr"}], "+", 
      SubscriptBox["\[CapitalDelta]", "r"]}], ")"}]}], 
   RowBox[{"2", " ", 
    SuperscriptBox["Rr", "2"], " ", 
    SubscriptBox["\[CapitalDelta]", "r"]}]]}]], "Output",
 CellChangeTimes->{
  3.467222480884716*^9, {3.467222624355132*^9, 3.467222637381343*^9}, 
   3.467222853603093*^9, 3.467224519706626*^9, 3.46722517146627*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"lhsForwardDiffRHalfGridBry", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"forwardDiffCCERHalfGridBry", "-", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Omega]", "^", "2"}], "/", 
       RowBox[{"c", "^", "2"}]}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubsuperscriptBox["\[Epsilon]", "i", "rr"], 
         SubscriptBox["Er", "i"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["Eth", "\"\<i-1/2\>\""], "*", "0"}], "+", 
           RowBox[{
            SubsuperscriptBox["\[Epsilon]", "\"\<i+1/2\>\"", "r\[Theta]"], 
            SubscriptBox["Eth", "\"\<i+1/2\>\""]}]}], ")"}], "/", "2"}], "+", 
        
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["Ez", "\"\<i-1/2\>\""], "*", "0"}], "+", 
           RowBox[{
            SubsuperscriptBox["\[Epsilon]", "\"\<i+1/2\>\"", "rz"], 
            SubscriptBox["Ez", "\"\<i+1/2\>\""]}]}], ")"}], "/", "2"}]}], 
       ")"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["Er", "\"\<i-1\>\""], ",", 
      SubscriptBox["Er", "i"], ",", 
      SubscriptBox["Er", "\"\<i+1\>\""], ",", 
      SubscriptBox["Eth", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+3/2\>\""]}], "}"}], ",", "Simplify"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.467222737013534*^9, 3.467222845734236*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["Ez", "\<\"i+1/2\"\>"], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", "kz"}], 
      SubscriptBox["\[CapitalDelta]", "r"]], "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["\[Omega]", "2"], " ", 
       SubsuperscriptBox["\[Epsilon]", "\<\"i+1/2\"\>", "rz"]}], 
      RowBox[{"2", " ", 
       SuperscriptBox["c", "2"]}]]}], ")"}]}], "+", 
  RowBox[{
   SubscriptBox["Eth", "\<\"i+1/2\"\>"], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", "nPhi", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "Rr"}], "+", 
         SubscriptBox["\[CapitalDelta]", "r"]}], ")"}]}], 
      RowBox[{"2", " ", 
       SuperscriptBox["Rr", "2"], " ", 
       SubscriptBox["\[CapitalDelta]", "r"]}]], "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["\[Omega]", "2"], " ", 
       SubsuperscriptBox["\[Epsilon]", "\<\"i+1/2\"\>", "r\[Theta]"]}], 
      RowBox[{"2", " ", 
       SuperscriptBox["c", "2"]}]]}], ")"}]}], "+", 
  RowBox[{
   SubscriptBox["Er", "i"], " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["kz", "2"], "+", 
     FractionBox[
      SuperscriptBox["nPhi", "2"], 
      SuperscriptBox["Rr", "2"]], "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["\[Omega]", "2"], " ", 
       SubsuperscriptBox["\[Epsilon]", "i", "rr"]}], 
      SuperscriptBox["c", "2"]]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.467222745885323*^9, 3.467222855159316*^9, 
  3.467224522189869*^9, 3.46722517427938*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"backwardDiffCCERHalfGridBry", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"CCE", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "/.", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Er", "[", "Rr", "]"}], "\[Rule]", 
        SubscriptBox["Er", "i"]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Eth", "[", "Rr", "]"}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["Eth", "\"\<i-1/2\>\""], "+", 
           RowBox[{
            SubscriptBox["Eth", "\"\<i+1/2\>\""], "*", "0"}]}], ")"}], "/", 
         "2"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Ez", "[", "Rr", "]"}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["Ez", "\"\<i-1/2\>\""], "+", 
           RowBox[{
            SubscriptBox["Ez", "\"\<i+1/2\>\""], "*", "0"}]}], ")"}], "/", 
         "2"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", "Rr"], 
         RowBox[{"Eth", "[", "Rr", "]"}]}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            SubscriptBox["Eth", "\"\<i-1/2\>\""]}], "+", 
           RowBox[{
            SubscriptBox["Eth", "\"\<i+1/2\>\""], "*", "0"}]}], ")"}], "/", 
         SubscriptBox["\[CapitalDelta]", "r"]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[PartialD]", "Rr"], 
         RowBox[{"Ez", "[", "Rr", "]"}]}], "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            SubscriptBox["Ez", "\"\<i-1/2\>\""]}], "+", 
           RowBox[{
            SubscriptBox["Ez", "\"\<i+1/2\>\""], "*", "0"}]}], ")"}], "/", 
         SubscriptBox["\[CapitalDelta]", "r"]}]}]}], "}"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["Er", "\"\<i-1\>\""], ",", 
      SubscriptBox["Er", "i"], ",", 
      SubscriptBox["Er", "\"\<i+1\>\""], ",", 
      SubscriptBox["Eth", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+3/2\>\""]}], "}"}], ",", "Simplify"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.46722454303365*^9, 3.4672245731621304`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["kz", "2"], "+", 
     FractionBox[
      SuperscriptBox["nPhi", "2"], 
      SuperscriptBox["Rr", "2"]]}], ")"}], " ", 
   SubscriptBox["Er", "i"]}], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", "nPhi", " ", 
    SubscriptBox["Eth", "\<\"i-1/2\"\>"], " ", 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      FractionBox[
       RowBox[{"2", " ", "Rr"}], 
       SubscriptBox["\[CapitalDelta]", "r"]]}], ")"}]}], 
   RowBox[{"2", " ", 
    SuperscriptBox["Rr", "2"]}]], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", "kz", " ", 
    SubscriptBox["Ez", "\<\"i-1/2\"\>"]}], 
   SubscriptBox["\[CapitalDelta]", "r"]]}]], "Output",
 CellChangeTimes->{{3.467224547730094*^9, 3.467224582737341*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"lhsBackwardDiffRHalfGridBry", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"backwardDiffCCERHalfGridBry", "-", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Omega]", "^", "2"}], "/", 
       RowBox[{"c", "^", "2"}]}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubsuperscriptBox["\[Epsilon]", "i", "rr"], 
         SubscriptBox["Er", "i"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubsuperscriptBox["\[Epsilon]", "\"\<i-1/2\>\"", "r\[Theta]"], 
            SubscriptBox["Eth", "\"\<i-1/2\>\""]}], "+", 
           RowBox[{
            SubscriptBox["Eth", "\"\<i+1/2\>\""], "*", "0"}]}], ")"}], "/", 
         "2"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubsuperscriptBox["\[Epsilon]", "\"\<i-1/2\>\"", "rz"], 
            SubscriptBox["Ez", "\"\<i-1/2\>\""]}], "+", 
           RowBox[{
            SubsuperscriptBox["\[Epsilon]", "\"\<i+1/2\>\"", "rz"], 
            SubscriptBox["Ez", "\"\<i+1/2\>\""], "*", "0"}]}], ")"}], "/", 
         "2"}]}], ")"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["Er", "\"\<i-1\>\""], ",", 
      SubscriptBox["Er", "i"], ",", 
      SubscriptBox["Er", "\"\<i+1\>\""], ",", 
      SubscriptBox["Eth", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Eth", "\"\<i+3/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i-1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+1/2\>\""], ",", 
      SubscriptBox["Ez", "\"\<i+3/2\>\""]}], "}"}], ",", "Simplify"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.4672246055970592`*^9, 3.467224651562243*^9}, {
  3.4672249640202093`*^9, 3.467225026574905*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["Ez", "\<\"i-1/2\"\>"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", "kz"}], 
       SubscriptBox["\[CapitalDelta]", "r"]]}], "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["\[Omega]", "2"], " ", 
       SubsuperscriptBox["\[Epsilon]", "\<\"i-1/2\"\>", "rz"]}], 
      RowBox[{"2", " ", 
       SuperscriptBox["c", "2"]}]]}], ")"}]}], "+", 
  RowBox[{
   SubscriptBox["Eth", "\<\"i-1/2\"\>"], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"\[ImaginaryI]", " ", "nPhi", " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         FractionBox[
          RowBox[{"2", " ", "Rr"}], 
          SubscriptBox["\[CapitalDelta]", "r"]]}], ")"}]}], 
      RowBox[{"2", " ", 
       SuperscriptBox["Rr", "2"]}]], "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["\[Omega]", "2"], " ", 
       SubsuperscriptBox["\[Epsilon]", "\<\"i-1/2\"\>", "r\[Theta]"]}], 
      RowBox[{"2", " ", 
       SuperscriptBox["c", "2"]}]]}], ")"}]}], "+", 
  RowBox[{
   SubscriptBox["Er", "i"], " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["kz", "2"], "+", 
     FractionBox[
      SuperscriptBox["nPhi", "2"], 
      SuperscriptBox["Rr", "2"]], "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["\[Omega]", "2"], " ", 
       SubsuperscriptBox["\[Epsilon]", "i", "rr"]}], 
      SuperscriptBox["c", "2"]]}], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.467224616590818*^9, 3.4672246524169207`*^9, {3.46722497620467*^9, 
   3.467225027116776*^9}}]
}, Open  ]]
},
WindowSize->{765, 803},
WindowMargins->{{32, Automatic}, {Automatic, 0}},
FrontEndVersion->"7.0 for Mac OS X x86 (32-bit) (November 10, 2008)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[400, 13, 1937, 55, 118, "Input"],
Cell[CellGroupData[{
Cell[2362, 72, 297, 7, 27, "Input"],
Cell[2662, 81, 3158, 94, 201, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5857, 180, 166, 3, 27, "Input"],
Cell[6026, 185, 516, 10, 23, "Message"],
Cell[6545, 197, 3223, 94, 231, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9805, 296, 2359, 64, 148, "Input"],
Cell[12167, 362, 2705, 78, 132, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14909, 445, 467, 9, 27, "Input"],
Cell[15379, 456, 656, 15, 47, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16072, 476, 1933, 48, 107, "Input"],
Cell[18008, 526, 739, 20, 50, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[18784, 551, 1771, 42, 113, "Input"],
Cell[20558, 595, 617, 16, 50, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21212, 616, 1752, 45, 112, "Input"],
Cell[22967, 663, 767, 23, 60, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23771, 691, 3270, 75, 149, "Input"],
Cell[27044, 768, 1604, 43, 64, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28685, 816, 3024, 79, 159, "Input"],
Cell[31712, 897, 1854, 55, 105, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[33603, 957, 2888, 77, 159, "Input"],
Cell[36494, 1036, 1606, 50, 107, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[38137, 1091, 2250, 61, 114, "Input"],
Cell[40390, 1154, 1637, 47, 57, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[42064, 1206, 2376, 64, 131, "Input"],
Cell[44443, 1272, 1773, 52, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[46253, 1329, 1945, 52, 110, "Input"],
Cell[48201, 1383, 1250, 35, 57, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[49488, 1423, 2091, 50, 131, "Input"],
Cell[51582, 1475, 2739, 80, 105, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[54358, 1560, 1774, 42, 138, "Input"],
Cell[56135, 1604, 2956, 88, 104, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[59128, 1697, 1697, 42, 132, "Input"],
Cell[60828, 1741, 2699, 79, 104, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[63564, 1825, 2736, 71, 124, "Input"],
Cell[66303, 1898, 1168, 32, 52, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[67508, 1935, 3671, 97, 174, "Input"],
Cell[71182, 2034, 1779, 48, 60, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[72998, 2087, 3610, 96, 170, "Input"],
Cell[76611, 2185, 1559, 43, 60, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[78207, 2233, 1210, 32, 53, "Input"],
Cell[79420, 2267, 1309, 36, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[80766, 2308, 1220, 32, 54, "Input"],
Cell[81989, 2342, 1868, 54, 105, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[83894, 2401, 1467, 35, 85, "Input"],
Cell[85364, 2438, 1719, 49, 60, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[87120, 2492, 3433, 88, 159, "Input"],
Cell[90556, 2582, 2348, 66, 95, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[92941, 2653, 3355, 88, 197, "Input"],
Cell[96299, 2743, 2005, 60, 95, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[98341, 2808, 1811, 44, 105, "Input"],
Cell[100155, 2854, 3301, 98, 146, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[103493, 2957, 1607, 41, 105, "Input"],
Cell[105103, 3000, 2930, 90, 145, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[108070, 3095, 2560, 68, 124, "Input"],
Cell[110633, 3165, 1070, 31, 52, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[111740, 3201, 1213, 32, 69, "Input"],
Cell[112956, 3235, 1263, 36, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[114256, 3276, 3266, 86, 159, "Input"],
Cell[117525, 3364, 2061, 62, 105, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[119623, 3431, 1817, 44, 105, "Input"],
Cell[121443, 3477, 3074, 93, 155, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[124554, 3575, 3302, 87, 197, "Input"],
Cell[127859, 3664, 1852, 56, 95, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[129748, 3725, 1732, 43, 105, "Input"],
Cell[131483, 3770, 2858, 87, 145, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[134378, 3862, 3438, 93, 174, "Input"],
Cell[137819, 3957, 1466, 43, 60, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[139322, 4005, 1171, 31, 70, "Input"],
Cell[140496, 4038, 1662, 49, 105, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[142195, 4092, 3331, 91, 170, "Input"],
Cell[145529, 4185, 1325, 39, 60, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[146891, 4229, 1369, 34, 85, "Input"],
Cell[148263, 4265, 1544, 46, 60, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[149844, 4316, 2608, 69, 149, "Input"],
Cell[152455, 4387, 906, 26, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[153398, 4418, 1644, 44, 89, "Input"],
Cell[155045, 4464, 1597, 48, 55, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[156679, 4517, 2513, 67, 149, "Input"],
Cell[159195, 4586, 791, 24, 63, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[160023, 4615, 1771, 46, 109, "Input"],
Cell[161797, 4663, 1608, 50, 75, "Output"]
}, Open  ]]
}
]
*)

